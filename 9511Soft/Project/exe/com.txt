; generated by ARM C/C++ Compiler, 4.1 [Build 481]
; commandline ArmCC [--debug -c --asm --interleave -o.\exe\com.o --depend=.\exe\com.d --cpu=Cortex-M3 --apcs=interwork -O0 -I..\Source\APP -I..\Source\APP\MC -I..\Source\BSP -I..\Source\FS\FF007 -I..\Source\OS\uCOS-II\Ports\ARM-Cortex-M3\Generic\RealView -I..\Source\OS\uCOS-II\Source -I..\Source\Libraries\STM32F10x_StdPeriph_Driver\inc -I..\Source\Libraries\CMSIS\Core\CM3 -IC:\Keil\ARM\INC -IC:\Keil\ARM\INC\ST\STM32F10x -DSTM32F10X_MD -DHARDWARE_VER=1 --omf_browse=.\exe\com.crf ..\Source\APP\com.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  COM_GetIsBroken PROC
;;;550    u8 TK_Org[2]={0,0};
;;;551    static  bool  COM_GetIsBroken (COM_UP_ST_TypeDef st)
000000  4601              MOV      r1,r0
;;;552    {
;;;553        switch (st) {
000002  2907              CMP      r1,#7
000004  d208              BCS      |L1.24|
000006  e8dff001          TBB      [pc,r1]
00000a  0908              DCB      0x09,0x08
00000c  040b0c0a          DCB      0x04,0x0b,0x0c,0x0a
000010  0500              DCB      0x05,0x00
;;;554            
;;;555        case COM_UP_ST_BROKEN:
;;;556        case COM_UP_ST_PATCH_BROKEN:
000012  bf00              NOP      
;;;557            return  TRUE;
000014  2001              MOVS     r0,#1
                  |L1.22|
;;;558            
;;;559        case COM_UP_ST_NORMAL:
;;;560        case COM_UP_ST_LOCK:
;;;561        case COM_UP_ST_PATCH_NORMAL:
;;;562        case COM_UP_ST_PATCH_LOCK:
;;;563        case COM_UP_ST_PATCH_IDLE:
;;;564        default:
;;;565            return  FALSE;
;;;566            
;;;567        }
;;;568    }
000016  4770              BX       lr
                  |L1.24|
000018  bf00              NOP                            ;559
00001a  bf00              NOP                            ;560
00001c  bf00              NOP                            ;561
00001e  bf00              NOP                            ;562
000020  bf00              NOP                            ;563
000022  2000              MOVS     r0,#0                 ;565
000024  e7f7              B        |L1.22|
;;;569    
                          ENDP

                  COM_GetIsDrop PROC
;;;570    static  bool  COM_GetIsDrop (COM_UP_ST_TypeDef st)
000026  4601              MOV      r1,r0
;;;571    {
;;;572        switch (st) {
000028  2907              CMP      r1,#7
00002a  d20a              BCS      |L1.66|
00002c  e8dff001          TBB      [pc,r1]
000030  0a05040b          DCB      0x0a,0x05,0x04,0x0b
000034  0c070600          DCB      0x0c,0x07,0x06,0x00
;;;573            
;;;574        case COM_UP_ST_BROKEN:
;;;575        case COM_UP_ST_NORMAL:
000038  bf00              NOP      
;;;576        case COM_UP_ST_PATCH_BROKEN:
00003a  bf00              NOP      
;;;577        case COM_UP_ST_PATCH_NORMAL:
00003c  bf00              NOP      
;;;578            return  TRUE;
00003e  2001              MOVS     r0,#1
                  |L1.64|
;;;579            
;;;580        case COM_UP_ST_LOCK:
;;;581        case COM_UP_ST_PATCH_LOCK:
;;;582        case COM_UP_ST_PATCH_IDLE:
;;;583        default:
;;;584            return  FALSE;
;;;585            
;;;586        }
;;;587    }
000040  4770              BX       lr
                  |L1.66|
000042  bf00              NOP                            ;580
000044  bf00              NOP                            ;581
000046  bf00              NOP                            ;582
000048  2000              MOVS     r0,#0                 ;584
00004a  e7f9              B        |L1.64|
;;;588    //这是根据机头的状态，更新机头开关板LED用的，注意不是发给主控的绣作状态
                          ENDP

                  COM_GetHDLedSt PROC
;;;589    static  HDLED_ST_TypeDef  COM_GetHDLedSt (COM_UP_ST_TypeDef st,BSP_ID_TypeDef id)
00004c  4602              MOV      r2,r0
;;;590    {
;;;591        switch (st) {
00004e  2a07              CMP      r2,#7
000050  d217              BCS      |L1.130|
000052  e8dff002          TBB      [pc,r2]
000056  1713              DCB      0x17,0x13
000058  04181407          DCB      0x04,0x18,0x14,0x07
00005c  0500              DCB      0x05,0x00
;;;592            
;;;593        case COM_UP_ST_BROKEN:
;;;594        case COM_UP_ST_PATCH_BROKEN:
00005e  bf00              NOP      
;;;595            return  HDLED_ST_RED; //断线就应该是红灯
000060  2001              MOVS     r0,#1
                  |L1.98|
;;;596        case COM_UP_ST_PATCH_NORMAL:
;;;597    		if((COM_UpStLast[id]==COM_UP_ST_BROKEN)||(COM_UpStLast[id]==COM_UP_ST_PATCH_BROKEN))
;;;598    			return  HDLED_ST_RED;
;;;599    		else
;;;600            	return  HDLED_ST_GRE;   
;;;601        case COM_UP_ST_NORMAL:
;;;602        case COM_UP_ST_PATCH_IDLE:
;;;603       // case COM_UP_ST_PATCH_NORMAL:
;;;604            return  HDLED_ST_GRE;
;;;605            
;;;606        case COM_UP_ST_LOCK:
;;;607        case COM_UP_ST_PATCH_LOCK:
;;;608        default:
;;;609            return  HDLED_ST_OFF;
;;;610            
;;;611        }
;;;612    }
000062  4770              BX       lr
000064  48fe              LDR      r0,|L1.1120|
000066  5c40              LDRB     r0,[r0,r1]            ;597
000068  2802              CMP      r0,#2                 ;597
00006a  d003              BEQ      |L1.116|
00006c  48fc              LDR      r0,|L1.1120|
00006e  5c40              LDRB     r0,[r0,r1]            ;597
000070  2806              CMP      r0,#6                 ;597
000072  d101              BNE      |L1.120|
                  |L1.116|
000074  2001              MOVS     r0,#1                 ;598
000076  e7f4              B        |L1.98|
                  |L1.120|
000078  2002              MOVS     r0,#2                 ;600
00007a  e7f2              B        |L1.98|
00007c  bf00              NOP                            ;602
00007e  2002              MOVS     r0,#2                 ;604
000080  e7ef              B        |L1.98|
                  |L1.130|
000082  bf00              NOP                            ;606
000084  bf00              NOP                            ;607
000086  2003              MOVS     r0,#3                 ;609
000088  e7eb              B        |L1.98|
;;;613    
                          ENDP

                  COM_GetEmbSt PROC
;;;614    static  BSP_EMB_ST_TypeDef  COM_GetEmbSt (BSP_ID_TypeDef id)
00008a  4601              MOV      r1,r0
;;;615    {//注意这里是获取的刺绣的状态：补绣、正常绣、停绣，是告诉主控用的。响应的是主控0xF7命令
;;;616        if (COM_IsFault[id] == FALSE) {
00008c  48f5              LDR      r0,|L1.1124|
00008e  5c40              LDRB     r0,[r0,r1]
000090  b9a0              CBNZ     r0,|L1.188|
;;;617            switch (COM_UpStNow[id]) {
000092  48f5              LDR      r0,|L1.1128|
000094  5c40              LDRB     r0,[r0,r1]
000096  2807              CMP      r0,#7
000098  d20c              BCS      |L1.180|
00009a  e8dff000          TBB      [pc,r0]
00009e  0d08              DCB      0x0d,0x08
0000a0  090c0705          DCB      0x09,0x0c,0x07,0x05
0000a4  0400              DCB      0x04,0x00
;;;618            case COM_UP_ST_PATCH_BROKEN:
;;;619            case COM_UP_ST_PATCH_NORMAL:
0000a6  bf00              NOP      
;;;620    		
;;;621                return  BSP_EMB_ST_PATCH;//2
0000a8  2002              MOVS     r0,#2
                  |L1.170|
;;;622            case COM_UP_ST_PATCH_IDLE:
;;;623            case COM_UP_ST_NORMAL:
;;;624    		case COM_UP_ST_BROKEN://这里断线，但是对于主控来讲是正常绣的刺绣状态。
;;;625    			return  BSP_EMB_ST_NORMAL;//1因为如果是下断检，主控中会将剪线关闭，所以这里要返回正常，对应集中剪线返回正常与断线都一样	
;;;626            case COM_UP_ST_PATCH_LOCK:
;;;627            case COM_UP_ST_LOCK:
;;;628            default:
;;;629                return  BSP_EMB_ST_OFF;//0
;;;630            }
;;;631        } else {
;;;632            return  BSP_EMB_ST_OFF;
;;;633        }
;;;634    }
0000aa  4770              BX       lr
0000ac  bf00              NOP                            ;623
0000ae  bf00              NOP                            ;624
0000b0  2001              MOVS     r0,#1                 ;625
0000b2  e7fa              B        |L1.170|
                  |L1.180|
0000b4  bf00              NOP                            ;626
0000b6  bf00              NOP                            ;627
0000b8  2000              MOVS     r0,#0                 ;629
0000ba  e7f6              B        |L1.170|
                  |L1.188|
0000bc  2000              MOVS     r0,#0                 ;632
0000be  e7f4              B        |L1.170|
;;;635    
                          ENDP

                  COM_GetSqnEmbSt PROC
;;;636    static  BSP_EMB_ST_TypeDef  COM_GetSqnEmbSt (BSP_ID_TypeDef id)
0000c0  4601              MOV      r1,r0
;;;637    {
;;;638        if (COM_IsFault[id] == FALSE) {
0000c2  48e8              LDR      r0,|L1.1124|
0000c4  5c40              LDRB     r0,[r0,r1]
0000c6  b9a0              CBNZ     r0,|L1.242|
;;;639            switch (COM_UpStNow[id]) {
0000c8  48e7              LDR      r0,|L1.1128|
0000ca  5c40              LDRB     r0,[r0,r1]
0000cc  2807              CMP      r0,#7
0000ce  d20c              BCS      |L1.234|
0000d0  e8dff000          TBB      [pc,r0]
0000d4  0d09060c          DCB      0x0d,0x09,0x06,0x0c
0000d8  08050400          DCB      0x08,0x05,0x04,0x00
;;;640            case COM_UP_ST_PATCH_BROKEN:
;;;641            case COM_UP_ST_PATCH_NORMAL:
0000dc  bf00              NOP      
;;;642    		case COM_UP_ST_BROKEN://这里是断线，对与金片绣来讲就已经是补绣了，因为这样它才能亮红灯
0000de  bf00              NOP      
;;;643                return  BSP_EMB_ST_PATCH;
0000e0  2002              MOVS     r0,#2
                  |L1.226|
;;;644            case COM_UP_ST_PATCH_IDLE:
;;;645            case COM_UP_ST_NORMAL:
;;;646    			return  BSP_EMB_ST_NORMAL;	
;;;647            case COM_UP_ST_PATCH_LOCK:
;;;648            case COM_UP_ST_LOCK:
;;;649            default:
;;;650                return  BSP_EMB_ST_OFF;
;;;651            }
;;;652        } else {
;;;653            return  BSP_EMB_ST_OFF;
;;;654        }
;;;655    }
0000e2  4770              BX       lr
0000e4  bf00              NOP                            ;645
0000e6  2001              MOVS     r0,#1                 ;646
0000e8  e7fb              B        |L1.226|
                  |L1.234|
0000ea  bf00              NOP                            ;647
0000ec  bf00              NOP                            ;648
0000ee  2000              MOVS     r0,#0                 ;650
0000f0  e7f7              B        |L1.226|
                  |L1.242|
0000f2  2000              MOVS     r0,#0                 ;653
0000f4  e7f5              B        |L1.226|
;;;656    static  void  COM_LedUpdate (BSP_ID_TypeDef id)
                          ENDP

                  COM_LedUpdate PROC
0000f6  b570              PUSH     {r4-r6,lr}
;;;657    {
0000f8  4605              MOV      r5,r0
;;;658        HDLED_ST_TypeDef    led;
;;;659        
;;;660        
;;;661        if (COM_9511IsTset == FALSE) {                  /// 非测试状态才更新显示
0000fa  48dc              LDR      r0,|L1.1132|
0000fc  7800              LDRB     r0,[r0,#0]  ; COM_9511IsTset
0000fe  b9e0              CBNZ     r0,|L1.314|
;;;662            if (COM_IsFault[id] == FALSE) {             /// 未关闭故障机头, 按状态更新显示
000100  48d8              LDR      r0,|L1.1124|
000102  5d40              LDRB     r0,[r0,r5]
000104  b930              CBNZ     r0,|L1.276|
;;;663    /// !!! cy 100905
;;;664    //            led =   (HDLED_ST_TypeDef)((COM_UpStBits[COM_UpStNow[id]] >> COM_UP_BIT_HD_LED) & COM_UP_MSK_HD_LED);
;;;665                led =   COM_GetHDLedSt(COM_UpStNow[id],id);
000106  49d8              LDR      r1,|L1.1128|
000108  5d48              LDRB     r0,[r1,r5]
00010a  4629              MOV      r1,r5
00010c  f7fffffe          BL       COM_GetHDLedSt
000110  4604              MOV      r4,r0
000112  e000              B        |L1.278|
                  |L1.276|
;;;666    /// !!! cy 100905
;;;667            } else {                                    /// 关闭故障机头, 灯为灭
;;;668                led =   (HDLED_ST_TypeDef)HDLED_ST_OFF;
000114  2403              MOVS     r4,#3
                  |L1.278|
;;;669            }
;;;670            HDLED_Set(id, led);                         /// 更新显示
000116  4621              MOV      r1,r4
000118  4628              MOV      r0,r5
00011a  f7fffffe          BL       HDLED_Set
;;;671            
;;;672    
;;;673            if (BSP_DIP_RedIsSpkl) {
00011e  48d4              LDR      r0,|L1.1136|
000120  7800              LDRB     r0,[r0,#0]  ; BSP_DIP_RedIsSpkl
000122  b150              CBZ      r0,|L1.314|
;;;674                if (led == HDLED_ST_RED) {
000124  2c01              CMP      r4,#1
000126  d104              BNE      |L1.306|
;;;675                    HDLED_Sparkle(id, 1 << 30);
000128  07a1              LSLS     r1,r4,#30
00012a  4628              MOV      r0,r5
00012c  f7fffffe          BL       HDLED_Sparkle
000130  e003              B        |L1.314|
                  |L1.306|
;;;676                } else {
;;;677                    HDLED_Sparkle(id, 0);
000132  2100              MOVS     r1,#0
000134  4628              MOV      r0,r5
000136  f7fffffe          BL       HDLED_Sparkle
                  |L1.314|
;;;678                }
;;;679            }
;;;680    
;;;681        } else {                                        /// 测试状态不更新显示
;;;682            ;
;;;683        }
;;;684    }
00013a  bd70              POP      {r4-r6,pc}
;;;685    
                          ENDP

                  MOT_CUT_Get_SwiDirIsStatus PROC
;;;686    static void MOT_CUT_Get_SwiDirIsStatus()
00013c  b510              PUSH     {r4,lr}
;;;687    {
;;;688    		u32 id;
;;;689    		for(id=0;id<BSP_DEVICE_ID_N;id++)
00013e  2400              MOVS     r4,#0
000140  e00f              B        |L1.354|
                  |L1.322|
;;;690    		{
;;;691    	    if ((BSP_SWI_FiGet(id) == BSP_SWITCH_LOW)||(COM_9511TangkongDir==FALSE)) /// 如没有回位, 需回位
000142  b2e0              UXTB     r0,r4
000144  f7fffffe          BL       BSP_SWI_FiGet
000148  2801              CMP      r0,#1
00014a  d002              BEQ      |L1.338|
00014c  48c9              LDR      r0,|L1.1140|
00014e  7800              LDRB     r0,[r0,#0]  ; COM_9511TangkongDir
000150  b918              CBNZ     r0,|L1.346|
                  |L1.338|
;;;692    		     COM_SwiDirIsEnable[id]=TRUE;
000152  2001              MOVS     r0,#1
000154  49c8              LDR      r1,|L1.1144|
000156  5508              STRB     r0,[r1,r4]
000158  e002              B        |L1.352|
                  |L1.346|
;;;693    		else
;;;694    			COM_SwiDirIsEnable[id]=FALSE;
00015a  2000              MOVS     r0,#0
00015c  49c6              LDR      r1,|L1.1144|
00015e  5508              STRB     r0,[r1,r4]
                  |L1.352|
000160  1c64              ADDS     r4,r4,#1              ;689
                  |L1.354|
000162  2c02              CMP      r4,#2                 ;689
000164  d3ed              BCC      |L1.322|
;;;695    		}			
;;;696    }
000166  bd10              POP      {r4,pc}
;;;697    /// cy  110304
                          ENDP

                  COM_HghUpdate PROC
;;;698    //static  void  COM_HghUpdate (BSP_ID_TypeDef id)
;;;699    static  bool  COM_HghUpdate (BSP_ID_TypeDef id)
000168  b570              PUSH     {r4-r6,lr}
;;;700    /// cy  110304
;;;701    {
00016a  4604              MOV      r4,r0
;;;702        MOTO_HGH_CMD_TypeDef    cmd;
;;;703    	MOT_CUT_Get_SwiDirIsStatus();
00016c  f7fffffe          BL       MOT_CUT_Get_SwiDirIsStatus
;;;704            if ((((COM_GetIsDrop(COM_UpStNow[id]) != FALSE)&&(COM_TKIsEnable[id]==TRUE)&&(COM_SwiDirIsEnable[id]==TRUE))||
000170  49bd              LDR      r1,|L1.1128|
000172  5d08              LDRB     r0,[r1,r4]
000174  f7fffffe          BL       COM_GetIsDrop
000178  b138              CBZ      r0,|L1.394|
00017a  48c0              LDR      r0,|L1.1148|
00017c  5d00              LDRB     r0,[r0,r4]
00017e  2801              CMP      r0,#1
000180  d103              BNE      |L1.394|
000182  48bd              LDR      r0,|L1.1144|
000184  5d00              LDRB     r0,[r0,r4]
000186  2801              CMP      r0,#1
000188  d017              BEQ      |L1.442|
                  |L1.394|
;;;705    			((COM_GetIsDrop(COM_UpStNow[id]) != FALSE)&&(COM_9511TangkongDir==FALSE)&&((MOTO_CUT_CMD_TypeDef)COM_Tangkong_WorkCmd==MOTO_CUT_D))||
00018a  49b7              LDR      r1,|L1.1128|
00018c  5d08              LDRB     r0,[r1,r4]
00018e  f7fffffe          BL       COM_GetIsDrop
000192  b130              CBZ      r0,|L1.418|
000194  48b7              LDR      r0,|L1.1140|
000196  7800              LDRB     r0,[r0,#0]  ; COM_9511TangkongDir
000198  b918              CBNZ     r0,|L1.418|
00019a  48b9              LDR      r0,|L1.1152|
00019c  7800              LDRB     r0,[r0,#0]  ; COM_Tangkong_WorkCmd
00019e  280a              CMP      r0,#0xa
0001a0  d00b              BEQ      |L1.442|
                  |L1.418|
;;;706    			((COM_GetIsDrop(COM_UpStNow[id]) != FALSE)&&(COM_9511TangkongEnable[id]==FALSE)&&((MOTO_CUT_CMD_TypeDef)COM_Tangkong_WorkCmd==MOTO_CUT_D)))&&
0001a2  49b1              LDR      r1,|L1.1128|
0001a4  5d08              LDRB     r0,[r1,r4]
0001a6  f7fffffe          BL       COM_GetIsDrop
0001aa  b188              CBZ      r0,|L1.464|
0001ac  48b5              LDR      r0,|L1.1156|
0001ae  5d00              LDRB     r0,[r0,r4]
0001b0  b970              CBNZ     r0,|L1.464|
0001b2  48b3              LDR      r0,|L1.1152|
0001b4  7800              LDRB     r0,[r0,#0]  ; COM_Tangkong_WorkCmd
0001b6  280a              CMP      r0,#0xa
0001b8  d10a              BNE      |L1.464|
                  |L1.442|
;;;707    			(COM_IsFault[id]==FALSE)&&
0001ba  48aa              LDR      r0,|L1.1124|
0001bc  5d00              LDRB     r0,[r0,r4]
0001be  b938              CBNZ     r0,|L1.464|
;;;708    			(IN_HDKey_GetSt((BSP_ID_TypeDef)id)!=HDKEY_ST_DN)){          /// 落针, 参与刺绣, 按命令运动
0001c0  4620              MOV      r0,r4
0001c2  f7fffffe          BL       IN_HDKey_GetSt
0001c6  2802              CMP      r0,#2
0001c8  d002              BEQ      |L1.464|
;;;709    /// !!! cy 100905
;;;710                cmd =   (MOTO_CUT_CMD_TypeDef)COM_Tangkong_WorkCmd;
0001ca  48ad              LDR      r0,|L1.1152|
0001cc  7805              LDRB     r5,[r0,#0]  ; COM_Tangkong_WorkCmd
0001ce  e000              B        |L1.466|
                  |L1.464|
;;;711            } else {                                                /// 不参与刺绣, 提升
;;;712                cmd =   (MOTO_HGH_CMD_TypeDef)MOTO_CUT_NONE;
0001d0  2510              MOVS     r5,#0x10
                  |L1.466|
;;;713    
;;;714            }
;;;715    	/*	if((COM_Tangkong_WorkCmd==MOTO_CUT_D)||(COM_Tangkong_WorkCmd==MOTO_CUT_FULL))
;;;716    			HeadUpDown_Status[id]=0;
;;;717    		else if(COM_Tangkong_WorkCmd==MOTO_CUT_H)
;;;718    			HeadUpDown_Status[id]=0;
;;;719    		else if(COM_Tangkong_WorkCmd==MOTO_CUT_HALF)
;;;720    			HeadUpDown_Status[id]=0; */ 
;;;721            MOTO_CutSetCmd(id, cmd);
0001d2  4629              MOV      r1,r5
0001d4  4620              MOV      r0,r4
0001d6  f7fffffe          BL       MOTO_CutSetCmd
;;;722            COM_IsHghRest = FALSE;                                  /// 上电后有针高操作则针高以后可以动作
0001da  2000              MOVS     r0,#0
0001dc  49aa              LDR      r1,|L1.1160|
0001de  7008              STRB     r0,[r1,#0]
;;;723    
;;;724    /// cy  110304
;;;725    //    } else {                                                    /// 否则, 不动作
;;;726    //        ;
;;;727    //    }
;;;728            return  TRUE;
0001e0  2001              MOVS     r0,#1
;;;729       /* } else {                                                    /// 否则, 不动作
;;;730            return  FALSE;
;;;731        }*/
;;;732    /// cy  110304
;;;733    }
0001e2  bd70              POP      {r4-r6,pc}
;;;734    static  bool  COM_HghUpdate_key (BSP_ID_TypeDef id)
                          ENDP

                  COM_HghUpdate_key PROC
0001e4  b570              PUSH     {r4-r6,lr}
;;;735    /// cy  110304
;;;736    {
0001e6  4604              MOV      r4,r0
;;;737        MOTO_HGH_CMD_TypeDef    cmd;
;;;738    		MOT_CUT_Get_SwiDirIsStatus();
0001e8  f7fffffe          BL       MOT_CUT_Get_SwiDirIsStatus
;;;739            if (((((COM_GetIsDrop(COM_UpStNow[id]) != FALSE)||(COM_GetIsDrop(COM_UpStLast[id]) != FALSE))&&(COM_TKIsEnable[id]==TRUE)
0001ec  499e              LDR      r1,|L1.1128|
0001ee  5d08              LDRB     r0,[r1,r4]
0001f0  f7fffffe          BL       COM_GetIsDrop
0001f4  b920              CBNZ     r0,|L1.512|
0001f6  499a              LDR      r1,|L1.1120|
0001f8  5d08              LDRB     r0,[r1,r4]
0001fa  f7fffffe          BL       COM_GetIsDrop
0001fe  b138              CBZ      r0,|L1.528|
                  |L1.512|
000200  489e              LDR      r0,|L1.1148|
000202  5d00              LDRB     r0,[r0,r4]
000204  2801              CMP      r0,#1
000206  d103              BNE      |L1.528|
;;;740    		&&(COM_SwiDirIsEnable[id]==TRUE))||(COM_9511IsTset==TRUE))
000208  489b              LDR      r0,|L1.1144|
00020a  5d00              LDRB     r0,[r0,r4]
00020c  2801              CMP      r0,#1
00020e  d003              BEQ      |L1.536|
                  |L1.528|
000210  4896              LDR      r0,|L1.1132|
000212  7800              LDRB     r0,[r0,#0]  ; COM_9511IsTset
000214  2801              CMP      r0,#1
000216  d105              BNE      |L1.548|
                  |L1.536|
;;;741    		&&(COM_IsFault[id]==FALSE))
000218  4892              LDR      r0,|L1.1124|
00021a  5d00              LDRB     r0,[r0,r4]
00021c  b910              CBNZ     r0,|L1.548|
;;;742    		 {          /// 落针, 参与刺绣, 按命令运动
;;;743    /// !!! cy 100905
;;;744                cmd =   (MOTO_CUT_CMD_TypeDef)COM_Tangkong_WorkCmd;
00021e  4898              LDR      r0,|L1.1152|
000220  7805              LDRB     r5,[r0,#0]  ; COM_Tangkong_WorkCmd
000222  e000              B        |L1.550|
                  |L1.548|
;;;745            } else {                                                /// 不参与刺绣, 提升
;;;746                cmd =   (MOTO_HGH_CMD_TypeDef)MOTO_CUT_NONE;
000224  2510              MOVS     r5,#0x10
                  |L1.550|
;;;747    
;;;748            }
;;;749    	/*	if((COM_Tangkong_WorkCmd==MOTO_CUT_D)||(COM_Tangkong_WorkCmd==MOTO_CUT_FULL))
;;;750    			HeadUpDown_Status[id]=0;
;;;751    		else if(COM_Tangkong_WorkCmd==MOTO_CUT_H)
;;;752    			HeadUpDown_Status[id]=0;
;;;753    		else if(COM_Tangkong_WorkCmd==MOTO_CUT_HALF)
;;;754    			HeadUpDown_Status[id]=0; */
;;;755            MOTO_CutSetCmd(id, cmd);
000226  4629              MOV      r1,r5
000228  4620              MOV      r0,r4
00022a  f7fffffe          BL       MOTO_CutSetCmd
;;;756            COM_IsHghRest = FALSE;                                  /// 上电后有针高操作则针高以后可以动作
00022e  2000              MOVS     r0,#0
000230  4995              LDR      r1,|L1.1160|
000232  7008              STRB     r0,[r1,#0]
;;;757    
;;;758    /// cy  110304
;;;759    //    } else {                                                    /// 否则, 不动作
;;;760    //        ;
;;;761    //    }
;;;762            return  TRUE;
000234  2001              MOVS     r0,#1
;;;763       /* } else {                                                    /// 否则, 不动作
;;;764            return  FALSE;
;;;765        }*/
;;;766    /// cy  110304
;;;767    }
000236  bd70              POP      {r4-r6,pc}
;;;768    static  void  COM_SqnUpdate (BSP_ID_TypeDef id)
                          ENDP

                  COM_SqnUpdate PROC
000238  b570              PUSH     {r4-r6,lr}
;;;769    {
00023a  4604              MOV      r4,r0
;;;770        BSP_SQN_EmbStSend(id, COM_GetSqnEmbSt(id));
00023c  4620              MOV      r0,r4
00023e  f7fffffe          BL       COM_GetSqnEmbSt
000242  4605              MOV      r5,r0
000244  4601              MOV      r1,r0
000246  4620              MOV      r0,r4
000248  f7fffffe          BL       BSP_SQN_EmbStSend
;;;771    }
00024c  bd70              POP      {r4-r6,pc}
;;;772    
                          ENDP

                  COM_9511EmbStToBit PROC
;;;774    
;;;775    static  u16  COM_9511EmbStToBit (BSP_EMB_ST_TypeDef st)
00024e  4601              MOV      r1,r0
;;;776    {
;;;777        switch (st) {
000250  b141              CBZ      r1,|L1.612|
000252  2901              CMP      r1,#1
000254  d003              BEQ      |L1.606|
000256  2902              CMP      r1,#2
000258  d103              BNE      |L1.610|
;;;778        case BSP_EMB_ST_PATCH: //2
;;;779            return  1 << 3;
00025a  2008              MOVS     r0,#8
                  |L1.604|
;;;780        case BSP_EMB_ST_NORMAL:	//1
;;;781            return  1 << 2;
;;;782        case BSP_EMB_ST_OFF: //0
;;;783        default:
;;;784            return  1 << 1;
;;;785        }
;;;786    }
00025c  4770              BX       lr
                  |L1.606|
00025e  2004              MOVS     r0,#4                 ;781
000260  e7fc              B        |L1.604|
                  |L1.610|
000262  bf00              NOP                            ;782
                  |L1.612|
000264  2002              MOVS     r0,#2                 ;784
000266  e7f9              B        |L1.604|
;;;787    
                          ENDP

                  COM_HighCmd PROC
;;;795    ////////
;;;796    static  void  COM_HighCmd (u8 high)//针高函数
000268  b570              PUSH     {r4-r6,lr}
;;;797    {
00026a  4604              MOV      r4,r0
;;;798        u32     i;
;;;799              COM_Tangkong_WorkHigh=high;
00026c  4887              LDR      r0,|L1.1164|
00026e  7004              STRB     r4,[r0,#0]
;;;800    		 if((high>0)&&(high<10))
000270  2c00              CMP      r4,#0
000272  dd18              BLE      |L1.678|
000274  2c0a              CMP      r4,#0xa
000276  da16              BGE      |L1.678|
;;;801    		 {
;;;802    		  MOTO_TKSetHalfAngle(Tangkong_High[COM_Tangkong_WorkHigh]);
000278  4985              LDR      r1,|L1.1168|
00027a  4602              MOV      r2,r0
00027c  7812              LDRB     r2,[r2,#0]  ; COM_Tangkong_WorkHigh
00027e  5c88              LDRB     r0,[r1,r2]
000280  f7fffffe          BL       MOTO_TKSetHalfAngle
;;;803    		  MOTO_TKSetFullAngle(Tangkong_High[COM_Tangkong_WorkHigh]);
000284  4982              LDR      r1,|L1.1168|
000286  4a81              LDR      r2,|L1.1164|
000288  7812              LDRB     r2,[r2,#0]  ; COM_Tangkong_WorkHigh
00028a  5c88              LDRB     r0,[r1,r2]
00028c  f7fffffe          BL       MOTO_TKSetFullAngle
;;;804    		   if(COM_9511TangkongDir==FALSE)
000290  4878              LDR      r0,|L1.1140|
000292  7800              LDRB     r0,[r0,#0]  ; COM_9511TangkongDir
000294  b918              CBNZ     r0,|L1.670|
;;;805    		   	//	COM_ID_9511CutHalf(id,0,0);
;;;806    				COM_Tangkong_WorkCmd=MOTO_CUT_HALF;
000296  200d              MOVS     r0,#0xd
000298  4979              LDR      r1,|L1.1152|
00029a  7008              STRB     r0,[r1,#0]
00029c  e017              B        |L1.718|
                  |L1.670|
;;;807    		   else
;;;808    		      //  COM_ID_9511CutFull(id,0,0);
;;;809    			  COM_Tangkong_WorkCmd=MOTO_CUT_FULL;
00029e  200e              MOVS     r0,#0xe
0002a0  4977              LDR      r1,|L1.1152|
0002a2  7008              STRB     r0,[r1,#0]
0002a4  e013              B        |L1.718|
                  |L1.678|
;;;810    		}
;;;811    		else if(high==0)
0002a6  b91c              CBNZ     r4,|L1.688|
;;;812    			COM_Tangkong_WorkCmd=MOTO_CUT_D;
0002a8  200a              MOVS     r0,#0xa
0002aa  4975              LDR      r1,|L1.1152|
0002ac  7008              STRB     r0,[r1,#0]
0002ae  e00e              B        |L1.718|
                  |L1.688|
;;;813    		else if(high==10)
0002b0  2c0a              CMP      r4,#0xa
0002b2  d103              BNE      |L1.700|
;;;814    			COM_Tangkong_WorkCmd=MOTO_CUT_H;
0002b4  200b              MOVS     r0,#0xb
0002b6  4972              LDR      r1,|L1.1152|
0002b8  7008              STRB     r0,[r1,#0]
0002ba  e008              B        |L1.718|
                  |L1.700|
;;;815    		else if(high==11)
0002bc  2c0b              CMP      r4,#0xb
0002be  d103              BNE      |L1.712|
;;;816    			COM_Tangkong_WorkCmd=MOTO_CUT_O;
0002c0  200f              MOVS     r0,#0xf
0002c2  496f              LDR      r1,|L1.1152|
0002c4  7008              STRB     r0,[r1,#0]
0002c6  e002              B        |L1.718|
                  |L1.712|
;;;817    		else
;;;818    			COM_Tangkong_WorkCmd=MOTO_CUT_NONE;
0002c8  2010              MOVS     r0,#0x10
0002ca  496d              LDR      r1,|L1.1152|
0002cc  7008              STRB     r0,[r1,#0]
                  |L1.718|
;;;819        // COM_WorkHigh        =   high;
;;;820        /// cy 101217 added
;;;821        /// 因为有发针高前没有发主轴到位的情况
;;;822        /// "跳跃剪线"参数设为否时, 越框前, 主控发不到位, 越框程序升起针高没有被执行, 针在下位就越框了
;;;823        COM_9511MAIsInOrg   =   TRUE;
0002ce  2001              MOVS     r0,#1
0002d0  4970              LDR      r1,|L1.1172|
0002d2  7008              STRB     r0,[r1,#0]
;;;824        /// cy 101217 added
;;;825        for (i = 0; i < BSP_DEVICE_ID_N; i++) {
0002d4  2500              MOVS     r5,#0
0002d6  e00a              B        |L1.750|
                  |L1.728|
;;;826    		COM_TKIsEnable[i]=TRUE;
0002d8  2001              MOVS     r0,#1
0002da  4968              LDR      r1,|L1.1148|
0002dc  5548              STRB     r0,[r1,r5]
;;;827    		if(high==0)
0002de  b914              CBNZ     r4,|L1.742|
;;;828    			COM_9511TangkongEnable[i]=FALSE;
0002e0  2000              MOVS     r0,#0
0002e2  4968              LDR      r1,|L1.1156|
0002e4  5548              STRB     r0,[r1,r5]
                  |L1.742|
;;;829            COM_HghUpdate((BSP_ID_TypeDef)i);
0002e6  b2e8              UXTB     r0,r5
0002e8  f7fffffe          BL       COM_HghUpdate
0002ec  1c6d              ADDS     r5,r5,#1              ;825
                  |L1.750|
0002ee  2d02              CMP      r5,#2                 ;825
0002f0  d3f2              BCC      |L1.728|
;;;830        }
;;;831        
;;;832    //    /// cy 100906
;;;833    //    if (COM_9511IsTset != FALSE) {
;;;834    //        COM_9511TestExit(buf, len);
;;;835    //    }
;;;836    //    /// cy 100906
;;;837    }
0002f2  bd70              POP      {r4-r6,pc}
;;;838    
                          ENDP

                  COM_9511Decode PROC
;;;845    ////////
;;;846    static  u16  COM_9511Decode (u16 buf[], u8 len)
0002f4  b5f0              PUSH     {r4-r7,lr}
;;;847    {
0002f6  4602              MOV      r2,r0
0002f8  460b              MOV      r3,r1
;;;848        const   u8      nbit    =   2;
0002fa  2502              MOVS     r5,#2
;;;849                u8      q;
;;;850                u8      r;
;;;851        
;;;852    	if((BSP_DIP_9511Addr>0)&&(BSP_DIP_9511Addr<0x10))
0002fc  4866              LDR      r0,|L1.1176|
0002fe  7800              LDRB     r0,[r0,#0]  ; BSP_DIP_9511Addr
000300  2800              CMP      r0,#0
000302  dd12              BLE      |L1.810|
000304  4864              LDR      r0,|L1.1176|
000306  7800              LDRB     r0,[r0,#0]  ; BSP_DIP_9511Addr
000308  2810              CMP      r0,#0x10
00030a  da0e              BGE      |L1.810|
;;;853    	{    
;;;854        	q   =   (BSP_DIP_9511Addr - 1) / 3;
00030c  4862              LDR      r0,|L1.1176|
00030e  7800              LDRB     r0,[r0,#0]  ; BSP_DIP_9511Addr
000310  1e40              SUBS     r0,r0,#1
000312  2603              MOVS     r6,#3
000314  fb90f0f6          SDIV     r0,r0,r6
000318  b2c1              UXTB     r1,r0
;;;855        	r   =   (BSP_DIP_9511Addr - 1) % 3;
00031a  485f              LDR      r0,|L1.1176|
00031c  7800              LDRB     r0,[r0,#0]  ; BSP_DIP_9511Addr
00031e  1e40              SUBS     r0,r0,#1
000320  fb90f7f6          SDIV     r7,r0,r6
000324  fb060017          MLS      r0,r6,r7,r0
000328  b2c4              UXTB     r4,r0
                  |L1.810|
;;;856    	}
;;;857    	if((BSP_DIP_9511Addr>0x70)&&(BSP_DIP_9511Addr<0x80))
00032a  485b              LDR      r0,|L1.1176|
00032c  7800              LDRB     r0,[r0,#0]  ; BSP_DIP_9511Addr
00032e  2870              CMP      r0,#0x70
000330  dd12              BLE      |L1.856|
000332  4859              LDR      r0,|L1.1176|
000334  7800              LDRB     r0,[r0,#0]  ; BSP_DIP_9511Addr
000336  2880              CMP      r0,#0x80
000338  da0e              BGE      |L1.856|
;;;858    	{    
;;;859        	q   =   (BSP_DIP_9511Addr-0x70 - 1) / 3;
00033a  4857              LDR      r0,|L1.1176|
00033c  7800              LDRB     r0,[r0,#0]  ; BSP_DIP_9511Addr
00033e  3871              SUBS     r0,r0,#0x71
000340  2603              MOVS     r6,#3
000342  fb90f0f6          SDIV     r0,r0,r6
000346  b2c1              UXTB     r1,r0
;;;860        	r   =   (BSP_DIP_9511Addr-0x70 - 1) % 3;
000348  4853              LDR      r0,|L1.1176|
00034a  7800              LDRB     r0,[r0,#0]  ; BSP_DIP_9511Addr
00034c  3871              SUBS     r0,r0,#0x71
00034e  fb90f7f6          SDIV     r7,r0,r6
000352  fb060017          MLS      r0,r6,r7,r0
000356  b2c4              UXTB     r4,r0
                  |L1.856|
;;;861    	}
;;;862         
;;;863        if (q < len) {
000358  4299              CMP      r1,r3
00035a  db01              BLT      |L1.864|
;;;864            ;
;;;865        } else {
;;;866            q   =   0;
00035c  2100              MOVS     r1,#0
;;;867            r   =   0;
00035e  2400              MOVS     r4,#0
                  |L1.864|
;;;868        }
;;;869        
;;;870        return  (buf[q] >> (nbit * (3 - 1 - r))) & ((1 << nbit) - 1);
000360  f8320011          LDRH     r0,[r2,r1,LSL #1]
000364  f1c40602          RSB      r6,r4,#2
000368  0076              LSLS     r6,r6,#1
00036a  4130              ASRS     r0,r0,r6
00036c  2601              MOVS     r6,#1
00036e  ebc60686          RSB      r6,r6,r6,LSL #2
000372  4030              ANDS     r0,r0,r6
;;;871    /*	}
;;;872    	else
;;;873    		return 0;  */
;;;874    	 
;;;875    }
000374  bdf0              POP      {r4-r7,pc}
;;;876    static  void  COM_CmdDoNothing (u16 buf[], u8 len)
                          ENDP

                  COM_CmdDoNothing PROC
000376  4770              BX       lr
;;;877    {
;;;878        ;
;;;879    }
;;;880    
                          ENDP

                  COM_Tangkong_HighTo10 PROC
;;;889    
;;;890    static void COM_Tangkong_HighTo10(u16 buf[], u8 len)
000378  b570              PUSH     {r4-r6,lr}
;;;891    {	  
00037a  4604              MOV      r4,r0
00037c  460d              MOV      r5,r1
;;;892    			 
;;;893    		     COM_HighCmd(10);
00037e  200a              MOVS     r0,#0xa
000380  f7fffffe          BL       COM_HighCmd
;;;894    
;;;895    }
000384  bd70              POP      {r4-r6,pc}
;;;896    /*static void COM_ID_Tangkong_HighToD(BSP_ID_TypeDef id,u16 buf[], u8 len)
                          ENDP

                  COM_Tangkong_HighTo0 PROC
;;;901    }*/	
;;;902    void  COM_Tangkong_HighTo0 (u16 buf[], u8 len)
000386  b570              PUSH     {r4-r6,lr}
;;;903    {		 
000388  4604              MOV      r4,r0
00038a  460d              MOV      r5,r1
;;;904    //    COM_9511TangkongEnable             =   FALSE;
;;;905        COM_HighCmd(0);
00038c  2000              MOVS     r0,#0
00038e  f7fffffe          BL       COM_HighCmd
;;;906    }
000392  bd70              POP      {r4-r6,pc}
;;;907    static  void  COM_Tangkong_HighTo1 (u16 buf[], u8 len)
                          ENDP

                  COM_Tangkong_HighTo1 PROC
000394  b570              PUSH     {r4-r6,lr}
;;;908    {
000396  4604              MOV      r4,r0
000398  460d              MOV      r5,r1
;;;909    //	HeadUpDown_Status=0;
;;;910        COM_HighCmd(1);
00039a  2001              MOVS     r0,#1
00039c  f7fffffe          BL       COM_HighCmd
;;;911    }
0003a0  bd70              POP      {r4-r6,pc}
;;;912    static  void  COM_Tangkong_HighTo2 (u16 buf[], u8 len)
                          ENDP

                  COM_Tangkong_HighTo2 PROC
0003a2  b570              PUSH     {r4-r6,lr}
;;;913    {
0003a4  4604              MOV      r4,r0
0003a6  460d              MOV      r5,r1
;;;914    //	HeadUpDown_Status=0;
;;;915        COM_HighCmd(2);
0003a8  2002              MOVS     r0,#2
0003aa  f7fffffe          BL       COM_HighCmd
;;;916    }
0003ae  bd70              POP      {r4-r6,pc}
;;;917    static  void  COM_Tangkong_HighTo3 (u16 buf[], u8 len)
                          ENDP

                  COM_Tangkong_HighTo3 PROC
0003b0  b570              PUSH     {r4-r6,lr}
;;;918    {
0003b2  4604              MOV      r4,r0
0003b4  460d              MOV      r5,r1
;;;919    //	HeadUpDown_Status=0;
;;;920        COM_HighCmd(3);
0003b6  2003              MOVS     r0,#3
0003b8  f7fffffe          BL       COM_HighCmd
;;;921    }
0003bc  bd70              POP      {r4-r6,pc}
;;;922    static  void  COM_Tangkong_HighTo4 (u16 buf[], u8 len)
                          ENDP

                  COM_Tangkong_HighTo4 PROC
0003be  b570              PUSH     {r4-r6,lr}
;;;923    {
0003c0  4604              MOV      r4,r0
0003c2  460d              MOV      r5,r1
;;;924    //	HeadUpDown_Status=0;
;;;925        COM_HighCmd(4);
0003c4  2004              MOVS     r0,#4
0003c6  f7fffffe          BL       COM_HighCmd
;;;926    }
0003ca  bd70              POP      {r4-r6,pc}
;;;927    static  void  COM_Tangkong_HighTo5 (u16 buf[], u8 len)
                          ENDP

                  COM_Tangkong_HighTo5 PROC
0003cc  b570              PUSH     {r4-r6,lr}
;;;928    {
0003ce  4604              MOV      r4,r0
0003d0  460d              MOV      r5,r1
;;;929    //	HeadUpDown_Status=0;
;;;930        COM_HighCmd(5);
0003d2  2005              MOVS     r0,#5
0003d4  f7fffffe          BL       COM_HighCmd
;;;931    }
0003d8  bd70              POP      {r4-r6,pc}
;;;932    static  void COM_Tangkong_HighTo6 (u16 buf[], u8 len)
                          ENDP

                  COM_Tangkong_HighTo6 PROC
0003da  b570              PUSH     {r4-r6,lr}
;;;933    {
0003dc  4604              MOV      r4,r0
0003de  460d              MOV      r5,r1
;;;934    //	HeadUpDown_Status=0;
;;;935        COM_HighCmd(6);
0003e0  2006              MOVS     r0,#6
0003e2  f7fffffe          BL       COM_HighCmd
;;;936    }
0003e6  bd70              POP      {r4-r6,pc}
;;;937    static  void  COM_Tangkong_HighTo7 (u16 buf[], u8 len)
                          ENDP

                  COM_Tangkong_HighTo7 PROC
0003e8  b570              PUSH     {r4-r6,lr}
;;;938    {
0003ea  4604              MOV      r4,r0
0003ec  460d              MOV      r5,r1
;;;939    //	HeadUpDown_Status=0;
;;;940        COM_HighCmd(7);
0003ee  2007              MOVS     r0,#7
0003f0  f7fffffe          BL       COM_HighCmd
;;;941    }
0003f4  bd70              POP      {r4-r6,pc}
;;;942    static  void  COM_Tangkong_HighTo8 (u16 buf[], u8 len)
                          ENDP

                  COM_Tangkong_HighTo8 PROC
0003f6  b570              PUSH     {r4-r6,lr}
;;;943    {
0003f8  4604              MOV      r4,r0
0003fa  460d              MOV      r5,r1
;;;944    //	HeadUpDown_Status=0;
;;;945        COM_HighCmd(8);
0003fc  2008              MOVS     r0,#8
0003fe  f7fffffe          BL       COM_HighCmd
;;;946    }
000402  bd70              POP      {r4-r6,pc}
;;;947    static  void  COM_Tangkong_HighTo9 (u16 buf[], u8 len)
                          ENDP

                  COM_Tangkong_HighTo9 PROC
000404  b570              PUSH     {r4-r6,lr}
;;;948    {
000406  4604              MOV      r4,r0
000408  460d              MOV      r5,r1
;;;949    //	HeadUpDown_Status=0;
;;;950        COM_HighCmd(9);
00040a  2009              MOVS     r0,#9
00040c  f7fffffe          BL       COM_HighCmd
;;;951    } 
000410  bd70              POP      {r4-r6,pc}
;;;952    /*static  void  COM_Tangkong_HighTo10 (u16 buf[], u8 len)
                          ENDP

                  COM_HeadSpeed PROC
;;;955    }*/
;;;956    static  void  COM_HeadSpeed (u16 buf[], u8 len)
000412  b530              PUSH     {r4,r5,lr}
;;;957    {
000414  4602              MOV      r2,r0
000416  460b              MOV      r3,r1
;;;958    	u16 buf_tmp,len_tmp=0;
000418  2000              MOVS     r0,#0
;;;959    	buf_tmp=buf[0];
00041a  8811              LDRH     r1,[r2,#0]
;;;960    	len_tmp=(buf_tmp-0x80);
00041c  f1a10480          SUB      r4,r1,#0x80
000420  b2a0              UXTH     r0,r4
;;;961    	if((len_tmp<5)&&(len_tmp>=0))
000422  2805              CMP      r0,#5
000424  da06              BGE      |L1.1076|
000426  2800              CMP      r0,#0
000428  db04              BLT      |L1.1076|
;;;962    		UpHeadSpeed=Speed_pare[len_tmp];
00042a  4c1c              LDR      r4,|L1.1180|
00042c  5c24              LDRB     r4,[r4,r0]
00042e  4d1c              LDR      r5,|L1.1184|
000430  702c              STRB     r4,[r5,#0]
000432  e002              B        |L1.1082|
                  |L1.1076|
;;;963    	else
;;;964    		UpHeadSpeed=100;
000434  2464              MOVS     r4,#0x64
000436  4d1a              LDR      r5,|L1.1184|
000438  702c              STRB     r4,[r5,#0]
                  |L1.1082|
;;;965    }
00043a  bd30              POP      {r4,r5,pc}
;;;966    static  void  COM_HeadUpDown(u16 buf[], u8 len)
                          ENDP

                  COM_HeadUpDown PROC
00043c  4770              BX       lr
;;;967    {
;;;968       
;;;969     //  HeadUpDown=1;
;;;970    // 	HeadUpDown_Status=1;
;;;971    //   COM_HighCmd(COM_WorkHigh);
;;;972    }
;;;973    static  u16  COM_Get9511TKStatus (void)
                          ENDP

                  COM_Get9511TKStatus PROC
00043e  b538              PUSH     {r3-r5,lr}
;;;974    {
;;;975        MOTO_ST_TypeDef     MotoSt[BSP_DEVICE_ID_N];
;;;976        bool                broken[BSP_DEVICE_ID_N];
;;;977        u32                 i;
;;;978        u16                 rt;
;;;979        
;;;980        
;;;981        for (i = 0; i < BSP_DEVICE_ID_N; i++) {
000440  2400              MOVS     r4,#0
000442  e035              B        |L1.1200|
                  |L1.1092|
;;;982            if ((COM_IsFault[i] == FALSE) && (COM_DnIsEnable[i] == TRUE)) {
000444  4807              LDR      r0,|L1.1124|
000446  5d00              LDRB     r0,[r0,r4]
000448  b948              CBNZ     r0,|L1.1118|
00044a  4816              LDR      r0,|L1.1188|
00044c  5d00              LDRB     r0,[r0,r4]
00044e  2801              CMP      r0,#1
000450  d12a              BNE      |L1.1192|
;;;983                MotoSt[i]   =   MOTO_CutGetState((BSP_ID_TypeDef)i);
000452  b2e0              UXTB     r0,r4
000454  f7fffffe          BL       MOTO_CutGetState
000458  f80d0004          STRB     r0,[sp,r4]
00045c  e027              B        |L1.1198|
                  |L1.1118|
00045e  e023              B        |L1.1192|
                  |L1.1120|
                          DCD      COM_UpStLast
                  |L1.1124|
                          DCD      COM_IsFault
                  |L1.1128|
                          DCD      COM_UpStNow
                  |L1.1132|
                          DCD      COM_9511IsTset
                  |L1.1136|
                          DCD      BSP_DIP_RedIsSpkl
                  |L1.1140|
                          DCD      COM_9511TangkongDir
                  |L1.1144|
                          DCD      COM_SwiDirIsEnable
                  |L1.1148|
                          DCD      COM_TKIsEnable
                  |L1.1152|
                          DCD      COM_Tangkong_WorkCmd
                  |L1.1156|
                          DCD      COM_9511TangkongEnable
                  |L1.1160|
                          DCD      COM_IsHghRest
                  |L1.1164|
                          DCD      COM_Tangkong_WorkHigh
                  |L1.1168|
                          DCD      Tangkong_High
                  |L1.1172|
                          DCD      COM_9511MAIsInOrg
                  |L1.1176|
                          DCD      BSP_DIP_9511Addr
                  |L1.1180|
                          DCD      Speed_pare
                  |L1.1184|
                          DCD      UpHeadSpeed
                  |L1.1188|
                          DCD      COM_DnIsEnable
                  |L1.1192|
;;;984            } else {
;;;985                MotoSt[i]   =   MOTO_ST_OK;
0004a8  2005              MOVS     r0,#5
0004aa  f80d0004          STRB     r0,[sp,r4]
                  |L1.1198|
0004ae  1c64              ADDS     r4,r4,#1              ;981
                  |L1.1200|
0004b0  2c02              CMP      r4,#2                 ;981
0004b2  d3c7              BCC      |L1.1092|
;;;986            }
;;;987        }
;;;988        
;;;989        if ((MotoSt[BSP_ID_ODD] == MOTO_ST_ACTING) || (MotoSt[BSP_ID_EVEN] == MOTO_ST_ACTING)) {
0004b4  f89d0000          LDRB     r0,[sp,#0]
0004b8  b110              CBZ      r0,|L1.1216|
0004ba  f89d0001          LDRB     r0,[sp,#1]
0004be  b908              CBNZ     r0,|L1.1220|
                  |L1.1216|
;;;990            rt  =   0x22;//COM_8_RES_BUSY;                 /// ?
0004c0  2522              MOVS     r5,#0x22
0004c2  e012              B        |L1.1258|
                  |L1.1220|
;;;991        } else if ((MotoSt[BSP_ID_ODD]  == MOTO_ST_PRO) || (MotoSt[BSP_ID_ODD]  == MOTO_ST_OVTIME)) {
0004c4  f89d0000          LDRB     r0,[sp,#0]
0004c8  2801              CMP      r0,#1
0004ca  d003              BEQ      |L1.1236|
0004cc  f89d0000          LDRB     r0,[sp,#0]
0004d0  2802              CMP      r0,#2
0004d2  d101              BNE      |L1.1240|
                  |L1.1236|
;;;992            rt  =  2;// COM_8_RES_ODD_OVERTIM;          /// ???
0004d4  2502              MOVS     r5,#2
0004d6  e008              B        |L1.1258|
                  |L1.1240|
;;;993        } else if ((MotoSt[BSP_ID_EVEN] == MOTO_ST_PRO) || (MotoSt[BSP_ID_EVEN] == MOTO_ST_OVTIME)) {
0004d8  f89d0001          LDRB     r0,[sp,#1]
0004dc  2801              CMP      r0,#1
0004de  d003              BEQ      |L1.1256|
0004e0  f89d0001          LDRB     r0,[sp,#1]
0004e4  2802              CMP      r0,#2
0004e6  d100              BNE      |L1.1258|
                  |L1.1256|
;;;994            rt  =  0x20;// COM_8_RES_EVE_OVERTIM;          /// ???
0004e8  2520              MOVS     r5,#0x20
                  |L1.1258|
;;;995        } /*else if  (MotoSt[BSP_ID_ODD]  == MOTO_ST_CUTLOOPER) {
;;;996            rt  =   COM_8_RES_ODD_KEYERR;           /// ???
;;;997        } else if  (MotoSt[BSP_ID_EVEN] == MOTO_ST_CUTLOOPER) {
;;;998            rt  =   COM_8_RES_EVE_KEYERR;           /// ???
;;;999        } else if ((broken[BSP_ID_ODD] == TRUE) && (broken[BSP_ID_EVEN] == TRUE) && (COM_9511MAIsRunning != FALSE)) {
;;;1000           rt  =   COM_8_RES_ALL_BREAK;            /// ???
;;;1001       } else if ((broken[BSP_ID_ODD] == TRUE) && (COM_9511MAIsRunning != FALSE)) {
;;;1002           rt  =   COM_8_RES_ODD_BREAK;            /// ???
;;;1003       } else if ((broken[BSP_ID_EVEN] == TRUE) && (COM_9511MAIsRunning != FALSE)) {
;;;1004           rt  =   COM_8_RES_EVE_BREAK;            /// ???
;;;1005       } else if  (COM_9511CheckErr == TRUE) {
;;;1006           rt  =   COM_8_RES_DAT_ERR;              /// ??????
;;;1007       } else {
;;;1008           rt  =   BSP_DIP_9511Addr;               /// ??
;;;1009       }
;;;1010        */
;;;1011       return  rt;
0004ea  4628              MOV      r0,r5
;;;1012   }
0004ec  bd38              POP      {r3-r5,pc}
;;;1013   u16 COM_Tangkong_Pos_Last=0;
                          ENDP

                  COM_Tangkong_Position PROC
;;;1014   static  void  COM_Tangkong_Position(u16 buf[], u8 len)
0004ee  b5f8              PUSH     {r3-r7,lr}
;;;1015   {
0004f0  4606              MOV      r6,r0
0004f2  460f              MOV      r7,r1
;;;1016        u16     rt=0; 
0004f4  2500              MOVS     r5,#0
;;;1017   //最低1，0位是4，x位2，\舆^程中笊弦B
;;;1018   //起碜约赫以c，初始化接近_P不在原c3	 
;;;1019   
;;;1020     MOTO_ST_TypeDef     MotoSt[BSP_DEVICE_ID_N];
;;;1021     u32                 i;
;;;1022      for (i = 0; i < BSP_DEVICE_ID_N; i++) {
0004f6  2400              MOVS     r4,#0
0004f8  e06f              B        |L1.1498|
                  |L1.1274|
;;;1023      if((IN_HDKey_GetSt((BSP_ID_TypeDef)i)==HDKEY_ST_DN)||(COM_9511TangkongPatch[i]==2))
0004fa  b2e0              UXTB     r0,r4
0004fc  f7fffffe          BL       IN_HDKey_GetSt
000500  2802              CMP      r0,#2
000502  d003              BEQ      |L1.1292|
000504  48fa              LDR      r0,|L1.2288|
000506  5d00              LDRB     r0,[r0,r4]
000508  2802              CMP      r0,#2
00050a  d107              BNE      |L1.1308|
                  |L1.1292|
;;;1024      {
;;;1025      		if(i==0)
00050c  b90c              CBNZ     r4,|L1.1298|
;;;1026   			rt=5;
00050e  2505              MOVS     r5,#5
000510  e062              B        |L1.1496|
                  |L1.1298|
;;;1027   		else
;;;1028   			{
;;;1029   				rt &=0x0F;
000512  f005050f          AND      r5,r5,#0xf
;;;1030   				rt|=(5<<4);
000516  f0450550          ORR      r5,r5,#0x50
00051a  e05d              B        |L1.1496|
                  |L1.1308|
;;;1031   			}
;;;1032      }
;;;1033      else
;;;1034      {
;;;1035      if(TK_Org[i]==0)//没找过
00051c  48f5              LDR      r0,|L1.2292|
00051e  5d00              LDRB     r0,[r0,r4]
000520  b938              CBNZ     r0,|L1.1330|
;;;1036      {
;;;1037      		if(i==0)
000522  b90c              CBNZ     r4,|L1.1320|
;;;1038   			rt=3;
000524  2503              MOVS     r5,#3
000526  e057              B        |L1.1496|
                  |L1.1320|
;;;1039   		else
;;;1040   		{
;;;1041   			rt &=0x0F;
000528  f005050f          AND      r5,r5,#0xf
;;;1042   			rt|=(3<<4);
00052c  f0450530          ORR      r5,r5,#0x30
000530  e052              B        |L1.1496|
                  |L1.1330|
;;;1043   		}
;;;1044      }
;;;1045      else//找过了
;;;1046      {
;;;1047           if ((COM_IsFault[i] == FALSE) && (COM_DnIsEnable[i] == TRUE)) 
000532  48f1              LDR      r0,|L1.2296|
000534  5d00              LDRB     r0,[r0,r4]
000536  b948              CBNZ     r0,|L1.1356|
000538  48f0              LDR      r0,|L1.2300|
00053a  5d00              LDRB     r0,[r0,r4]
00053c  2801              CMP      r0,#1
00053e  d105              BNE      |L1.1356|
;;;1048   		{
;;;1049               MotoSt[i]   =   MOTO_CutGetState((BSP_ID_TypeDef)i);
000540  b2e0              UXTB     r0,r4
000542  f7fffffe          BL       MOTO_CutGetState
000546  f80d0004          STRB     r0,[sp,r4]
00054a  e002              B        |L1.1362|
                  |L1.1356|
;;;1050           } 
;;;1051   		else 
;;;1052   		{
;;;1053               MotoSt[i]   =   MOTO_ST_OK;
00054c  2005              MOVS     r0,#5
00054e  f80d0004          STRB     r0,[sp,r4]
                  |L1.1362|
;;;1054           }
;;;1055       //成功了
;;;1056   		if(MotoSt[i]  ==   MOTO_ST_OK)
000552  f81d0004          LDRB     r0,[sp,r4]
000556  2805              CMP      r0,#5
000558  d130              BNE      |L1.1468|
;;;1057   		{
;;;1058   			if(i==0)
00055a  b984              CBNZ     r4,|L1.1406|
;;;1059   			{
;;;1060   			 	if(BSP_SWI_FiGet(BSP_ID_ODD)  != BSP_SWITCH_LOW)//不亮
00055c  2000              MOVS     r0,#0
00055e  f7fffffe          BL       BSP_SWI_FiGet
000562  2801              CMP      r0,#1
000564  d001              BEQ      |L1.1386|
;;;1061   				{
;;;1062   					rt=0x01;//
000566  2501              MOVS     r5,#1
000568  e009              B        |L1.1406|
                  |L1.1386|
;;;1063   				}
;;;1064   				else
;;;1065   				{
;;;1066   					if(HeadUpDown_Status[0]==1)
00056a  48e5              LDR      r0,|L1.2304|
00056c  7800              LDRB     r0,[r0,#0]  ; HeadUpDown_Status
00056e  2801              CMP      r0,#1
000570  d100              BNE      |L1.1396|
;;;1067   						rt=0x4;	//工作位
000572  2504              MOVS     r5,#4
                  |L1.1396|
;;;1068   					if(HeadUpDown_Status[0]==2)
000574  48e2              LDR      r0,|L1.2304|
000576  7800              LDRB     r0,[r0,#0]  ; HeadUpDown_Status
000578  2802              CMP      r0,#2
00057a  d100              BNE      |L1.1406|
;;;1069   						rt=0x02;//在脱离位
00057c  2502              MOVS     r5,#2
                  |L1.1406|
;;;1070   		
;;;1071   				}
;;;1072   			}
;;;1073   			if(i==1)
00057e  2c01              CMP      r4,#1
000580  d119              BNE      |L1.1462|
;;;1074   			{
;;;1075   				if(BSP_SWI_FiGet(BSP_ID_EVEN) != BSP_SWITCH_LOW)
000582  2001              MOVS     r0,#1
000584  f7fffffe          BL       BSP_SWI_FiGet
000588  2801              CMP      r0,#1
00058a  d004              BEQ      |L1.1430|
;;;1076   				{
;;;1077   						rt &=0x0F;
00058c  f005050f          AND      r5,r5,#0xf
;;;1078   				    	rt=rt|(1<<4); //停下位 
000590  f0450510          ORR      r5,r5,#0x10
000594  e00f              B        |L1.1462|
                  |L1.1430|
;;;1079   				}
;;;1080   				
;;;1081   				else
;;;1082   				{
;;;1083   					if(HeadUpDown_Status[1]==1)
000596  48da              LDR      r0,|L1.2304|
000598  7840              LDRB     r0,[r0,#1]  ; HeadUpDown_Status
00059a  2801              CMP      r0,#1
00059c  d103              BNE      |L1.1446|
;;;1084   					{
;;;1085   						rt &=0x0F;
00059e  f005050f          AND      r5,r5,#0xf
;;;1086   						rt=rt|(1<<6);	//工作位
0005a2  f0450540          ORR      r5,r5,#0x40
                  |L1.1446|
;;;1087   					}
;;;1088   					if(HeadUpDown_Status[1]==2)
0005a6  48d6              LDR      r0,|L1.2304|
0005a8  7840              LDRB     r0,[r0,#1]  ; HeadUpDown_Status
0005aa  2802              CMP      r0,#2
0005ac  d103              BNE      |L1.1462|
;;;1089   					{
;;;1090   						rt &=0x0F;
0005ae  f005050f          AND      r5,r5,#0xf
;;;1091   						rt=rt|(1<<5);//在脱离位
0005b2  f0450520          ORR      r5,r5,#0x20
                  |L1.1462|
;;;1092   					}
;;;1093   				}
;;;1094   			}
;;;1095   		 COM_Tangkong_Pos_Last=rt;
0005b6  48d3              LDR      r0,|L1.2308|
0005b8  8005              STRH     r5,[r0,#0]
0005ba  e00d              B        |L1.1496|
                  |L1.1468|
;;;1096   		}
;;;1097   		else//没有成功
;;;1098   		{
;;;1099   			 if(TK_Org[i]==1) //已经找过了
0005bc  48cd              LDR      r0,|L1.2292|
0005be  5d00              LDRB     r0,[r0,r4]
0005c0  2801              CMP      r0,#1
0005c2  d107              BNE      |L1.1492|
;;;1100   			   {
;;;1101   			   		if(i==0)
0005c4  b90c              CBNZ     r4,|L1.1482|
;;;1102   						rt=3;
0005c6  2503              MOVS     r5,#3
0005c8  e006              B        |L1.1496|
                  |L1.1482|
;;;1103   					else
;;;1104   					{
;;;1105   						rt &=0x0F;
0005ca  f005050f          AND      r5,r5,#0xf
;;;1106   						rt|=(3<<4);
0005ce  f0450530          ORR      r5,r5,#0x30
0005d2  e001              B        |L1.1496|
                  |L1.1492|
;;;1107   					}
;;;1108   			   }
;;;1109   			else
;;;1110   				rt=COM_Tangkong_Pos_Last;
0005d4  48cb              LDR      r0,|L1.2308|
0005d6  8805              LDRH     r5,[r0,#0]  ; COM_Tangkong_Pos_Last
                  |L1.1496|
0005d8  1c64              ADDS     r4,r4,#1              ;1022
                  |L1.1498|
0005da  2c02              CMP      r4,#2                 ;1022
0005dc  d38d              BCC      |L1.1274|
;;;1111   		//	TK_Org[i]=1;
;;;1112   		}
;;;1113   	}//结束找过了
;;;1114   	}
;;;1115     }//结束for
;;;1116       C491_SendOne(rt, 0);
0005de  2100              MOVS     r1,#0
0005e0  4628              MOV      r0,r5
0005e2  f7fffffe          BL       C491_SendOne
;;;1117   }
0005e6  bdf8              POP      {r3-r7,pc}
;;;1118   static  void  COM_Tangkong_Sta(u16 buf[], u8 len)
                          ENDP

                  COM_Tangkong_Sta PROC
0005e8  b570              PUSH     {r4-r6,lr}
;;;1119   {
0005ea  4605              MOV      r5,r0
0005ec  460e              MOV      r6,r1
;;;1120   	u16 rt;
;;;1121    	rt  =   BSP_DIP_9511Addr;               /// 正确
0005ee  48c6              LDR      r0,|L1.2312|
0005f0  7804              LDRB     r4,[r0,#0]  ; BSP_DIP_9511Addr
;;;1122       C491_SendOne(rt, 0);  
0005f2  2100              MOVS     r1,#0
0005f4  4620              MOV      r0,r4
0005f6  f7fffffe          BL       C491_SendOne
;;;1123   
;;;1124   }
0005fa  bd70              POP      {r4-r6,pc}
;;;1125   static  void    COM_Tangkong_SinglDir(u16 buf[], u8 len)
                          ENDP

                  COM_Tangkong_SinglDir PROC
0005fc  2200              MOVS     r2,#0
;;;1126   {
;;;1127   	COM_9511TangkongDir=FALSE;
0005fe  4bc3              LDR      r3,|L1.2316|
000600  701a              STRB     r2,[r3,#0]
;;;1128   }
000602  4770              BX       lr
;;;1129   static  void    COM_Tangkong_DoublDir(u16 buf[], u8 len)
                          ENDP

                  COM_Tangkong_DoublDir PROC
000604  2201              MOVS     r2,#1
;;;1130   {
;;;1131   	COM_9511TangkongDir=TRUE;
000606  4bc1              LDR      r3,|L1.2316|
000608  701a              STRB     r2,[r3,#0]
;;;1132   //	COM_HighCmd(0);
;;;1133   }
00060a  4770              BX       lr
;;;1134   /// -----------------------------------------------------------------------------------------------------
                          ENDP

                  COM_9511FaultOff PROC
;;;1141   ////////
;;;1142   static  void  COM_9511FaultOff (u16 buf[], u8 len) //主控0xd0命令，COM_IsFault==TRUE表示主控关闭了这个机头
00060c  e92d41f0          PUSH     {r4-r8,lr}
;;;1143   {
000610  4606              MOV      r6,r0
000612  460f              MOV      r7,r1
;;;1144       u16     decode;
;;;1145       u32     i;
;;;1146       
;;;1147       
;;;1148       decode  =   COM_9511Decode(buf, len);
000614  4639              MOV      r1,r7
000616  4630              MOV      r0,r6
000618  f7fffffe          BL       COM_9511Decode
00061c  4605              MOV      r5,r0
;;;1149       
;;;1150   //    if (decode & (1 << 1)) {
;;;1151       if (COM_BIT_ODD(decode)) {
00061e  f0150f02          TST      r5,#2
000622  d003              BEQ      |L1.1580|
;;;1152           COM_IsFault[BSP_ID_ODD]     =   FALSE;
000624  2000              MOVS     r0,#0
000626  49b4              LDR      r1,|L1.2296|
000628  7008              STRB     r0,[r1,#0]
00062a  e002              B        |L1.1586|
                  |L1.1580|
;;;1153       } else {
;;;1154           COM_IsFault[BSP_ID_ODD]     =   TRUE;
00062c  2001              MOVS     r0,#1
00062e  49b2              LDR      r1,|L1.2296|
000630  7008              STRB     r0,[r1,#0]
                  |L1.1586|
;;;1155       }
;;;1156       
;;;1157   //    if (decode & (1 << 0)) {
;;;1158       if (COM_BIT_EVE(decode)) {
000632  f0150f01          TST      r5,#1
000636  d003              BEQ      |L1.1600|
;;;1159           COM_IsFault[BSP_ID_EVEN]    =   FALSE;
000638  2000              MOVS     r0,#0
00063a  49af              LDR      r1,|L1.2296|
00063c  7048              STRB     r0,[r1,#1]
00063e  e002              B        |L1.1606|
                  |L1.1600|
;;;1160       } else {
;;;1161           COM_IsFault[BSP_ID_EVEN]    =   TRUE;
000640  2001              MOVS     r0,#1
000642  49ad              LDR      r1,|L1.2296|
000644  7048              STRB     r0,[r1,#1]
                  |L1.1606|
;;;1162       }
;;;1163       
;;;1164   //    COM_AllUpdate();
;;;1165       for (i = 0; i < BSP_DEVICE_ID_N; i++) {
000646  2400              MOVS     r4,#0
000648  e011              B        |L1.1646|
                  |L1.1610|
;;;1166           COM_LedUpdate((BSP_ID_TypeDef)i);
00064a  b2e0              UXTB     r0,r4
00064c  f7fffffe          BL       COM_LedUpdate
;;;1167           
;;;1168   //        BSP_SQN_EmbStSend((BSP_ID_TypeDef)i, COM_GetEmbSt((BSP_ID_TypeDef)i));
;;;1169           COM_SqnUpdate((BSP_ID_TypeDef)i);
000650  b2e0              UXTB     r0,r4
000652  f7fffffe          BL       COM_SqnUpdate
;;;1170           
;;;1171           /// 可加等待0.3S        /// !!! cy  100908
;;;1172           
;;;1173   //        COM_HghUpdate((BSP_ID_TypeDef)i);
;;;1174           if (COM_IsHghRest == FALSE) {           /// 为安全上电后针高不动, 直到有主控命令或开关变化
000656  48ae              LDR      r0,|L1.2320|
000658  7800              LDRB     r0,[r0,#0]  ; COM_IsHghRest
00065a  b938              CBNZ     r0,|L1.1644|
;;;1175               
;;;1176   /// cy  110304
;;;1177   //            COM_HghUpdate((BSP_ID_TypeDef)i);
;;;1178               if (COM_HghIsAim[i] == FALSE) {
00065c  48ad              LDR      r0,|L1.2324|
00065e  5d00              LDRB     r0,[r0,r4]
000660  b920              CBNZ     r0,|L1.1644|
;;;1179                   COM_HghIsAim[i] =   COM_HghUpdate((BSP_ID_TypeDef)i);
000662  b2e0              UXTB     r0,r4
000664  f7fffffe          BL       COM_HghUpdate
000668  49aa              LDR      r1,|L1.2324|
00066a  5508              STRB     r0,[r1,r4]
                  |L1.1644|
00066c  1c64              ADDS     r4,r4,#1              ;1165
                  |L1.1646|
00066e  2c02              CMP      r4,#2                 ;1165
000670  d3eb              BCC      |L1.1610|
;;;1180               }
;;;1181   /// cy  110304
;;;1182   //		COM_TKFault[i]=FALSE;
;;;1183           }
;;;1184       }
;;;1185   }
000672  e8bd81f0          POP      {r4-r8,pc}
;;;1186   static  void  COM_9511DataCheck (u16 buf[], u8 len)
                          ENDP

                  COM_9511DataCheck PROC
000676  4aa8              LDR      r2,|L1.2328|
;;;1187   {
;;;1188       /// 之前的命令不含有数据, 则认为此校验命令无效
;;;1189       if (   (COM_9511CheckNum == 0)                                          
000678  8812              LDRH     r2,[r2,#0]  ; COM_9511CheckNum
00067a  b16a              CBZ      r2,|L1.1688|
;;;1190           || (   ((buf[0] & COM_MSK_9511_DATA) == COM_9511CheckNum)           /// 或者校验和与个数都正确
00067c  8802              LDRH     r2,[r0,#0]
00067e  f002027f          AND      r2,r2,#0x7f
000682  4ba5              LDR      r3,|L1.2328|
000684  881b              LDRH     r3,[r3,#0]  ; COM_9511CheckNum
000686  429a              CMP      r2,r3
000688  d10a              BNE      |L1.1696|
;;;1191               && ((buf[1] & COM_MSK_9511_DATA) == COM_9511CheckSum)   )   ) {              
00068a  8842              LDRH     r2,[r0,#2]
00068c  f002027f          AND      r2,r2,#0x7f
000690  4ba2              LDR      r3,|L1.2332|
000692  881b              LDRH     r3,[r3,#0]  ; COM_9511CheckSum
000694  429a              CMP      r2,r3
000696  d103              BNE      |L1.1696|
                  |L1.1688|
;;;1192           COM_9511CheckErr    =   FALSE;
000698  2200              MOVS     r2,#0
00069a  4ba1              LDR      r3,|L1.2336|
00069c  701a              STRB     r2,[r3,#0]
00069e  e002              B        |L1.1702|
                  |L1.1696|
;;;1193       } else {
;;;1194           COM_9511CheckErr    =   TRUE;
0006a0  2201              MOVS     r2,#1
0006a2  4b9f              LDR      r3,|L1.2336|
0006a4  701a              STRB     r2,[r3,#0]
                  |L1.1702|
;;;1195       }
;;;1196   }
0006a6  4770              BX       lr
;;;1197   
                          ENDP

                  COM_9511UpStChange PROC
;;;1911   
;;;1912   static  void  COM_9511UpStChange   (BSP_ID_TypeDef      id,
0006a8  b570              PUSH     {r4-r6,lr}
;;;1913                                       COM_UP_ST_TypeDef   NewSt)
;;;1914   {
0006aa  4604              MOV      r4,r0
0006ac  460d              MOV      r5,r1
;;;1915   	if(COM_UpStLast[id] != COM_UpStNow[id])
0006ae  489d              LDR      r0,|L1.2340|
0006b0  5d00              LDRB     r0,[r0,r4]
0006b2  499d              LDR      r1,|L1.2344|
0006b4  5d09              LDRB     r1,[r1,r4]
0006b6  4288              CMP      r0,r1
0006b8  d002              BEQ      |L1.1728|
;;;1916   		COM_TKIsEnable[id]=TRUE;	
0006ba  2001              MOVS     r0,#1
0006bc  499b              LDR      r1,|L1.2348|
0006be  5508              STRB     r0,[r1,r4]
                  |L1.1728|
;;;1917       COM_UpStLast[id]     =   COM_UpStNow[id];
0006c0  4899              LDR      r0,|L1.2344|
0006c2  5d00              LDRB     r0,[r0,r4]
0006c4  4997              LDR      r1,|L1.2340|
0006c6  5508              STRB     r0,[r1,r4]
;;;1918   	COM_UpStNow[id]     =   NewSt;
0006c8  4897              LDR      r0,|L1.2344|
0006ca  5505              STRB     r5,[r0,r4]
;;;1919       
;;;1920       COM_LedUpdate(id);
0006cc  4620              MOV      r0,r4
0006ce  f7fffffe          BL       COM_LedUpdate
;;;1921   //    BSP_SQN_EmbStSend(id, COM_GetEmbSt(id));
;;;1922       COM_SqnUpdate(id);
0006d2  4620              MOV      r0,r4
0006d4  f7fffffe          BL       COM_SqnUpdate
;;;1923       
;;;1924       /// 可加等待0.3S        /// !!! cy  100908
;;;1925       
;;;1926   //    COM_HghUpdate(id);    /// cy  110304
;;;1927   }
0006d8  bd70              POP      {r4-r6,pc}
;;;1928   
                          ENDP

                  COM_9511UpStByBroken PROC
;;;2005   /// 因断线而改变状态
;;;2006   static  void  COM_9511UpStByBroken (BSP_ID_TypeDef id)
0006da  b510              PUSH     {r4,lr}
;;;2007   {
0006dc  4604              MOV      r4,r0
;;;2008       switch (COM_UpStNow[id]) {
0006de  4892              LDR      r0,|L1.2344|
0006e0  5d00              LDRB     r0,[r0,r4]
0006e2  2801              CMP      r0,#1
0006e4  d002              BEQ      |L1.1772|
0006e6  2805              CMP      r0,#5
0006e8  d10a              BNE      |L1.1792|
0006ea  e004              B        |L1.1782|
                  |L1.1772|
;;;2009       case COM_UP_ST_NORMAL:
;;;2010           COM_9511UpStChange(id, COM_UP_ST_BROKEN);
0006ec  2102              MOVS     r1,#2
0006ee  4620              MOV      r0,r4
0006f0  f7fffffe          BL       COM_9511UpStChange
;;;2011           break;
0006f4  e005              B        |L1.1794|
                  |L1.1782|
;;;2012       case COM_UP_ST_PATCH_NORMAL:
;;;2013           COM_9511UpStChange(id, COM_UP_ST_PATCH_BROKEN);
0006f6  2106              MOVS     r1,#6
0006f8  4620              MOV      r0,r4
0006fa  f7fffffe          BL       COM_9511UpStChange
;;;2014           break;
0006fe  e000              B        |L1.1794|
                  |L1.1792|
;;;2015       default:                                /// 其他状态不变
;;;2016           break;
000700  bf00              NOP      
                  |L1.1794|
000702  bf00              NOP                            ;2011
;;;2017       }
;;;2018   }
000704  bd10              POP      {r4,pc}
;;;2019   u8 Test_Status[2]={1,1};
                          ENDP

                  COM_9511DnToUpBrk PROC
;;;1197   
;;;1198   static  void  COM_9511DnToUpBrk (u16 buf[], u8 len)
000706  b570              PUSH     {r4-r6,lr}
;;;1199   {
000708  4605              MOV      r5,r0
00070a  460e              MOV      r6,r1
;;;1200       u16     decode;
;;;1201       
;;;1202       
;;;1203       decode  =   COM_9511Decode(buf, len);
00070c  4631              MOV      r1,r6
00070e  4628              MOV      r0,r5
000710  f7fffffe          BL       COM_9511Decode
000714  4604              MOV      r4,r0
;;;1204       
;;;1205       if (COM_BIT_ODD(decode)) {                  /// 奇数断线
000716  f0140f02          TST      r4,#2
00071a  d002              BEQ      |L1.1826|
;;;1206           COM_9511UpStByBroken(BSP_ID_ODD);
00071c  2000              MOVS     r0,#0
00071e  f7fffffe          BL       COM_9511UpStByBroken
                  |L1.1826|
;;;1207       } else {                                    /// 不断线不处理
;;;1208           ;
;;;1209       }
;;;1210       
;;;1211       if (COM_BIT_EVE(decode)) {                  /// 奇数断线
000722  f0140f01          TST      r4,#1
000726  d002              BEQ      |L1.1838|
;;;1212           COM_9511UpStByBroken(BSP_ID_EVEN);
000728  2001              MOVS     r0,#1
00072a  f7fffffe          BL       COM_9511UpStByBroken
                  |L1.1838|
;;;1213       } else {                                    /// 不断线不处理
;;;1214           ;
;;;1215       }
;;;1216   }
00072e  bd70              POP      {r4-r6,pc}
;;;1217   
                          ENDP

                  COM_9511BrkDetMod PROC
;;;1221   extern u8 IN_TEN_MULTIPLE;
;;;1222   static  void  COM_9511BrkDetMod (u16 buf[], u8 len)//0xd3命令的执行函数，
000730  e92d41f0          PUSH     {r4-r8,lr}
;;;1223   {//在主控的init3中有发这个命令
000734  4604              MOV      r4,r0
000736  460e              MOV      r6,r1
;;;1224       bool    IsDn;
;;;1225   //    u32     i;        /// !!! cy 100908
;;;1226        u8 q=2;
000738  2702              MOVS     r7,#2
;;;1227       
;;;1228       if ((buf[0] & COM_MSK_9511_DATA) == 0) {
00073a  8820              LDRH     r0,[r4,#0]
00073c  f0100f7f          TST      r0,#0x7f
000740  d101              BNE      |L1.1862|
;;;1229           IsDn    =   FALSE; //上机头断检是0
000742  2500              MOVS     r5,#0
000744  e000              B        |L1.1864|
                  |L1.1862|
;;;1230       } else {
;;;1231           IsDn    =   TRUE;//下机头断检是1
000746  2501              MOVS     r5,#1
                  |L1.1864|
;;;1232       }
;;;1233       
;;;1234   /// !!! cy 100908
;;;1235   //    for (i = 0; i < BSP_DEVICE_ID_N; i++) {
;;;1236   //        IN_BRK_SetIsDn((BSP_ID_TypeDef)i, IsDn);
;;;1237   //    }
;;;1238       IN_BRK_SetIsDn(IsDn);
000748  4628              MOV      r0,r5
00074a  f7fffffe          BL       IN_BRK_SetIsDn
;;;1239   /// !!! cy 100908
;;;1240   
;;;1241   	if(q<len)
00074e  42b7              CMP      r7,r6
000750  da05              BGE      |L1.1886|
;;;1242   		IN_TEN_MULTIPLE=buf[q]&0x7F;
000752  f8340017          LDRH     r0,[r4,r7,LSL #1]
000756  f000007f          AND      r0,r0,#0x7f
00075a  4975              LDR      r1,|L1.2352|
00075c  7008              STRB     r0,[r1,#0]
                  |L1.1886|
;;;1243   	if((IN_TEN_MULTIPLE<1)||(IN_TEN_MULTIPLE>99))
00075e  4874              LDR      r0,|L1.2352|
000760  7800              LDRB     r0,[r0,#0]  ; IN_TEN_MULTIPLE
000762  2801              CMP      r0,#1
000764  db03              BLT      |L1.1902|
000766  4872              LDR      r0,|L1.2352|
000768  7800              LDRB     r0,[r0,#0]  ; IN_TEN_MULTIPLE
00076a  2863              CMP      r0,#0x63
00076c  dd02              BLE      |L1.1908|
                  |L1.1902|
;;;1244   		IN_TEN_MULTIPLE=20;
00076e  2014              MOVS     r0,#0x14
000770  496f              LDR      r1,|L1.2352|
000772  7008              STRB     r0,[r1,#0]
                  |L1.1908|
;;;1245   }
000774  e8bd81f0          POP      {r4-r8,pc}
;;;1246   
                          ENDP

                  COM_9511GetIsSqnUp PROC
;;;1247   static  void  COM_9511GetIsSqnUp (u16 buf[], u8 len)
000778  b570              PUSH     {r4-r6,lr}
;;;1248   {
00077a  4605              MOV      r5,r0
00077c  460e              MOV      r6,r1
;;;1249       u16     res;
;;;1250       
;;;1251       
;;;1252       if (BSP_SWI_SeGet(BSP_ID_ODD) == BSP_SWITCH_LOW) {
00077e  2000              MOVS     r0,#0
000780  f7fffffe          BL       BSP_SWI_SeGet
000784  2801              CMP      r0,#1
000786  d101              BNE      |L1.1932|
;;;1253           res =   COM_8_RES_SQN_POS;
000788  2414              MOVS     r4,#0x14
00078a  e000              B        |L1.1934|
                  |L1.1932|
;;;1254       } else {
;;;1255           res =   COM_8_RES_SQN_NOTPOS;
00078c  2415              MOVS     r4,#0x15
                  |L1.1934|
;;;1256       }
;;;1257       C491_SendOne(res, 0);
00078e  2100              MOVS     r1,#0
000790  4620              MOV      r0,r4
000792  f7fffffe          BL       C491_SendOne
;;;1258   }
000796  bd70              POP      {r4-r6,pc}
;;;1259   
                          ENDP

                  COM_9511DnEnable PROC
;;;1267   ////////
;;;1268   static  void  COM_9511DnEnable (u16 buf[], u8 len)
000798  b570              PUSH     {r4-r6,lr}
;;;1269   {
00079a  4605              MOV      r5,r0
00079c  460e              MOV      r6,r1
;;;1270       u16     decode;
;;;1271       
;;;1272       
;;;1273       decode              =   COM_9511Decode(buf, len);
00079e  4631              MOV      r1,r6
0007a0  4628              MOV      r0,r5
0007a2  f7fffffe          BL       COM_9511Decode
0007a6  4604              MOV      r4,r0
;;;1274       
;;;1275       if (COM_BIT_ODD(decode)) {
0007a8  f0140f02          TST      r4,#2
0007ac  d003              BEQ      |L1.1974|
;;;1276           COM_DnIsEnable[BSP_ID_ODD]  =   TRUE;
0007ae  2001              MOVS     r0,#1
0007b0  4952              LDR      r1,|L1.2300|
0007b2  7008              STRB     r0,[r1,#0]
0007b4  e002              B        |L1.1980|
                  |L1.1974|
;;;1277       } else {
;;;1278           COM_DnIsEnable[BSP_ID_ODD]  =   FALSE;
0007b6  2000              MOVS     r0,#0
0007b8  4950              LDR      r1,|L1.2300|
0007ba  7008              STRB     r0,[r1,#0]
                  |L1.1980|
;;;1279       }
;;;1280       
;;;1281       if (COM_BIT_EVE(decode)) {
0007bc  f0140f01          TST      r4,#1
0007c0  d003              BEQ      |L1.1994|
;;;1282           COM_DnIsEnable[BSP_ID_EVEN] =   TRUE;
0007c2  2001              MOVS     r0,#1
0007c4  494d              LDR      r1,|L1.2300|
0007c6  7048              STRB     r0,[r1,#1]
0007c8  e002              B        |L1.2000|
                  |L1.1994|
;;;1283       } else {
;;;1284           COM_DnIsEnable[BSP_ID_EVEN] =   FALSE;
0007ca  2000              MOVS     r0,#0
0007cc  494b              LDR      r1,|L1.2300|
0007ce  7048              STRB     r0,[r1,#1]
                  |L1.2000|
;;;1285       }
;;;1286   }
0007d0  bd70              POP      {r4-r6,pc}
;;;1287   
                          ENDP

                  COM_9511CutBack PROC
;;;1288   static  void  COM_9511CutBack (u16 buf[], u8 len)//剪刀收回
0007d2  b570              PUSH     {r4-r6,lr}
;;;1289   {
0007d4  4605              MOV      r5,r0
0007d6  460e              MOV      r6,r1
;;;1290       u32     i;
;;;1291       
;;;1292       
;;;1293       for (i = 0; i < BSP_DEVICE_ID_N; i++) {
0007d8  2400              MOVS     r4,#0
0007da  e00c              B        |L1.2038|
                  |L1.2012|
;;;1294           if ((COM_IsFault[i] == FALSE)&&(COM_GetIsDrop(COM_UpStNow[i]) != FALSE)) {
0007dc  4846              LDR      r0,|L1.2296|
0007de  5d00              LDRB     r0,[r0,r4]
0007e0  b940              CBNZ     r0,|L1.2036|
0007e2  4951              LDR      r1,|L1.2344|
0007e4  5d08              LDRB     r0,[r1,r4]
0007e6  f7fffffe          BL       COM_GetIsDrop
0007ea  b118              CBZ      r0,|L1.2036|
;;;1295               MOTO_CutSetCmd((BSP_ID_TypeDef)i, MOTO_CUT_BACK);
0007ec  210c              MOVS     r1,#0xc
0007ee  b2e0              UXTB     r0,r4
0007f0  f7fffffe          BL       MOTO_CutSetCmd
                  |L1.2036|
0007f4  1c64              ADDS     r4,r4,#1              ;1293
                  |L1.2038|
0007f6  2c02              CMP      r4,#2                 ;1293
0007f8  d3f0              BCC      |L1.2012|
;;;1296           }
;;;1297       }
;;;1298   }
0007fa  bd70              POP      {r4-r6,pc}
;;;1299   
                          ENDP

                  COM_9511CutHalf PROC
;;;1300   static  void  COM_9511CutHalf (u16 buf[], u8 len)//剪刀半出
0007fc  b570              PUSH     {r4-r6,lr}
;;;1301   {
0007fe  4605              MOV      r5,r0
000800  460e              MOV      r6,r1
;;;1302       u32     i;
;;;1303       
;;;1304       
;;;1305       for (i = 0; i < BSP_DEVICE_ID_N; i++) {
000802  2400              MOVS     r4,#0
000804  e010              B        |L1.2088|
                  |L1.2054|
;;;1306           if ((COM_IsFault[i] == FALSE) && (COM_DnIsEnable[i] == TRUE)&&(COM_GetIsDrop(COM_UpStNow[i]) != FALSE)) {
000806  483c              LDR      r0,|L1.2296|
000808  5d00              LDRB     r0,[r0,r4]
00080a  b960              CBNZ     r0,|L1.2086|
00080c  483b              LDR      r0,|L1.2300|
00080e  5d00              LDRB     r0,[r0,r4]
000810  2801              CMP      r0,#1
000812  d108              BNE      |L1.2086|
000814  4944              LDR      r1,|L1.2344|
000816  5d08              LDRB     r0,[r1,r4]
000818  f7fffffe          BL       COM_GetIsDrop
00081c  b118              CBZ      r0,|L1.2086|
;;;1307               MOTO_CutSetCmd((BSP_ID_TypeDef)i, MOTO_CUT_HALF);
00081e  210d              MOVS     r1,#0xd
000820  b2e0              UXTB     r0,r4
000822  f7fffffe          BL       MOTO_CutSetCmd
                  |L1.2086|
000826  1c64              ADDS     r4,r4,#1              ;1305
                  |L1.2088|
000828  2c02              CMP      r4,#2                 ;1305
00082a  d3ec              BCC      |L1.2054|
;;;1308           }
;;;1309       }
;;;1310   }
00082c  bd70              POP      {r4-r6,pc}
;;;1311   
                          ENDP

                  COM_9511CutFull PROC
;;;1312   static  void  COM_9511CutFull (u16 buf[], u8 len)//剪线满入
00082e  b570              PUSH     {r4-r6,lr}
;;;1313   {
000830  4605              MOV      r5,r0
000832  460e              MOV      r6,r1
;;;1314       u32     i;
;;;1315       
;;;1316       
;;;1317       for (i = 0; i < BSP_DEVICE_ID_N; i++) {
000834  2400              MOVS     r4,#0
000836  e010              B        |L1.2138|
                  |L1.2104|
;;;1318           if ((COM_IsFault[i] == FALSE) && (COM_DnIsEnable[i] == TRUE)&&(COM_GetIsDrop(COM_UpStNow[i]) != FALSE)) {
000838  482f              LDR      r0,|L1.2296|
00083a  5d00              LDRB     r0,[r0,r4]
00083c  b960              CBNZ     r0,|L1.2136|
00083e  482f              LDR      r0,|L1.2300|
000840  5d00              LDRB     r0,[r0,r4]
000842  2801              CMP      r0,#1
000844  d108              BNE      |L1.2136|
000846  4938              LDR      r1,|L1.2344|
000848  5d08              LDRB     r0,[r1,r4]
00084a  f7fffffe          BL       COM_GetIsDrop
00084e  b118              CBZ      r0,|L1.2136|
;;;1319               MOTO_CutSetCmd((BSP_ID_TypeDef)i, MOTO_CUT_FULL);
000850  210e              MOVS     r1,#0xe
000852  b2e0              UXTB     r0,r4
000854  f7fffffe          BL       MOTO_CutSetCmd
                  |L1.2136|
000858  1c64              ADDS     r4,r4,#1              ;1317
                  |L1.2138|
00085a  2c02              CMP      r4,#2                 ;1317
00085c  d3ec              BCC      |L1.2104|
;;;1320           }
;;;1321       }
;;;1322   }
00085e  bd70              POP      {r4-r6,pc}
;;;1323   static  void  COM_ID_9511CutBack (BSP_ID_TypeDef id,u16 buf[], u8 len)//剪刀收回
                          ENDP

                  COM_ID_9511CutBack PROC
000860  b570              PUSH     {r4-r6,lr}
;;;1324   {
000862  4604              MOV      r4,r0
000864  460d              MOV      r5,r1
000866  4616              MOV      r6,r2
;;;1325       //u32     i;
;;;1326       
;;;1327       
;;;1328      // for (i = 0; i < BSP_DEVICE_ID_N; i++) {
;;;1329           if ((COM_IsFault[id] == FALSE)&&(COM_GetIsDrop(COM_UpStNow[id]) != FALSE)) {
000868  4823              LDR      r0,|L1.2296|
00086a  5d00              LDRB     r0,[r0,r4]
00086c  b940              CBNZ     r0,|L1.2176|
00086e  492e              LDR      r1,|L1.2344|
000870  5d08              LDRB     r0,[r1,r4]
000872  f7fffffe          BL       COM_GetIsDrop
000876  b118              CBZ      r0,|L1.2176|
;;;1330               MOTO_CutSetCmd(id, MOTO_CUT_BACK);
000878  210c              MOVS     r1,#0xc
00087a  4620              MOV      r0,r4
00087c  f7fffffe          BL       MOTO_CutSetCmd
                  |L1.2176|
;;;1331          // }
;;;1332       }
;;;1333   }
000880  bd70              POP      {r4-r6,pc}
;;;1334   static  void  COM_ID_9511CutH (BSP_ID_TypeDef id,u16 buf[], u8 len)//剪刀收回
                          ENDP

                  COM_ID_9511CutH PROC
000882  b570              PUSH     {r4-r6,lr}
;;;1335   {
000884  4604              MOV      r4,r0
000886  460d              MOV      r5,r1
000888  4616              MOV      r6,r2
;;;1336       //u32     i;
;;;1337       
;;;1338       
;;;1339      // for (i = 0; i < BSP_DEVICE_ID_N; i++) {
;;;1340           if ((COM_IsFault[id] == FALSE)&&(COM_GetIsDrop(COM_UpStNow[id]) != FALSE)) {
00088a  481b              LDR      r0,|L1.2296|
00088c  5d00              LDRB     r0,[r0,r4]
00088e  b940              CBNZ     r0,|L1.2210|
000890  4925              LDR      r1,|L1.2344|
000892  5d08              LDRB     r0,[r1,r4]
000894  f7fffffe          BL       COM_GetIsDrop
000898  b118              CBZ      r0,|L1.2210|
;;;1341               MOTO_CutSetCmd(id, MOTO_CUT_H);
00089a  210b              MOVS     r1,#0xb
00089c  4620              MOV      r0,r4
00089e  f7fffffe          BL       MOTO_CutSetCmd
                  |L1.2210|
;;;1342          // }
;;;1343       }
;;;1344   }static  void  COM_ID_9511CutD (BSP_ID_TypeDef id,u16 buf[], u8 len)//剪刀收回
0008a2  bd70              POP      {r4-r6,pc}
;;;1345   {
                          ENDP

                  COM_ID_9511CutD PROC
0008a4  b570              PUSH     {r4-r6,lr}            ;1344
0008a6  4604              MOV      r4,r0
0008a8  460d              MOV      r5,r1
0008aa  4616              MOV      r6,r2
;;;1346       //u32     i;
;;;1347       
;;;1348       
;;;1349      // for (i = 0; i < BSP_DEVICE_ID_N; i++) {
;;;1350           if ((COM_IsFault[id] == FALSE)&&(COM_GetIsDrop(COM_UpStNow[id]) != FALSE)) {
0008ac  4812              LDR      r0,|L1.2296|
0008ae  5d00              LDRB     r0,[r0,r4]
0008b0  b940              CBNZ     r0,|L1.2244|
0008b2  491d              LDR      r1,|L1.2344|
0008b4  5d08              LDRB     r0,[r1,r4]
0008b6  f7fffffe          BL       COM_GetIsDrop
0008ba  b118              CBZ      r0,|L1.2244|
;;;1351               MOTO_CutSetCmd(id, MOTO_CUT_D);
0008bc  210a              MOVS     r1,#0xa
0008be  4620              MOV      r0,r4
0008c0  f7fffffe          BL       MOTO_CutSetCmd
                  |L1.2244|
;;;1352          // }
;;;1353       }
;;;1354   }
0008c4  bd70              POP      {r4-r6,pc}
;;;1355   static  void  COM_ID_9511CutHalf (BSP_ID_TypeDef id,u16 buf[], u8 len)//剪刀半出
                          ENDP

                  COM_ID_9511CutHalf PROC
0008c6  b570              PUSH     {r4-r6,lr}
;;;1356   {
0008c8  4604              MOV      r4,r0
0008ca  460d              MOV      r5,r1
0008cc  4616              MOV      r6,r2
;;;1357      // u32     i;
;;;1358       
;;;1359       
;;;1360      // for (i = 0; i < BSP_DEVICE_ID_N; i++) {
;;;1361           if ((COM_IsFault[id] == FALSE) && (COM_DnIsEnable[id] == TRUE)&&(COM_GetIsDrop(COM_UpStNow[id]) != FALSE)) {
0008ce  480a              LDR      r0,|L1.2296|
0008d0  5d00              LDRB     r0,[r0,r4]
0008d2  b960              CBNZ     r0,|L1.2286|
0008d4  4809              LDR      r0,|L1.2300|
0008d6  5d00              LDRB     r0,[r0,r4]
0008d8  2801              CMP      r0,#1
0008da  d108              BNE      |L1.2286|
0008dc  4912              LDR      r1,|L1.2344|
0008de  5d08              LDRB     r0,[r1,r4]
0008e0  f7fffffe          BL       COM_GetIsDrop
0008e4  b118              CBZ      r0,|L1.2286|
;;;1362               MOTO_CutSetCmd(id, MOTO_CUT_HALF);
0008e6  210d              MOVS     r1,#0xd
0008e8  4620              MOV      r0,r4
0008ea  f7fffffe          BL       MOTO_CutSetCmd
                  |L1.2286|
;;;1363        //   }
;;;1364       }
;;;1365   }
0008ee  bd70              POP      {r4-r6,pc}
                  |L1.2288|
                          DCD      COM_9511TangkongPatch
                  |L1.2292|
                          DCD      TK_Org
                  |L1.2296|
                          DCD      COM_IsFault
                  |L1.2300|
                          DCD      COM_DnIsEnable
                  |L1.2304|
                          DCD      HeadUpDown_Status
                  |L1.2308|
                          DCD      COM_Tangkong_Pos_Last
                  |L1.2312|
                          DCD      BSP_DIP_9511Addr
                  |L1.2316|
                          DCD      COM_9511TangkongDir
                  |L1.2320|
                          DCD      COM_IsHghRest
                  |L1.2324|
                          DCD      COM_HghIsAim
                  |L1.2328|
                          DCD      COM_9511CheckNum
                  |L1.2332|
                          DCD      COM_9511CheckSum
                  |L1.2336|
                          DCD      COM_9511CheckErr
                  |L1.2340|
                          DCD      COM_UpStLast
                  |L1.2344|
                          DCD      COM_UpStNow
                  |L1.2348|
                          DCD      COM_TKIsEnable
                  |L1.2352|
                          DCD      IN_TEN_MULTIPLE
                          ENDP

                  COM_ID_9511CutFull PROC
;;;1366   
;;;1367   static  void  COM_ID_9511CutFull (BSP_ID_TypeDef id,u16 buf[], u8 len)//剪线满入
000934  b570              PUSH     {r4-r6,lr}
;;;1368   {
000936  4604              MOV      r4,r0
000938  460d              MOV      r5,r1
00093a  4616              MOV      r6,r2
;;;1369      // u32     i;
;;;1370       
;;;1371       
;;;1372       //for (i = 0; i < BSP_DEVICE_ID_N; i++) {
;;;1373           if ((COM_IsFault[id] == FALSE) && (COM_DnIsEnable[id] == TRUE)&&(COM_GetIsDrop(COM_UpStNow[id]) != FALSE)) {
00093c  48f8              LDR      r0,|L1.3360|
00093e  5d00              LDRB     r0,[r0,r4]
000940  b960              CBNZ     r0,|L1.2396|
000942  48f8              LDR      r0,|L1.3364|
000944  5d00              LDRB     r0,[r0,r4]
000946  2801              CMP      r0,#1
000948  d108              BNE      |L1.2396|
00094a  49f7              LDR      r1,|L1.3368|
00094c  5d08              LDRB     r0,[r1,r4]
00094e  f7fffffe          BL       COM_GetIsDrop
000952  b118              CBZ      r0,|L1.2396|
;;;1374               MOTO_CutSetCmd(id, MOTO_CUT_FULL);
000954  210e              MOVS     r1,#0xe
000956  4620              MOV      r0,r4
000958  f7fffffe          BL       MOTO_CutSetCmd
                  |L1.2396|
;;;1375           //}
;;;1376       }
;;;1377   }
00095c  bd70              POP      {r4-r6,pc}
;;;1378   static  void  COM_9511CutSetPara (u16 buf[], u8 len)
                          ENDP

                  COM_9511CutSetPara PROC
00095e  b570              PUSH     {r4-r6,lr}
;;;1379   {
000960  4604              MOV      r4,r0
000962  460e              MOV      r6,r1
;;;1380       u32     i;
;;;1381       
;;;1382       
;;;1383       for (i = 0; i < BSP_DEVICE_ID_N; i++) {
000964  2500              MOVS     r5,#0
000966  e010              B        |L1.2442|
                  |L1.2408|
;;;1384           /// 以下3个参数, 不在此判断范围
;;;1385           MOTO_CutSetFullAngle((u8)(buf[0] & COM_MSK_9511_DATA));
000968  8821              LDRH     r1,[r4,#0]
00096a  f001007f          AND      r0,r1,#0x7f
00096e  f7fffffe          BL       MOTO_CutSetFullAngle
;;;1386           MOTO_CutSetHalfAngle((u8)(buf[1] & COM_MSK_9511_DATA));
000972  8861              LDRH     r1,[r4,#2]
000974  f001007f          AND      r0,r1,#0x7f
000978  f7fffffe          BL       MOTO_CutSetHalfAngle
;;;1387           MOTO_SetSpdEngine(MOTO_USE_CUT, buf[2] & COM_MSK_9511_DATA);
00097c  88a0              LDRH     r0,[r4,#4]
00097e  f000017f          AND      r1,r0,#0x7f
000982  2001              MOVS     r0,#1
000984  f7fffffe          BL       MOTO_SetSpdEngine
000988  1c6d              ADDS     r5,r5,#1              ;1383
                  |L1.2442|
00098a  2d02              CMP      r5,#2                 ;1383
00098c  d3ec              BCC      |L1.2408|
;;;1388       }
;;;1389   }
00098e  bd70              POP      {r4-r6,pc}
;;;1390   
                          ENDP

                  COM_9511GetVersion PROC
;;;1391   static  void  COM_9511GetVersion (u16 buf[], u8 len)
000990  b570              PUSH     {r4-r6,lr}
;;;1392   {
000992  4604              MOV      r4,r0
000994  460d              MOV      r5,r1
;;;1393       C491_SendOne(VERSION9511, 0);
000996  2100              MOVS     r1,#0
000998  2003              MOVS     r0,#3
00099a  f7fffffe          BL       C491_SendOne
;;;1394   }
00099e  bd70              POP      {r4-r6,pc}
;;;1395   
                          ENDP

                  COM_9511SetRedOdd PROC
;;;1396   static  void  COM_9511SetRedOdd (u16 buf[], u8 len)
0009a0  b570              PUSH     {r4-r6,lr}
;;;1397   {
0009a2  4604              MOV      r4,r0
0009a4  460d              MOV      r5,r1
;;;1398       HDLED_Set(BSP_ID_ODD, HDLED_ST_RED);
0009a6  2101              MOVS     r1,#1
0009a8  2000              MOVS     r0,#0
0009aa  f7fffffe          BL       HDLED_Set
;;;1399   }
0009ae  bd70              POP      {r4-r6,pc}
;;;1400   
                          ENDP

                  COM_9511SetGreOdd PROC
;;;1401   static  void  COM_9511SetGreOdd (u16 buf[], u8 len)
0009b0  b570              PUSH     {r4-r6,lr}
;;;1402   {
0009b2  4604              MOV      r4,r0
0009b4  460d              MOV      r5,r1
;;;1403       HDLED_Set(BSP_ID_ODD, HDLED_ST_GRE);
0009b6  2102              MOVS     r1,#2
0009b8  2000              MOVS     r0,#0
0009ba  f7fffffe          BL       HDLED_Set
;;;1404   }
0009be  bd70              POP      {r4-r6,pc}
;;;1405   
                          ENDP

                  COM_9511SetOraOdd PROC
;;;1406   static  void  COM_9511SetOraOdd (u16 buf[], u8 len)
0009c0  b570              PUSH     {r4-r6,lr}
;;;1407   {
0009c2  4604              MOV      r4,r0
0009c4  460d              MOV      r5,r1
;;;1408       HDLED_Set(BSP_ID_ODD, HDLED_ST_ORA);
0009c6  2100              MOVS     r1,#0
0009c8  4608              MOV      r0,r1
0009ca  f7fffffe          BL       HDLED_Set
;;;1409   }
0009ce  bd70              POP      {r4-r6,pc}
;;;1410   
                          ENDP

                  COM_9511SetRedEven PROC
;;;1411   static  void  COM_9511SetRedEven (u16 buf[], u8 len)
0009d0  b570              PUSH     {r4-r6,lr}
;;;1412   {
0009d2  4604              MOV      r4,r0
0009d4  460d              MOV      r5,r1
;;;1413       HDLED_Set(BSP_ID_EVEN, HDLED_ST_RED);
0009d6  2101              MOVS     r1,#1
0009d8  4608              MOV      r0,r1
0009da  f7fffffe          BL       HDLED_Set
;;;1414   }
0009de  bd70              POP      {r4-r6,pc}
;;;1415   
                          ENDP

                  COM_9511SetGreEven PROC
;;;1416   static  void  COM_9511SetGreEven (u16 buf[], u8 len)
0009e0  b570              PUSH     {r4-r6,lr}
;;;1417   {
0009e2  4604              MOV      r4,r0
0009e4  460d              MOV      r5,r1
;;;1418       HDLED_Set(BSP_ID_EVEN, HDLED_ST_GRE);
0009e6  2102              MOVS     r1,#2
0009e8  2001              MOVS     r0,#1
0009ea  f7fffffe          BL       HDLED_Set
;;;1419   }
0009ee  bd70              POP      {r4-r6,pc}
;;;1420   
                          ENDP

                  COM_9511SetOraEven PROC
;;;1421   static  void  COM_9511SetOraEven (u16 buf[], u8 len)
0009f0  b570              PUSH     {r4-r6,lr}
;;;1422   {
0009f2  4604              MOV      r4,r0
0009f4  460d              MOV      r5,r1
;;;1423       HDLED_Set(BSP_ID_EVEN, HDLED_ST_ORA);
0009f6  2100              MOVS     r1,#0
0009f8  2001              MOVS     r0,#1
0009fa  f7fffffe          BL       HDLED_Set
;;;1424   }
0009fe  bd70              POP      {r4-r6,pc}
;;;1425   static  void  COM_9511TestEnter (u16 buf[], u8 len)
                          ENDP

                  COM_9511TestEnter PROC
000a00  b570              PUSH     {r4-r6,lr}
;;;1426   {
000a02  4604              MOV      r4,r0
000a04  460d              MOV      r5,r1
;;;1427   	if((IN_HDKey_GetSt(0))!=HDKEY_ST_DN)
000a06  2000              MOVS     r0,#0
000a08  f7fffffe          BL       IN_HDKey_GetSt
000a0c  2802              CMP      r0,#2
000a0e  d003              BEQ      |L1.2584|
;;;1428       	COM_9511SetRedOdd(0,0);
000a10  2100              MOVS     r1,#0
000a12  4608              MOV      r0,r1
000a14  f7fffffe          BL       COM_9511SetRedOdd
                  |L1.2584|
;;;1429   	if((IN_HDKey_GetSt(1))!=HDKEY_ST_DN)
000a18  2001              MOVS     r0,#1
000a1a  f7fffffe          BL       IN_HDKey_GetSt
000a1e  2802              CMP      r0,#2
000a20  d003              BEQ      |L1.2602|
;;;1430   		COM_9511SetRedEven(0,0);
000a22  2100              MOVS     r1,#0
000a24  4608              MOV      r0,r1
000a26  f7fffffe          BL       COM_9511SetRedEven
                  |L1.2602|
;;;1431   	COM_9511IsTset  =   TRUE;
000a2a  2001              MOVS     r0,#1
000a2c  49bf              LDR      r1,|L1.3372|
000a2e  7008              STRB     r0,[r1,#0]
;;;1432   	COM_Tangkong_WorkHigh_Last=COM_Tangkong_WorkHigh;
000a30  48bf              LDR      r0,|L1.3376|
000a32  7800              LDRB     r0,[r0,#0]  ; COM_Tangkong_WorkHigh
000a34  49bf              LDR      r1,|L1.3380|
000a36  7008              STRB     r0,[r1,#0]
;;;1433       if(COM_Tangkong_WorkHigh==0)
000a38  48bd              LDR      r0,|L1.3376|
000a3a  7800              LDRB     r0,[r0,#0]  ; COM_Tangkong_WorkHigh
000a3c  b910              CBNZ     r0,|L1.2628|
;;;1434   		  COM_Tangkong_WorkHigh=6;
000a3e  2006              MOVS     r0,#6
000a40  49bb              LDR      r1,|L1.3376|
000a42  7008              STRB     r0,[r1,#0]
                  |L1.2628|
;;;1435   			
;;;1436   }
000a44  bd70              POP      {r4-r6,pc}
;;;1437   
                          ENDP

                  COM_9511TestExit PROC
;;;1438   static  void  COM_9511TestExit (u16 buf[], u8 len)
000a46  b570              PUSH     {r4-r6,lr}
;;;1439   {
000a48  4604              MOV      r4,r0
000a4a  460d              MOV      r5,r1
;;;1440       u32     i;
;;;1441       COM_9511IsTset  =   FALSE;
000a4c  2000              MOVS     r0,#0
000a4e  49b7              LDR      r1,|L1.3372|
000a50  7008              STRB     r0,[r1,#0]
;;;1442       if((IN_HDKey_GetSt(0))!=HDKEY_ST_DN)
000a52  f7fffffe          BL       IN_HDKey_GetSt
000a56  2802              CMP      r0,#2
000a58  d003              BEQ      |L1.2658|
;;;1443       	COM_9511SetGreOdd(0,0);
000a5a  2100              MOVS     r1,#0
000a5c  4608              MOV      r0,r1
000a5e  f7fffffe          BL       COM_9511SetGreOdd
                  |L1.2658|
;;;1444   	if((IN_HDKey_GetSt(1))!=HDKEY_ST_DN)
000a62  2001              MOVS     r0,#1
000a64  f7fffffe          BL       IN_HDKey_GetSt
000a68  2802              CMP      r0,#2
000a6a  d003              BEQ      |L1.2676|
;;;1445   		COM_9511SetGreEven(0,0);
000a6c  2100              MOVS     r1,#0
000a6e  4608              MOV      r0,r1
000a70  f7fffffe          BL       COM_9511SetGreEven
                  |L1.2676|
;;;1446       
;;;1447       COM_Tangkong_WorkHigh=COM_Tangkong_WorkHigh_Last;
000a74  48af              LDR      r0,|L1.3380|
000a76  7800              LDRB     r0,[r0,#0]  ; COM_Tangkong_WorkHigh_Last
000a78  49ad              LDR      r1,|L1.3376|
000a7a  7008              STRB     r0,[r1,#0]
;;;1448   //    COM_AllUpdate();
;;;1449   //    for (i = 0; i < BSP_DEVICE_ID_N; i++) {
;;;1450   //        COM_LedUpdate((BSP_ID_TypeDef)i);
;;;1451   /// !!! cy 100908   测试状态可改变针高, 则退出不用刷新
;;;1452   ////        COM_HghUpdate((BSP_ID_TypeDef)i);
;;;1453   //        if (COM_IsHghRest == FALSE) {           /// 为安全上电后针高不动, 直到有主控命令或开关变化
;;;1454   //            COM_HghUpdate((BSP_ID_TypeDef)i);
;;;1455   //        }
;;;1456   /// !!! cy 100908   测试状态可改变针高, 则退出不用刷新
;;;1457   //    }
;;;1458   }
000a7c  bd70              POP      {r4-r6,pc}
;;;1459   static  void  COM_9511MAOrgOut (u16 buf[], u8 len)
                          ENDP

                  COM_9511MAOrgOut PROC
000a7e  2200              MOVS     r2,#0
;;;1460   {
;;;1461       COM_9511MAIsInOrg   =   FALSE;
000a80  4bad              LDR      r3,|L1.3384|
000a82  701a              STRB     r2,[r3,#0]
;;;1462   }
000a84  4770              BX       lr
;;;1463   
                          ENDP

                  COM_9511GetHghOdd PROC
;;;1464   #define COM_TIMES_TEST_AD   8
;;;1465   static  void  COM_9511GetHghOdd (u16 buf[], u8 len)
000a86  b570              PUSH     {r4-r6,lr}
;;;1466   {
000a88  4605              MOV      r5,r0
000a8a  460e              MOV      r6,r1
;;;1467       u16     rt;
;;;1468       
;;;1469       
;;;1470       if (MOTO_HghGetIsActing(BSP_ID_ODD) != FALSE) {
000a8c  2000              MOVS     r0,#0
000a8e  f7fffffe          BL       MOTO_HghGetIsActing
000a92  b108              CBZ      r0,|L1.2712|
;;;1471           rt  =   COM_8_RES_BUSY;
000a94  2412              MOVS     r4,#0x12
000a96  e01b              B        |L1.2768|
                  |L1.2712|
;;;1472       } else {
;;;1473   /// cy  101130  modify
;;;1474   //        rt  =   MOTO_HghGetHeight(BSP_ID_ODD);
;;;1475           
;;;1476           if (COM_9511MAIsRunning) {
000a98  48a8              LDR      r0,|L1.3388|
000a9a  7800              LDRB     r0,[r0,#0]  ; COM_9511MAIsRunning
000a9c  b110              CBZ      r0,|L1.2724|
;;;1477               rt  =   COM_WorkHigh;
000a9e  48a8              LDR      r0,|L1.3392|
000aa0  7804              LDRB     r4,[r0,#0]  ; COM_WorkHigh
000aa2  e015              B        |L1.2768|
                  |L1.2724|
;;;1478           } else {
;;;1479               rt  =   MOTO_HghGetHeight(BSP_ID_ODD);
000aa4  2000              MOVS     r0,#0
000aa6  f7fffffe          BL       MOTO_HghGetHeight
000aaa  4604              MOV      r4,r0
;;;1480   /// cy  110228
;;;1481   //            if (rt != MOTO_HGH_POS_UP) {
;;;1482               if ((rt != MOTO_HGH_POS_UP) && (COM_IsHghRest == FALSE)) {
000aac  2c0a              CMP      r4,#0xa
000aae  d00f              BEQ      |L1.2768|
000ab0  48a4              LDR      r0,|L1.3396|
000ab2  7800              LDRB     r0,[r0,#0]  ; COM_IsHghRest
000ab4  b960              CBNZ     r0,|L1.2768|
;;;1483   /// cy  110228
;;;1484                   if (COM_WorkHigh != MOTO_HGH_POS_UP) {
000ab6  48a2              LDR      r0,|L1.3392|
000ab8  7800              LDRB     r0,[r0,#0]  ; COM_WorkHigh
000aba  280a              CMP      r0,#0xa
000abc  d002              BEQ      |L1.2756|
;;;1485                       rt  =   COM_WorkHigh;
000abe  48a0              LDR      r0,|L1.3392|
000ac0  7804              LDRB     r4,[r0,#0]  ; COM_WorkHigh
000ac2  e005              B        |L1.2768|
                  |L1.2756|
;;;1486                   } else {
;;;1487                       if (MOTO_HghTestIsUp(BSP_ID_ODD, COM_TIMES_TEST_AD) != FALSE) {
000ac4  2108              MOVS     r1,#8
000ac6  2000              MOVS     r0,#0
000ac8  f7fffffe          BL       MOTO_HghTestIsUp
000acc  b100              CBZ      r0,|L1.2768|
;;;1488                           rt  =   MOTO_HGH_POS_UP;
000ace  240a              MOVS     r4,#0xa
                  |L1.2768|
;;;1489                       } else {
;;;1490                           ;
;;;1491                       }
;;;1492                   }
;;;1493               } else {
;;;1494                   ;
;;;1495               }
;;;1496           }
;;;1497   /// cy  101130  modify
;;;1498       }
;;;1499       C491_SendOne(rt, 0);
000ad0  2100              MOVS     r1,#0
000ad2  4620              MOV      r0,r4
000ad4  f7fffffe          BL       C491_SendOne
;;;1500   }
000ad8  bd70              POP      {r4-r6,pc}
;;;1501   
                          ENDP

                  COM_9511GetHghEven PROC
;;;1502   static  void  COM_9511GetHghEven (u16 buf[], u8 len)
000ada  b570              PUSH     {r4-r6,lr}
;;;1503   {
000adc  4605              MOV      r5,r0
000ade  460e              MOV      r6,r1
;;;1504       u16     rt;
;;;1505       
;;;1506       
;;;1507       if (MOTO_HghGetIsActing(BSP_ID_EVEN) != FALSE) {
000ae0  2001              MOVS     r0,#1
000ae2  f7fffffe          BL       MOTO_HghGetIsActing
000ae6  b108              CBZ      r0,|L1.2796|
;;;1508           rt  =   COM_8_RES_BUSY;
000ae8  2412              MOVS     r4,#0x12
000aea  e01b              B        |L1.2852|
                  |L1.2796|
;;;1509       } else {
;;;1510   /// cy  101130  modify
;;;1511   //        rt  =   MOTO_HghGetHeight(BSP_ID_EVEN);
;;;1512           
;;;1513           if (COM_9511MAIsRunning) {
000aec  4893              LDR      r0,|L1.3388|
000aee  7800              LDRB     r0,[r0,#0]  ; COM_9511MAIsRunning
000af0  b110              CBZ      r0,|L1.2808|
;;;1514               rt  =   COM_WorkHigh;
000af2  4893              LDR      r0,|L1.3392|
000af4  7804              LDRB     r4,[r0,#0]  ; COM_WorkHigh
000af6  e015              B        |L1.2852|
                  |L1.2808|
;;;1515           } else {
;;;1516               rt  =   MOTO_HghGetHeight(BSP_ID_EVEN);
000af8  2001              MOVS     r0,#1
000afa  f7fffffe          BL       MOTO_HghGetHeight
000afe  4604              MOV      r4,r0
;;;1517   /// cy  110228
;;;1518   //            if (rt != MOTO_HGH_POS_UP) {
;;;1519               if ((rt != MOTO_HGH_POS_UP) && (COM_IsHghRest == FALSE)) {
000b00  2c0a              CMP      r4,#0xa
000b02  d00f              BEQ      |L1.2852|
000b04  488f              LDR      r0,|L1.3396|
000b06  7800              LDRB     r0,[r0,#0]  ; COM_IsHghRest
000b08  b960              CBNZ     r0,|L1.2852|
;;;1520   /// cy  110228
;;;1521                   if (COM_WorkHigh != MOTO_HGH_POS_UP) {
000b0a  488d              LDR      r0,|L1.3392|
000b0c  7800              LDRB     r0,[r0,#0]  ; COM_WorkHigh
000b0e  280a              CMP      r0,#0xa
000b10  d002              BEQ      |L1.2840|
;;;1522                       rt  =   COM_WorkHigh;
000b12  488b              LDR      r0,|L1.3392|
000b14  7804              LDRB     r4,[r0,#0]  ; COM_WorkHigh
000b16  e005              B        |L1.2852|
                  |L1.2840|
;;;1523                   } else {
;;;1524                       if (MOTO_HghTestIsUp(BSP_ID_EVEN, COM_TIMES_TEST_AD) != FALSE) {
000b18  2108              MOVS     r1,#8
000b1a  2001              MOVS     r0,#1
000b1c  f7fffffe          BL       MOTO_HghTestIsUp
000b20  b100              CBZ      r0,|L1.2852|
;;;1525                           rt  =   MOTO_HGH_POS_UP;
000b22  240a              MOVS     r4,#0xa
                  |L1.2852|
;;;1526                       } else {
;;;1527                           ;
;;;1528                       }
;;;1529                   }
;;;1530               } else {
;;;1531                   ;
;;;1532               }
;;;1533           }
;;;1534   /// cy  101130  modify
;;;1535       }
;;;1536       C491_SendOne(rt, 0);
000b24  2100              MOVS     r1,#0
000b26  4620              MOV      r0,r4
000b28  f7fffffe          BL       C491_SendOne
;;;1537   }
000b2c  bd70              POP      {r4-r6,pc}
;;;1538   
                          ENDP

                  COM_9511GetADOdd PROC
;;;1539   static  void  COM_9511GetADOdd (u16 buf[], u8 len)
000b2e  b570              PUSH     {r4-r6,lr}
;;;1540   {
000b30  4605              MOV      r5,r0
000b32  460e              MOV      r6,r1
;;;1541       u16     rt;
;;;1542       
;;;1543       
;;;1544       if (MOTO_HghGetIsActing(BSP_ID_ODD) != FALSE) {
000b34  2000              MOVS     r0,#0
000b36  f7fffffe          BL       MOTO_HghGetIsActing
000b3a  b108              CBZ      r0,|L1.2880|
;;;1545           rt  =   COM_8_RES_BUSY;
000b3c  2412              MOVS     r4,#0x12
000b3e  e003              B        |L1.2888|
                  |L1.2880|
;;;1546       } else {
;;;1547           rt  =   BSP_POT_GetAve(BSP_ID_ODD) >> 8;               /// 回高8位
000b40  2000              MOVS     r0,#0
000b42  f7fffffe          BL       BSP_POT_GetAve
000b46  1204              ASRS     r4,r0,#8
                  |L1.2888|
;;;1548       }
;;;1549       C491_SendOne(rt, 0);
000b48  2100              MOVS     r1,#0
000b4a  4620              MOV      r0,r4
000b4c  f7fffffe          BL       C491_SendOne
;;;1550   }
000b50  bd70              POP      {r4-r6,pc}
;;;1551   
                          ENDP

                  COM_9511GetADEven PROC
;;;1552   static  void  COM_9511GetADEven (u16 buf[], u8 len)
000b52  b570              PUSH     {r4-r6,lr}
;;;1553   {
000b54  4605              MOV      r5,r0
000b56  460e              MOV      r6,r1
;;;1554       u16     rt;
;;;1555       
;;;1556       
;;;1557       if (MOTO_HghGetIsActing(BSP_ID_EVEN) != FALSE) {
000b58  2001              MOVS     r0,#1
000b5a  f7fffffe          BL       MOTO_HghGetIsActing
000b5e  b108              CBZ      r0,|L1.2916|
;;;1558           rt  =   COM_8_RES_BUSY;
000b60  2412              MOVS     r4,#0x12
000b62  e003              B        |L1.2924|
                  |L1.2916|
;;;1559       } else {
;;;1560           rt  =   BSP_POT_GetAve(BSP_ID_EVEN) >> 8;               /// 回高8位
000b64  2001              MOVS     r0,#1
000b66  f7fffffe          BL       BSP_POT_GetAve
000b6a  1204              ASRS     r4,r0,#8
                  |L1.2924|
;;;1561       }
;;;1562       C491_SendOne(rt, 0);
000b6c  2100              MOVS     r1,#0
000b6e  4620              MOV      r0,r4
000b70  f7fffffe          BL       C491_SendOne
;;;1563   }
000b74  bd70              POP      {r4-r6,pc}
;;;1564   
                          ENDP

                  COM_9511MAOneLoop PROC
;;;1565   /// 处理主轴信息, 不处理断线检测信息
;;;1566   static  void  COM_9511MAOneLoop (u16 buf[], u8 len)
000b76  b570              PUSH     {r4-r6,lr}
;;;1567   {
000b78  4605              MOV      r5,r0
000b7a  460e              MOV      r6,r1
;;;1568       u32     i;
;;;1569       
;;;1570       
;;;1571       COM_9511MAIsInOrg   =   FALSE;
000b7c  2000              MOVS     r0,#0
000b7e  496e              LDR      r1,|L1.3384|
000b80  7008              STRB     r0,[r1,#0]
;;;1572       COM_9511MAIsRunning =   TRUE;               /// cy  101115  added
000b82  2001              MOVS     r0,#1
000b84  496d              LDR      r1,|L1.3388|
000b86  7008              STRB     r0,[r1,#0]
;;;1573       
;;;1574       for (i = 0; i < BSP_DEVICE_ID_N; i++) {
000b88  2400              MOVS     r4,#0
000b8a  e007              B        |L1.2972|
                  |L1.2956|
;;;1575           if (COM_IsFault[i] == FALSE) {
000b8c  4864              LDR      r0,|L1.3360|
000b8e  5d00              LDRB     r0,[r0,r4]
000b90  b918              CBNZ     r0,|L1.2970|
;;;1576   
;;;1577               HDLED_Sparkle((BSP_ID_TypeDef)i, 3);
000b92  2103              MOVS     r1,#3
000b94  b2e0              UXTB     r0,r4
000b96  f7fffffe          BL       HDLED_Sparkle
                  |L1.2970|
000b9a  1c64              ADDS     r4,r4,#1              ;1574
                  |L1.2972|
000b9c  2c02              CMP      r4,#2                 ;1574
000b9e  d3f5              BCC      |L1.2956|
;;;1578   
;;;1579           }
;;;1580       }
;;;1581   }
000ba0  bd70              POP      {r4-r6,pc}
;;;1582   
                          ENDP

                  COM_9511SetGreALL PROC
;;;1583   /// ! 可能不用了
;;;1584   static  void  COM_9511SetGreALL (u16 buf[], u8 len)//全变绿灯，主控发指令
000ba2  b570              PUSH     {r4-r6,lr}
;;;1585   {
000ba4  4605              MOV      r5,r0
000ba6  460e              MOV      r6,r1
;;;1586   
;;;1587       u32     i;
;;;1588       
;;;1589       
;;;1590       for (i = 0; i < BSP_DEVICE_ID_N; i++) {
000ba8  2400              MOVS     r4,#0
000baa  e010              B        |L1.3022|
                  |L1.2988|
;;;1591   //        if ((COM_IsFault[i] == FALSE) && (COM_UpStBits[COM_UpStNow[i]] & (1 << COM_UP_BIT_IS_DROP))) {
;;;1592           if ((COM_IsFault[i] == FALSE) && (COM_GetIsBroken(COM_UpStNow[i]) != FALSE)&&(COM_UpStLast[i]!=COM_UP_ST_BROKEN)) {
000bac  485c              LDR      r0,|L1.3360|
000bae  5d00              LDRB     r0,[r0,r4]
000bb0  b960              CBNZ     r0,|L1.3020|
000bb2  495d              LDR      r1,|L1.3368|
000bb4  5d08              LDRB     r0,[r1,r4]
000bb6  f7fffffe          BL       COM_GetIsBroken
000bba  b138              CBZ      r0,|L1.3020|
000bbc  4862              LDR      r0,|L1.3400|
000bbe  5d00              LDRB     r0,[r0,r4]
000bc0  2802              CMP      r0,#2
000bc2  d003              BEQ      |L1.3020|
;;;1593               HDLED_Set((BSP_ID_TypeDef)i, HDLED_ST_GRE);
000bc4  2102              MOVS     r1,#2
000bc6  b2e0              UXTB     r0,r4
000bc8  f7fffffe          BL       HDLED_Set
                  |L1.3020|
000bcc  1c64              ADDS     r4,r4,#1              ;1590
                  |L1.3022|
000bce  2c02              CMP      r4,#2                 ;1590
000bd0  d3ec              BCC      |L1.2988|
;;;1594           }
;;;1595       }
;;;1596   }
000bd2  bd70              POP      {r4-r6,pc}
;;;1597   
                          ENDP

                  COM_9511UpStByExitP PROC
;;;1929   /// 因退出补绣而改变状态
;;;1930   static  void  COM_9511UpStByExitP (void)
000bd4  b510              PUSH     {r4,lr}
;;;1931   {
;;;1932       u32     i;
;;;1933    COM_9511SetGreALL(0,0);   
000bd6  2100              MOVS     r1,#0
000bd8  4608              MOV      r0,r1
000bda  f7fffffe          BL       COM_9511SetGreALL
;;;1934   //因为只有补绣状态，所以只对补绣的状态进行处理    
;;;1935       for (i = 0; i < BSP_DEVICE_ID_N; i++) {
000bde  2400              MOVS     r4,#0
000be0  e034              B        |L1.3148|
                  |L1.3042|
;;;1936           switch (COM_UpStNow[i]) {
000be2  4851              LDR      r0,|L1.3368|
000be4  5d00              LDRB     r0,[r0,r4]
000be6  2803              CMP      r0,#3
000be8  d006              BEQ      |L1.3064|
000bea  2804              CMP      r0,#4
000bec  d009              BEQ      |L1.3074|
000bee  2805              CMP      r0,#5
000bf0  d00c              BEQ      |L1.3084|
000bf2  2806              CMP      r0,#6
000bf4  d121              BNE      |L1.3130|
000bf6  e01b              B        |L1.3120|
                  |L1.3064|
;;;1937           case COM_UP_ST_PATCH_LOCK:
;;;1938               COM_9511UpStChange((BSP_ID_TypeDef)i, COM_UP_ST_LOCK);
000bf8  2100              MOVS     r1,#0
000bfa  b2e0              UXTB     r0,r4
000bfc  f7fffffe          BL       COM_9511UpStChange
;;;1939               break;
000c00  e01f              B        |L1.3138|
                  |L1.3074|
;;;1940           case COM_UP_ST_PATCH_IDLE:
;;;1941   		 		COM_9511UpStChange((BSP_ID_TypeDef)i, COM_UP_ST_NORMAL);
000c02  2101              MOVS     r1,#1
000c04  b2e0              UXTB     r0,r4
000c06  f7fffffe          BL       COM_9511UpStChange
;;;1942               break;
000c0a  e01a              B        |L1.3138|
                  |L1.3084|
;;;1943           case COM_UP_ST_PATCH_NORMAL: 
;;;1944   			if((COM_UpStLast[i]==COM_UP_ST_BROKEN)||(COM_UpStLast[i]==COM_UP_ST_PATCH_BROKEN))
000c0c  484e              LDR      r0,|L1.3400|
000c0e  5d00              LDRB     r0,[r0,r4]
000c10  2802              CMP      r0,#2
000c12  d003              BEQ      |L1.3100|
000c14  484c              LDR      r0,|L1.3400|
000c16  5d00              LDRB     r0,[r0,r4]
000c18  2806              CMP      r0,#6
000c1a  d104              BNE      |L1.3110|
                  |L1.3100|
;;;1945   				COM_9511UpStChange((BSP_ID_TypeDef)i, COM_UP_ST_BROKEN);
000c1c  2102              MOVS     r1,#2
000c1e  b2e0              UXTB     r0,r4
000c20  f7fffffe          BL       COM_9511UpStChange
000c24  e003              B        |L1.3118|
                  |L1.3110|
;;;1946   			else        
;;;1947               	COM_9511UpStChange((BSP_ID_TypeDef)i, COM_UP_ST_NORMAL);
000c26  2101              MOVS     r1,#1
000c28  b2e0              UXTB     r0,r4
000c2a  f7fffffe          BL       COM_9511UpStChange
                  |L1.3118|
;;;1948               break;
000c2e  e008              B        |L1.3138|
                  |L1.3120|
;;;1949           case COM_UP_ST_PATCH_BROKEN:
;;;1950               	COM_9511UpStChange((BSP_ID_TypeDef)i, COM_UP_ST_BROKEN);
000c30  2102              MOVS     r1,#2
000c32  b2e0              UXTB     r0,r4
000c34  f7fffffe          BL       COM_9511UpStChange
;;;1951               break;
000c38  e003              B        |L1.3138|
                  |L1.3130|
;;;1952           default:                                /// 其他状态不变
;;;1953   			COM_UpStNow[i]=COM_UP_ST_NORMAL;	
000c3a  2001              MOVS     r0,#1
000c3c  493a              LDR      r1,|L1.3368|
000c3e  5508              STRB     r0,[r1,r4]
;;;1954               break;
000c40  bf00              NOP      
                  |L1.3138|
000c42  bf00              NOP                            ;1939
;;;1955           }
;;;1956   		COM_9511TangkongPatch[i]=0;
000c44  2000              MOVS     r0,#0
000c46  4941              LDR      r1,|L1.3404|
000c48  5508              STRB     r0,[r1,r4]
000c4a  1c64              ADDS     r4,r4,#1              ;1935
                  |L1.3148|
000c4c  2c02              CMP      r4,#2                 ;1935
000c4e  d3c8              BCC      |L1.3042|
;;;1957       }
;;;1958   }
000c50  bd10              POP      {r4,pc}
;;;1959   
                          ENDP

                  COM_9511PatchExit PROC
;;;1597   
;;;1598   static  void  COM_9511PatchExit (u16 buf[], u8 len)
000c52  b570              PUSH     {r4-r6,lr}
;;;1599   {
000c54  4604              MOV      r4,r0
000c56  460d              MOV      r5,r1
;;;1600       COM_9511UpStByExitP();
000c58  f7fffffe          BL       COM_9511UpStByExitP
;;;1601   	COM_9511SetGreALL(0,0);
000c5c  2100              MOVS     r1,#0
000c5e  4608              MOV      r0,r1
000c60  f7fffffe          BL       COM_9511SetGreALL
;;;1602   }
000c64  bd70              POP      {r4-r6,pc}
;;;1603   
                          ENDP

                  COM_9511UpStByEnterP PROC
;;;1960   /// 因进入补绣而改变状态，是被命令函数调用的，
;;;1961   static  void  COM_9511UpStByEnterP (void)
000c66  b510              PUSH     {r4,lr}
;;;1962   {
;;;1963       u32     i;
;;;1964       
;;;1965       
;;;1966       for (i = 0; i < BSP_DEVICE_ID_N; i++) {
000c68  2400              MOVS     r4,#0
000c6a  e01c              B        |L1.3238|
                  |L1.3180|
;;;1967           switch (COM_UpStNow[i]) {
000c6c  482e              LDR      r0,|L1.3368|
000c6e  5d00              LDRB     r0,[r0,r4]
000c70  b120              CBZ      r0,|L1.3196|
000c72  2801              CMP      r0,#1
000c74  d007              BEQ      |L1.3206|
000c76  2802              CMP      r0,#2
000c78  d10f              BNE      |L1.3226|
000c7a  e009              B        |L1.3216|
                  |L1.3196|
;;;1968           case COM_UP_ST_LOCK:
;;;1969               COM_9511UpStChange((BSP_ID_TypeDef)i, COM_UP_ST_PATCH_LOCK);//这个函数只改变了LED和金片板的LED状态，没有改变针高。
000c7c  2103              MOVS     r1,#3
000c7e  b2e0              UXTB     r0,r4
000c80  f7fffffe          BL       COM_9511UpStChange
;;;1970               break;
000c84  e00a              B        |L1.3228|
                  |L1.3206|
;;;1971           case COM_UP_ST_NORMAL:
;;;1972               COM_9511UpStChange((BSP_ID_TypeDef)i, COM_UP_ST_PATCH_IDLE);
000c86  2104              MOVS     r1,#4
000c88  b2e0              UXTB     r0,r4
000c8a  f7fffffe          BL       COM_9511UpStChange
;;;1973               break;
000c8e  e005              B        |L1.3228|
                  |L1.3216|
;;;1974           case COM_UP_ST_BROKEN:
;;;1975   //            COM_9511UpStChange((BSP_ID_TypeDef)i, COM_UP_ST_PATCH_NORMAL);    !!! cy 100904
;;;1976               COM_9511UpStChange((BSP_ID_TypeDef)i, COM_UP_ST_PATCH_BROKEN);
000c90  2106              MOVS     r1,#6
000c92  b2e0              UXTB     r0,r4
000c94  f7fffffe          BL       COM_9511UpStChange
;;;1977               break;
000c98  e000              B        |L1.3228|
                  |L1.3226|
;;;1978           default:                                /// 其他状态不变
;;;1979               break;
000c9a  bf00              NOP      
                  |L1.3228|
000c9c  bf00              NOP                            ;1970
;;;1980           }
;;;1981   		COM_9511TangkongPatch[i]=2;
000c9e  2002              MOVS     r0,#2
000ca0  492a              LDR      r1,|L1.3404|
000ca2  5508              STRB     r0,[r1,r4]
000ca4  1c64              ADDS     r4,r4,#1              ;1966
                  |L1.3238|
000ca6  2c02              CMP      r4,#2                 ;1966
000ca8  d3e0              BCC      |L1.3180|
;;;1982       }
;;;1983   }
000caa  bd10              POP      {r4,pc}
;;;1984   
                          ENDP

                  COM_9511PatchEnter PROC
;;;1603   
;;;1604   static  void  COM_9511PatchEnter (u16 buf[], u8 len) //进入补绣
000cac  b570              PUSH     {r4-r6,lr}
;;;1605   {
000cae  4604              MOV      r4,r0
000cb0  460d              MOV      r5,r1
;;;1606       COM_9511UpStByEnterP();	//这个函数只是改变了上机头的状态，没有改变机头电机的高度，为什么？
000cb2  f7fffffe          BL       COM_9511UpStByEnterP
;;;1607   }
000cb6  bd70              POP      {r4-r6,pc}
;;;1608   
                          ENDP

                  COM_9511GetHDLed PROC
;;;1610   /// ?红-断线，绿-参与刺绣
;;;1611   static  void  COM_9511GetHDLed (u16 buf[], u8 len)
000cb8  e92d41f0          PUSH     {r4-r8,lr}
;;;1612   {
000cbc  4606              MOV      r6,r0
000cbe  460f              MOV      r7,r1
;;;1613   
;;;1614   
;;;1615       u16     rt;
;;;1616       
;;;1617       
;;;1618       rt  =   COM_9511EmbStToBit(COM_GetEmbSt(BSP_ID_ODD))  << 4;
000cc0  2000              MOVS     r0,#0
000cc2  f7fffffe          BL       COM_GetEmbSt
000cc6  4605              MOV      r5,r0
000cc8  f7fffffe          BL       COM_9511EmbStToBit
000ccc  0500              LSLS     r0,r0,#20
000cce  0c04              LSRS     r4,r0,#16
;;;1619       rt |=   COM_9511EmbStToBit(COM_GetEmbSt(BSP_ID_EVEN)) << 0;
000cd0  2001              MOVS     r0,#1
000cd2  f7fffffe          BL       COM_GetEmbSt
000cd6  4605              MOV      r5,r0
000cd8  f7fffffe          BL       COM_9511EmbStToBit
000cdc  4304              ORRS     r4,r4,r0
;;;1620       
;;;1621       C491_SendOne(rt, 0);
000cde  2100              MOVS     r1,#0
000ce0  4620              MOV      r0,r4
000ce2  f7fffffe          BL       C491_SendOne
;;;1622   }
000ce6  e8bd81f0          POP      {r4-r8,pc}
;;;1623   
                          ENDP

                  COM_9511MAOrgIn PROC
;;;1625   
;;;1626   static  void  COM_9511MAOrgIn (u16 buf[], u8 len)
000cea  b570              PUSH     {r4-r6,lr}
;;;1627   {
000cec  4605              MOV      r5,r0
000cee  460e              MOV      r6,r1
;;;1628       u32     i;
;;;1629       
;;;1630       
;;;1631       COM_9511MAIsInOrg   =   TRUE;
000cf0  2001              MOVS     r0,#1
000cf2  4911              LDR      r1,|L1.3384|
000cf4  7008              STRB     r0,[r1,#0]
;;;1632       
;;;1633   //    COM_AllUpdate();
;;;1634       for (i = 0; i < BSP_DEVICE_ID_N; i++) {
000cf6  2400              MOVS     r4,#0
000cf8  e00b              B        |L1.3346|
                  |L1.3322|
;;;1635   //        COM_HghUpdate((BSP_ID_TypeDef)i);
;;;1636            if (COM_IsHghRest == FALSE) {           /// 为安全上电后针高不动, 直到有主控命令或开关变化
000cfa  4812              LDR      r0,|L1.3396|
000cfc  7800              LDRB     r0,[r0,#0]  ; COM_IsHghRest
000cfe  b938              CBNZ     r0,|L1.3344|
;;;1637               
;;;1638   /// cy  110304
;;;1639   //            COM_HghUpdate((BSP_ID_TypeDef)i);
;;;1640               if (COM_HghIsAim[i] == FALSE) {
000d00  4813              LDR      r0,|L1.3408|
000d02  5d00              LDRB     r0,[r0,r4]
000d04  b920              CBNZ     r0,|L1.3344|
;;;1641                   COM_HghIsAim[i] =   COM_HghUpdate((BSP_ID_TypeDef)i);
000d06  b2e0              UXTB     r0,r4
000d08  f7fffffe          BL       COM_HghUpdate
000d0c  4910              LDR      r1,|L1.3408|
000d0e  5508              STRB     r0,[r1,r4]
                  |L1.3344|
000d10  1c64              ADDS     r4,r4,#1              ;1634
                  |L1.3346|
000d12  2c02              CMP      r4,#2                 ;1634
000d14  d3f1              BCC      |L1.3322|
;;;1642               }
;;;1643   /// cy  110304
;;;1644   
;;;1645           }
;;;1646       }
;;;1647   }
000d16  bd70              POP      {r4-r6,pc}
;;;1648   
                          ENDP

                  COM_9511UpStByMARun PROC
;;;1985   /// 因主轴转动而改变状态
;;;1986   static  void  COM_9511UpStByMARun (void)
000d18  b510              PUSH     {r4,lr}
;;;1987   {
;;;1988       u32     i;
;;;1989       
;;;1990       
;;;1991       for (i = 0; i < BSP_DEVICE_ID_N; i++) {
000d1a  2400              MOVS     r4,#0
000d1c  e02e              B        |L1.3452|
000d1e  0000              DCW      0x0000
                  |L1.3360|
                          DCD      COM_IsFault
                  |L1.3364|
                          DCD      COM_DnIsEnable
                  |L1.3368|
                          DCD      COM_UpStNow
                  |L1.3372|
                          DCD      COM_9511IsTset
                  |L1.3376|
                          DCD      COM_Tangkong_WorkHigh
                  |L1.3380|
                          DCD      COM_Tangkong_WorkHigh_Last
                  |L1.3384|
                          DCD      COM_9511MAIsInOrg
                  |L1.3388|
                          DCD      COM_9511MAIsRunning
                  |L1.3392|
                          DCD      COM_WorkHigh
                  |L1.3396|
                          DCD      COM_IsHghRest
                  |L1.3400|
                          DCD      COM_UpStLast
                  |L1.3404|
                          DCD      COM_9511TangkongPatch
                  |L1.3408|
                          DCD      COM_HghIsAim
                  |L1.3412|
;;;1992           switch (COM_UpStNow[i]) {
000d54  48fc              LDR      r0,|L1.4424|
000d56  5d00              LDRB     r0,[r0,r4]
000d58  2802              CMP      r0,#2
000d5a  d002              BEQ      |L1.3426|
000d5c  2806              CMP      r0,#6
000d5e  d10a              BNE      |L1.3446|
000d60  e004              B        |L1.3436|
                  |L1.3426|
;;;1993           case COM_UP_ST_BROKEN:
;;;1994               COM_9511UpStChange((BSP_ID_TypeDef)i, COM_UP_ST_NORMAL);
000d62  2101              MOVS     r1,#1
000d64  b2e0              UXTB     r0,r4
000d66  f7fffffe          BL       COM_9511UpStChange
;;;1995               break;
000d6a  e005              B        |L1.3448|
                  |L1.3436|
;;;1996           case COM_UP_ST_PATCH_BROKEN:
;;;1997               COM_9511UpStChange((BSP_ID_TypeDef)i, COM_UP_ST_PATCH_NORMAL);
000d6c  2105              MOVS     r1,#5
000d6e  b2e0              UXTB     r0,r4
000d70  f7fffffe          BL       COM_9511UpStChange
;;;1998               break;
000d74  e000              B        |L1.3448|
                  |L1.3446|
;;;1999           default:                                /// 其他状态不变
;;;2000               break;
000d76  bf00              NOP      
                  |L1.3448|
000d78  bf00              NOP                            ;1995
000d7a  1c64              ADDS     r4,r4,#1              ;1991
                  |L1.3452|
000d7c  2c02              CMP      r4,#2                 ;1991
000d7e  d3e9              BCC      |L1.3412|
;;;2001           }
;;;2002       }
;;;2003   }
000d80  bd10              POP      {r4,pc}
;;;2004   
                          ENDP

                  COM_9511MAStartUp PROC
;;;1652   /// 因为处理断线检测信息, 所以对下机头有效
;;;1653   static  void  COM_9511MAStartUp (u16 buf[], u8 len)
000d82  b570              PUSH     {r4-r6,lr}
;;;1654   {
000d84  4605              MOV      r5,r0
000d86  460e              MOV      r6,r1
;;;1655       u32     i;
;;;1656       
;;;1657       COM_9511MAIsInOrg   =   FALSE;
000d88  2000              MOVS     r0,#0
000d8a  49f0              LDR      r1,|L1.4428|
000d8c  7008              STRB     r0,[r1,#0]
;;;1658       COM_9511MAIsRunning =   TRUE; 
000d8e  2001              MOVS     r0,#1
000d90  49ef              LDR      r1,|L1.4432|
000d92  7008              STRB     r0,[r1,#0]
;;;1659       if (BSP_DIP_BDFunc == BSP_DIP_BD_FUNC_UP) {//上机头
000d94  48ef              LDR      r0,|L1.4436|
000d96  7800              LDRB     r0,[r0,#0]  ; BSP_DIP_BDFunc
000d98  b968              CBNZ     r0,|L1.3510|
;;;1660          // COM_9511MAIsInOrg   =   FALSE;
;;;1661          // COM_9511MAIsRunning =   TRUE;               /// cy  101115  added
;;;1662           
;;;1663           COM_9511UpStByMARun();
000d9a  f7fffffe          BL       COM_9511UpStByMARun
;;;1664           
;;;1665           for (i = 0; i < BSP_DEVICE_ID_N; i++) {
000d9e  2400              MOVS     r4,#0
000da0  e007              B        |L1.3506|
                  |L1.3490|
;;;1666               if (COM_IsFault[i] == FALSE) {
000da2  48ed              LDR      r0,|L1.4440|
000da4  5d00              LDRB     r0,[r0,r4]
000da6  b918              CBNZ     r0,|L1.3504|
;;;1667   
;;;1668                   HDLED_Sparkle((BSP_ID_TypeDef)i, 3);
000da8  2103              MOVS     r1,#3
000daa  b2e0              UXTB     r0,r4
000dac  f7fffffe          BL       HDLED_Sparkle
                  |L1.3504|
000db0  1c64              ADDS     r4,r4,#1              ;1665
                  |L1.3506|
000db2  2c02              CMP      r4,#2                 ;1665
000db4  d3f5              BCC      |L1.3490|
                  |L1.3510|
;;;1669   
;;;1670               }
;;;1671           }
;;;1672       }
;;;1673       
;;;1674       /// 断线检测信息处理
;;;1675       IN_BRK_SampleBegin();
000db6  f7fffffe          BL       IN_BRK_SampleBegin
;;;1676   }
000dba  bd70              POP      {r4-r6,pc}
;;;1677   
                          ENDP

                  COM_9511MAStop PROC
;;;1678   /// 不处理主轴信息, 处理断线检测信息
;;;1679   static  void  COM_9511MAStop (u16 buf[], u8 len)//0xfd主轴停车的命令
000dbc  b570              PUSH     {r4-r6,lr}
;;;1680   {
000dbe  4604              MOV      r4,r0
000dc0  460d              MOV      r5,r1
;;;1681       COM_9511MAIsRunning =   FALSE;          /// cy  101115  added
000dc2  2000              MOVS     r0,#0
000dc4  49e2              LDR      r1,|L1.4432|
000dc6  7008              STRB     r0,[r1,#0]
;;;1682       
;;;1683       /// 断线检测信息处理
;;;1684       IN_BRK_SampleStop();
000dc8  f7fffffe          BL       IN_BRK_SampleStop
;;;1685   }
000dcc  bd70              POP      {r4-r6,pc}
;;;1686   
                          ENDP

                  COM_XJ_3 PROC
;;;1687   static  void  COM_XJ_3 (void)
000dce  b510              PUSH     {r4,lr}
;;;1688   {
;;;1689     /*  static  u32  i = 0;
;;;1690       
;;;1691       
;;;1692       i++;
;;;1693       if (i == 3) {
;;;1694           i = 0; */
;;;1695           IN_BRK_SentXJ();
000dd0  f7fffffe          BL       IN_BRK_SentXJ
;;;1696      // }
;;;1697   }
000dd4  bd10              POP      {r4,pc}
;;;1698   //线夹命令0xFF。因为只有主控发了线夹信号才会改变IN_BrkIsBroken[i]的值，主控程序运行中没有看到这个发线夹命令？   
                          ENDP

                  COM_9511BrkDetect PROC
;;;1699   static  void  COM_9511BrkDetect (u16 buf[], u8 len)//在emb函数中有SendDJtoHead的宏定义，所以是有发断检信号的。在断线测试中是自己连发了三次0xFF
000dd6  b570              PUSH     {r4-r6,lr}
;;;1700   {
000dd8  4605              MOV      r5,r0
000dda  460e              MOV      r6,r1
;;;1701   
;;;1702       u32                 i;
;;;1703       COM_9511MAIsInOrg   =   FALSE;
000ddc  2000              MOVS     r0,#0
000dde  49db              LDR      r1,|L1.4428|
000de0  7008              STRB     r0,[r1,#0]
;;;1704       COM_9511MAIsRunning =   TRUE; 
000de2  2001              MOVS     r0,#1
000de4  49da              LDR      r1,|L1.4432|
000de6  7008              STRB     r0,[r1,#0]
;;;1705       
;;;1706       if (BSP_DIP_BDFunc == BSP_DIP_BD_FUNC_UP) {//上机头
000de8  48da              LDR      r0,|L1.4436|
000dea  7800              LDRB     r0,[r0,#0]  ; BSP_DIP_BDFunc
000dec  b9a0              CBNZ     r0,|L1.3608|
;;;1707          // COM_9511MAIsInOrg   =   FALSE;
;;;1708          // COM_9511MAIsRunning =   TRUE;               /// cy  101115  added
;;;1709           
;;;1710   /// cy  110226  modify
;;;1711   //        COM_9511UpStByMARun();                      /// 清断线状态
;;;1712   /// cy  110226  modify
;;;1713   
;;;1714   /// cy  110227  modify        
;;;1715   //        IN_BRK_SentXJ();
;;;1716           COM_XJ_3();
000dee  f7fffffe          BL       COM_XJ_3
;;;1717   /// cy  110227  modify
;;;1718       
;;;1719           for (i = 0; i < BSP_DEVICE_ID_N; i++) {
000df2  2400              MOVS     r4,#0
000df4  e00d              B        |L1.3602|
                  |L1.3574|
;;;1720   /// !!! cy 100905
;;;1721   //            if (   (COM_IsFault[i] == FALSE)        /// ! 可有可无
;;;1722   //                && (COM_GetIsDrop(COM_UpStNow[i]) == TRUE)
;;;1723   //                && (IN_BRK_GetIsBrk((BSP_ID_TypeDef)i) != FALSE)   ) {
;;;1724               if (   (COM_GetIsDrop(COM_UpStNow[i]) == TRUE)
000df6  49d4              LDR      r1,|L1.4424|
000df8  5d08              LDRB     r0,[r1,r4]
000dfa  f7fffffe          BL       COM_GetIsDrop
000dfe  2801              CMP      r0,#1
000e00  d106              BNE      |L1.3600|
;;;1725                   	&& (IN_BRK_GetIsBrk((BSP_ID_TypeDef)i) != FALSE)   ) { //读取IN_BrkIsBroken[i]上机头检查到了断线
000e02  b2e0              UXTB     r0,r4
000e04  f7fffffe          BL       IN_BRK_GetIsBrk
000e08  b110              CBZ      r0,|L1.3600|
;;;1726   /// !!! cy 100905
;;;1727                   		COM_9511UpStByBroken((BSP_ID_TypeDef)i);//更新上机头灯
000e0a  b2e0              UXTB     r0,r4
000e0c  f7fffffe          BL       COM_9511UpStByBroken
                  |L1.3600|
000e10  1c64              ADDS     r4,r4,#1              ;1719
                  |L1.3602|
000e12  2c02              CMP      r4,#2                 ;1719
000e14  d3ef              BCC      |L1.3574|
000e16  e001              B        |L1.3612|
                  |L1.3608|
;;;1728               }
;;;1729           }
;;;1730       } else {//下机头
;;;1731   /// cy  110227  modify
;;;1732   //        IN_BRK_SentXJ();
;;;1733           COM_XJ_3();//这个函数里面调用IN_BRK_SendXJ函数，给IN_BrkIsBroken[i]变量赋值
000e18  f7fffffe          BL       COM_XJ_3
                  |L1.3612|
;;;1734   /// cy  110227  modify
;;;1735       }
;;;1736       
;;;1737   
;;;1738   }
000e1c  bd70              POP      {r4-r6,pc}
;;;1739   
                          ENDP

                  COM_Get9511DnStatus PROC
;;;1740   
;;;1741   static  u16  COM_Get9511DnStatus (void)
000e1e  b57c              PUSH     {r2-r6,lr}
;;;1742   {
;;;1743       MOTO_ST_TypeDef     MotoSt[BSP_DEVICE_ID_N];
;;;1744       bool                broken[BSP_DEVICE_ID_N];
;;;1745       u32                 i;
;;;1746       u16                 rt;
;;;1747       
;;;1748       
;;;1749       for (i = 0; i < BSP_DEVICE_ID_N; i++) {
000e20  2500              MOVS     r5,#0
000e22  e018              B        |L1.3670|
                  |L1.3620|
;;;1750           if ((COM_IsFault[i] == FALSE) && (COM_DnIsEnable[i] == TRUE)) {
000e24  48cc              LDR      r0,|L1.4440|
000e26  5d40              LDRB     r0,[r0,r5]
000e28  b970              CBNZ     r0,|L1.3656|
000e2a  48cc              LDR      r0,|L1.4444|
000e2c  5d40              LDRB     r0,[r0,r5]
000e2e  2801              CMP      r0,#1
000e30  d10a              BNE      |L1.3656|
;;;1751               MotoSt[i]   =   MOTO_CutGetState((BSP_ID_TypeDef)i);
000e32  b2e8              UXTB     r0,r5
000e34  f7fffffe          BL       MOTO_CutGetState
000e38  a901              ADD      r1,sp,#4
000e3a  5548              STRB     r0,[r1,r5]
;;;1752               broken[i]   =   IN_BRK_GetIsBrk((BSP_ID_TypeDef)i);
000e3c  b2e8              UXTB     r0,r5
000e3e  f7fffffe          BL       IN_BRK_GetIsBrk
000e42  f80d0005          STRB     r0,[sp,r5]
000e46  e005              B        |L1.3668|
                  |L1.3656|
;;;1753           } else {
;;;1754               MotoSt[i]   =   MOTO_ST_OK;
000e48  2005              MOVS     r0,#5
000e4a  a901              ADD      r1,sp,#4
000e4c  5548              STRB     r0,[r1,r5]
;;;1755               broken[i]   =   FALSE;
000e4e  2000              MOVS     r0,#0
000e50  f80d0005          STRB     r0,[sp,r5]
                  |L1.3668|
000e54  1c6d              ADDS     r5,r5,#1              ;1749
                  |L1.3670|
000e56  2d02              CMP      r5,#2                 ;1749
000e58  d3e4              BCC      |L1.3620|
;;;1756           }
;;;1757       }
;;;1758       
;;;1759       if ((MotoSt[BSP_ID_ODD] == MOTO_ST_ACTING) || (MotoSt[BSP_ID_EVEN] == MOTO_ST_ACTING)) {
000e5a  f89d0004          LDRB     r0,[sp,#4]
000e5e  b110              CBZ      r0,|L1.3686|
000e60  f89d0005          LDRB     r0,[sp,#5]
000e64  b908              CBNZ     r0,|L1.3690|
                  |L1.3686|
;;;1760           rt  =   COM_8_RES_BUSY;                 /// ?
000e66  2412              MOVS     r4,#0x12
000e68  e046              B        |L1.3832|
                  |L1.3690|
;;;1761       } else if ((MotoSt[BSP_ID_ODD]  == MOTO_ST_PRO) || (MotoSt[BSP_ID_ODD]  == MOTO_ST_OVTIME)) {
000e6a  f89d0004          LDRB     r0,[sp,#4]
000e6e  2801              CMP      r0,#1
000e70  d003              BEQ      |L1.3706|
000e72  f89d0004          LDRB     r0,[sp,#4]
000e76  2802              CMP      r0,#2
000e78  d101              BNE      |L1.3710|
                  |L1.3706|
;;;1762           rt  =   COM_8_RES_ODD_OVERTIM;          /// ???
000e7a  2431              MOVS     r4,#0x31
000e7c  e03c              B        |L1.3832|
                  |L1.3710|
;;;1763       } else if ((MotoSt[BSP_ID_EVEN] == MOTO_ST_PRO) || (MotoSt[BSP_ID_EVEN] == MOTO_ST_OVTIME)) {
000e7e  f89d0005          LDRB     r0,[sp,#5]
000e82  2801              CMP      r0,#1
000e84  d003              BEQ      |L1.3726|
000e86  f89d0005          LDRB     r0,[sp,#5]
000e8a  2802              CMP      r0,#2
000e8c  d101              BNE      |L1.3730|
                  |L1.3726|
;;;1764           rt  =   COM_8_RES_EVE_OVERTIM;          /// ???
000e8e  2430              MOVS     r4,#0x30
000e90  e032              B        |L1.3832|
                  |L1.3730|
;;;1765       } else if  (MotoSt[BSP_ID_ODD]  == MOTO_ST_CUTLOOPER) {
000e92  f89d0004          LDRB     r0,[sp,#4]
000e96  2803              CMP      r0,#3
000e98  d101              BNE      |L1.3742|
;;;1766           rt  =   COM_8_RES_ODD_KEYERR;           /// ???
000e9a  2421              MOVS     r4,#0x21
000e9c  e02c              B        |L1.3832|
                  |L1.3742|
;;;1767       } else if  (MotoSt[BSP_ID_EVEN] == MOTO_ST_CUTLOOPER) {
000e9e  f89d0005          LDRB     r0,[sp,#5]
000ea2  2803              CMP      r0,#3
000ea4  d101              BNE      |L1.3754|
;;;1768           rt  =   COM_8_RES_EVE_KEYERR;           /// ???
000ea6  2420              MOVS     r4,#0x20
000ea8  e026              B        |L1.3832|
                  |L1.3754|
;;;1769       } else if ((broken[BSP_ID_ODD] == TRUE) && (broken[BSP_ID_EVEN] == TRUE) && (COM_9511MAIsRunning != FALSE)) {
000eaa  f89d0000          LDRB     r0,[sp,#0]
000eae  2801              CMP      r0,#1
000eb0  d108              BNE      |L1.3780|
000eb2  f89d0001          LDRB     r0,[sp,#1]
000eb6  2801              CMP      r0,#1
000eb8  d104              BNE      |L1.3780|
000eba  48a5              LDR      r0,|L1.4432|
000ebc  7800              LDRB     r0,[r0,#0]  ; COM_9511MAIsRunning
000ebe  b108              CBZ      r0,|L1.3780|
;;;1770           rt  =   COM_8_RES_ALL_BREAK;            /// ???
000ec0  2413              MOVS     r4,#0x13
000ec2  e019              B        |L1.3832|
                  |L1.3780|
;;;1771       } else if ((broken[BSP_ID_ODD] == TRUE) && (COM_9511MAIsRunning != FALSE)) {
000ec4  f89d0000          LDRB     r0,[sp,#0]
000ec8  2801              CMP      r0,#1
000eca  d104              BNE      |L1.3798|
000ecc  48a0              LDR      r0,|L1.4432|
000ece  7800              LDRB     r0,[r0,#0]  ; COM_9511MAIsRunning
000ed0  b108              CBZ      r0,|L1.3798|
;;;1772           rt  =   COM_8_RES_ODD_BREAK;            /// ???
000ed2  2451              MOVS     r4,#0x51
000ed4  e010              B        |L1.3832|
                  |L1.3798|
;;;1773       } else if ((broken[BSP_ID_EVEN] == TRUE) && (COM_9511MAIsRunning != FALSE)) {
000ed6  f89d0001          LDRB     r0,[sp,#1]
000eda  2801              CMP      r0,#1
000edc  d104              BNE      |L1.3816|
000ede  489c              LDR      r0,|L1.4432|
000ee0  7800              LDRB     r0,[r0,#0]  ; COM_9511MAIsRunning
000ee2  b108              CBZ      r0,|L1.3816|
;;;1774           rt  =   COM_8_RES_EVE_BREAK;            /// ???
000ee4  2450              MOVS     r4,#0x50
000ee6  e007              B        |L1.3832|
                  |L1.3816|
;;;1775       } else if  (COM_9511CheckErr == TRUE) {
000ee8  489d              LDR      r0,|L1.4448|
000eea  7800              LDRB     r0,[r0,#0]  ; COM_9511CheckErr
000eec  2801              CMP      r0,#1
000eee  d101              BNE      |L1.3828|
;;;1776           rt  =   COM_8_RES_DAT_ERR;              /// ??????
000ef0  2416              MOVS     r4,#0x16
000ef2  e001              B        |L1.3832|
                  |L1.3828|
;;;1777       } else {
;;;1778           rt  =   BSP_DIP_9511Addr;               /// ??
000ef4  489b              LDR      r0,|L1.4452|
000ef6  7804              LDRB     r4,[r0,#0]  ; BSP_DIP_9511Addr
                  |L1.3832|
;;;1779       }
;;;1780       
;;;1781       return  rt;
000ef8  4620              MOV      r0,r4
;;;1782   }
000efa  bd7c              POP      {r2-r6,pc}
;;;1783   
                          ENDP

                  COM_9511GetCutOrg PROC
;;;1784   static  void  COM_9511GetCutOrg (u16 buf[], u8 len)
000efc  b570              PUSH     {r4-r6,lr}
;;;1785   {
000efe  4605              MOV      r5,r0
000f00  460e              MOV      r6,r1
;;;1786      u16     rt;
;;;1787       
;;;1788   /// 110905
;;;1789   //    if (   ((COM_IsFault[BSP_ID_ODD]  == FALSE) && (MOTO_CutGetIsActing(BSP_ID_ODD)  != FALSE))
;;;1790   //        || ((COM_IsFault[BSP_ID_EVEN] == FALSE) && (MOTO_CutGetIsActing(BSP_ID_EVEN) != FALSE))   ) {
;;;1791   //        rt  =   COM_8_RES_BUSY;
;;;1792   //    } else if ((COM_IsFault[BSP_ID_ODD]  == FALSE) && (BSP_SWI_FiGet(BSP_ID_ODD)  != BSP_SWITCH_LOW)) {
;;;1793   //        rt  =   COM_8_RES_ODD_NOTPOS;
;;;1794   //    } else if ((COM_IsFault[BSP_ID_EVEN] == FALSE) && (BSP_SWI_FiGet(BSP_ID_EVEN) != BSP_SWITCH_LOW)) {
;;;1795   //        rt  =   COM_8_RES_EVE_NOTPOS;
;;;1796   //    } else {
;;;1797   //        rt  =   BSP_DIP_9511Addr;
;;;1798   //    }
;;;1799       rt  =   COM_Get9511DnStatus();          /// ????
000f02  f7fffffe          BL       COM_Get9511DnStatus
000f06  4604              MOV      r4,r0
;;;1800       if (rt == BSP_DIP_9511Addr) {           /// ?????, ??????
000f08  4896              LDR      r0,|L1.4452|
000f0a  7800              LDRB     r0,[r0,#0]  ; BSP_DIP_9511Addr
000f0c  4284              CMP      r4,r0
000f0e  d112              BNE      |L1.3894|
;;;1801           if ((COM_IsFault[BSP_ID_ODD]  == FALSE) && (BSP_SWI_FiGet(BSP_ID_ODD)  != BSP_SWITCH_LOW)) {
000f10  4891              LDR      r0,|L1.4440|
000f12  7800              LDRB     r0,[r0,#0]  ; COM_IsFault
000f14  b930              CBNZ     r0,|L1.3876|
000f16  2000              MOVS     r0,#0
000f18  f7fffffe          BL       BSP_SWI_FiGet
000f1c  2801              CMP      r0,#1
000f1e  d001              BEQ      |L1.3876|
;;;1802               rt  =   COM_8_RES_ODD_NOTPOS;
000f20  2461              MOVS     r4,#0x61
000f22  e008              B        |L1.3894|
                  |L1.3876|
;;;1803           } else if ((COM_IsFault[BSP_ID_EVEN] == FALSE) && (BSP_SWI_FiGet(BSP_ID_EVEN) != BSP_SWITCH_LOW)) {
000f24  488c              LDR      r0,|L1.4440|
000f26  7840              LDRB     r0,[r0,#1]  ; COM_IsFault
000f28  b928              CBNZ     r0,|L1.3894|
000f2a  2001              MOVS     r0,#1
000f2c  f7fffffe          BL       BSP_SWI_FiGet
000f30  2801              CMP      r0,#1
000f32  d000              BEQ      |L1.3894|
;;;1804               rt  =   COM_8_RES_EVE_NOTPOS;
000f34  2460              MOVS     r4,#0x60
                  |L1.3894|
;;;1805           }
;;;1806       }
;;;1807   /// 110905
;;;1808       
;;;1809       C491_SendOne(rt, 0);
000f36  2100              MOVS     r1,#0
000f38  4620              MOV      r0,r4
000f3a  f7fffffe          BL       C491_SendOne
;;;1810   }
000f3e  bd70              POP      {r4-r6,pc}
;;;1811   
                          ENDP

                  COM_9511GetDnErr PROC
;;;1812   static  void  COM_9511GetDnErr (u16 buf[], u8 len)
000f40  b570              PUSH     {r4-r6,lr}
;;;1813   {
000f42  4605              MOV      r5,r0
000f44  460e              MOV      r6,r1
;;;1814   
;;;1815       
;;;1816       u16     rt;
;;;1817       
;;;1818       
;;;1819       rt  =   COM_Get9511DnStatus();
000f46  f7fffffe          BL       COM_Get9511DnStatus
000f4a  4604              MOV      r4,r0
;;;1820   /// cy  110905
;;;1821       
;;;1822       C491_SendOne(rt, 0);
000f4c  2100              MOVS     r1,#0
000f4e  4620              MOV      r0,r4
000f50  f7fffffe          BL       C491_SendOne
;;;1823   
;;;1824   }
000f54  bd70              POP      {r4-r6,pc}
;;;1825   
                          ENDP

                  COM_9511GetUpErr PROC
;;;1826   static  void  COM_9511GetUpErr (u16 buf[], u8 len)
000f56  e92d41ff          PUSH     {r0-r8,lr}
;;;1827   {
000f5a  4606              MOV      r6,r0
000f5c  460f              MOV      r7,r1
;;;1828       MOTO_ST_TypeDef     MotoSt[BSP_DEVICE_ID_N];
;;;1829   //    bool                broken[BSP_DEVICE_ID_N];        /// !!! cy 100904
;;;1830       bool                broken[BSP_DEVICE_ID_N];        /// !!! cy 100905
;;;1831       bool                KeyErr[BSP_DEVICE_ID_N];
;;;1832       bool                HghErr[BSP_DEVICE_ID_N];
;;;1833       u32                 i;
;;;1834       u16                 rt;
;;;1835       
;;;1836       
;;;1837       for (i = 0; i < BSP_DEVICE_ID_N; i++) {
000f5e  2400              MOVS     r4,#0
000f60  e031              B        |L1.4038|
                  |L1.3938|
;;;1838           if (COM_IsFault[i] == FALSE) {
000f62  487d              LDR      r0,|L1.4440|
000f64  5d00              LDRB     r0,[r0,r4]
000f66  bb18              CBNZ     r0,|L1.4016|
;;;1839               MotoSt[i]   =   MOTO_HghGetState((BSP_ID_TypeDef)i);
000f68  b2e0              UXTB     r0,r4
000f6a  f7fffffe          BL       MOTO_HghGetState
000f6e  a903              ADD      r1,sp,#0xc
000f70  5508              STRB     r0,[r1,r4]
;;;1840   /// !!! cy 100905
;;;1841   /// !!! cy 100904
;;;1842   //            if (COM_UpStBits[COM_UpStNow[i]] & (1 << COM_UP_BIT_IS_DROP)) {
;;;1843   //                broken[i]   =   IN_BRK_GetIsBrk((BSP_ID_TypeDef)i);
;;;1844   //            } else {
;;;1845   //                broken[i]   =   FALSE;
;;;1846   //            }
;;;1847   /// !!! cy 100904
;;;1848               broken[i]   =   COM_GetIsBroken(COM_UpStNow[i]);//通过判断上机头的状态来的
000f72  4975              LDR      r1,|L1.4424|
000f74  5d08              LDRB     r0,[r1,r4]
000f76  f7fffffe          BL       COM_GetIsBroken
000f7a  a902              ADD      r1,sp,#8
000f7c  5508              STRB     r0,[r1,r4]
;;;1849   /// !!! cy 100905和IN_BRK_GetIsBrk不同，它是根据采样值来的
;;;1850               if (IN_HDKey_GetSt((BSP_ID_TypeDef)i) == HDKEY_ST_ERR) {
000f7e  b2e0              UXTB     r0,r4
000f80  f7fffffe          BL       IN_HDKey_GetSt
000f84  2803              CMP      r0,#3
000f86  d103              BNE      |L1.3984|
;;;1851                   KeyErr[i]   =   TRUE;
000f88  2001              MOVS     r0,#1
000f8a  a901              ADD      r1,sp,#4
000f8c  5508              STRB     r0,[r1,r4]
000f8e  e002              B        |L1.3990|
                  |L1.3984|
;;;1852               } else {
;;;1853                   KeyErr[i]   =   FALSE;
000f90  2000              MOVS     r0,#0
000f92  a901              ADD      r1,sp,#4
000f94  5508              STRB     r0,[r1,r4]
                  |L1.3990|
;;;1854               }
;;;1855               if (MOTO_HghGetHeight((BSP_ID_TypeDef)i) == MOTO_HGH_POS_ERR) {
000f96  b2e0              UXTB     r0,r4
000f98  f7fffffe          BL       MOTO_HghGetHeight
000f9c  280b              CMP      r0,#0xb
000f9e  d103              BNE      |L1.4008|
;;;1856                   HghErr[i]   =   TRUE;
000fa0  2001              MOVS     r0,#1
000fa2  f80d0004          STRB     r0,[sp,r4]
000fa6  e00d              B        |L1.4036|
                  |L1.4008|
;;;1857               } else {
;;;1858                   HghErr[i]   =   FALSE;
000fa8  2000              MOVS     r0,#0
000faa  f80d0004          STRB     r0,[sp,r4]
000fae  e009              B        |L1.4036|
                  |L1.4016|
;;;1859               }
;;;1860           } else {
;;;1861               MotoSt[i]   =   MOTO_ST_OK;
000fb0  2005              MOVS     r0,#5
000fb2  a903              ADD      r1,sp,#0xc
000fb4  5508              STRB     r0,[r1,r4]
;;;1862   //            broken[i]   =   FALSE;                /// !!! cy 100904
;;;1863               broken[i]   =   FALSE;                /// !!! cy 100905
000fb6  2000              MOVS     r0,#0
000fb8  a902              ADD      r1,sp,#8
000fba  5508              STRB     r0,[r1,r4]
;;;1864               KeyErr[i]   =   FALSE;
000fbc  a901              ADD      r1,sp,#4
000fbe  5508              STRB     r0,[r1,r4]
;;;1865               HghErr[i]   =   FALSE;
000fc0  f80d0004          STRB     r0,[sp,r4]
                  |L1.4036|
000fc4  1c64              ADDS     r4,r4,#1              ;1837
                  |L1.4038|
000fc6  2c02              CMP      r4,#2                 ;1837
000fc8  d3cb              BCC      |L1.3938|
;;;1866           }
;;;1867           
;;;1868   /// !!! cy 100904
;;;1869   //        if (broken[i]) {
;;;1870   //            COM_9511UpStByBroken((BSP_ID_TypeDef)i);
;;;1871   //        }
;;;1872   /// !!! cy 100904
;;;1873       }
;;;1874       
;;;1875       if ((MotoSt[BSP_ID_ODD] == MOTO_ST_ACTING) || (MotoSt[BSP_ID_EVEN] == MOTO_ST_ACTING)) {
000fca  f89d000c          LDRB     r0,[sp,#0xc]
000fce  b110              CBZ      r0,|L1.4054|
000fd0  f89d000d          LDRB     r0,[sp,#0xd]
000fd4  b908              CBNZ     r0,|L1.4058|
                  |L1.4054|
;;;1876           rt  =   COM_8_RES_BUSY;                /// 忙
000fd6  2512              MOVS     r5,#0x12
000fd8  e059              B        |L1.4238|
                  |L1.4058|
;;;1877       } else if ((MotoSt[BSP_ID_ODD]  == MOTO_ST_PRO) || (MotoSt[BSP_ID_ODD]  == MOTO_ST_OVTIME)) {
000fda  f89d000c          LDRB     r0,[sp,#0xc]
000fde  2801              CMP      r0,#1
000fe0  d003              BEQ      |L1.4074|
000fe2  f89d000c          LDRB     r0,[sp,#0xc]
000fe6  2802              CMP      r0,#2
000fe8  d101              BNE      |L1.4078|
                  |L1.4074|
;;;1878           rt  =   COM_8_RES_ODD_OVERTIM;         /// 奇超时
000fea  2531              MOVS     r5,#0x31
000fec  e04f              B        |L1.4238|
                  |L1.4078|
;;;1879       } else if ((MotoSt[BSP_ID_EVEN] == MOTO_ST_PRO) || (MotoSt[BSP_ID_EVEN] == MOTO_ST_OVTIME)) {
000fee  f89d000d          LDRB     r0,[sp,#0xd]
000ff2  2801              CMP      r0,#1
000ff4  d003              BEQ      |L1.4094|
000ff6  f89d000d          LDRB     r0,[sp,#0xd]
000ffa  2802              CMP      r0,#2
000ffc  d101              BNE      |L1.4098|
                  |L1.4094|
;;;1880           rt  =   COM_8_RES_EVE_OVERTIM;         /// 偶超时
000ffe  2530              MOVS     r5,#0x30
001000  e045              B        |L1.4238|
                  |L1.4098|
;;;1881       } else if  (MotoSt[BSP_ID_ODD]  == MOTO_ST_REVERSE) {
001002  f89d000c          LDRB     r0,[sp,#0xc]
001006  2804              CMP      r0,#4
001008  d101              BNE      |L1.4110|
;;;1882           rt  =   COM_8_RES_ODD_REVERSE;         /// 奇反转
00100a  2541              MOVS     r5,#0x41
00100c  e03f              B        |L1.4238|
                  |L1.4110|
;;;1883       } else if  (MotoSt[BSP_ID_EVEN] == MOTO_ST_REVERSE) {
00100e  f89d000d          LDRB     r0,[sp,#0xd]
001012  2804              CMP      r0,#4
001014  d101              BNE      |L1.4122|
;;;1884           rt  =   COM_8_RES_EVE_REVERSE;         /// 偶反转
001016  2540              MOVS     r5,#0x40
001018  e039              B        |L1.4238|
                  |L1.4122|
;;;1885       } else if  (KeyErr[BSP_ID_ODD] == TRUE) {
00101a  f89d0004          LDRB     r0,[sp,#4]
00101e  2801              CMP      r0,#1
001020  d101              BNE      |L1.4134|
;;;1886           rt  =   COM_8_RES_ODD_KEYERR;          /// 奇开关坏
001022  2521              MOVS     r5,#0x21
001024  e033              B        |L1.4238|
                  |L1.4134|
;;;1887       } else if  (KeyErr[BSP_ID_EVEN] == TRUE) {
001026  f89d0005          LDRB     r0,[sp,#5]
00102a  2801              CMP      r0,#1
00102c  d101              BNE      |L1.4146|
;;;1888           rt  =   COM_8_RES_EVE_KEYERR;          /// 偶开关坏
00102e  2520              MOVS     r5,#0x20
001030  e02d              B        |L1.4238|
                  |L1.4146|
;;;1889       } else if ((broken[BSP_ID_ODD] == TRUE) && (COM_9511MAIsRunning != FALSE)) {
001032  f89d0008          LDRB     r0,[sp,#8]
001036  2801              CMP      r0,#1
001038  d104              BNE      |L1.4164|
00103a  4845              LDR      r0,|L1.4432|
00103c  7800              LDRB     r0,[r0,#0]  ; COM_9511MAIsRunning
00103e  b108              CBZ      r0,|L1.4164|
;;;1890           rt  =   COM_8_RES_ODD_BREAK;           /// 奇断线
001040  2551              MOVS     r5,#0x51
001042  e024              B        |L1.4238|
                  |L1.4164|
;;;1891       } else if ((broken[BSP_ID_EVEN] == TRUE) && (COM_9511MAIsRunning != FALSE)) {
001044  f89d0009          LDRB     r0,[sp,#9]
001048  2801              CMP      r0,#1
00104a  d104              BNE      |L1.4182|
00104c  4840              LDR      r0,|L1.4432|
00104e  7800              LDRB     r0,[r0,#0]  ; COM_9511MAIsRunning
001050  b108              CBZ      r0,|L1.4182|
;;;1892           rt  =   COM_8_RES_EVE_BREAK;           /// 偶断线
001052  2550              MOVS     r5,#0x50
001054  e01b              B        |L1.4238|
                  |L1.4182|
;;;1893   /// !!! cy 101115
;;;1894   
;;;1895   //    } else if  (HghErr[BSP_ID_ODD] == TRUE) {         /// cy  101015  m
;;;1896       } else if ((HghErr[BSP_ID_ODD]  == TRUE) && (COM_9511MAIsInOrg == TRUE)) {
001056  f89d0000          LDRB     r0,[sp,#0]
00105a  2801              CMP      r0,#1
00105c  d105              BNE      |L1.4202|
00105e  483b              LDR      r0,|L1.4428|
001060  7800              LDRB     r0,[r0,#0]  ; COM_9511MAIsInOrg
001062  2801              CMP      r0,#1
001064  d101              BNE      |L1.4202|
;;;1897           rt  =   COM_8_RES_ODD_NOTPOS;          /// 奇针高异常
001066  2561              MOVS     r5,#0x61
001068  e011              B        |L1.4238|
                  |L1.4202|
;;;1898   //    } else if  (HghErr[BSP_ID_EVEN] == TRUE) {        /// cy  101015  m
;;;1899       } else if ((HghErr[BSP_ID_EVEN] == TRUE) && (COM_9511MAIsInOrg == TRUE)) {
00106a  f89d0001          LDRB     r0,[sp,#1]
00106e  2801              CMP      r0,#1
001070  d105              BNE      |L1.4222|
001072  4836              LDR      r0,|L1.4428|
001074  7800              LDRB     r0,[r0,#0]  ; COM_9511MAIsInOrg
001076  2801              CMP      r0,#1
001078  d101              BNE      |L1.4222|
;;;1900           rt  =   COM_8_RES_EVE_NOTPOS;          /// 偶针高异常
00107a  2560              MOVS     r5,#0x60
00107c  e007              B        |L1.4238|
                  |L1.4222|
;;;1901       } else if  (COM_9511CheckErr == TRUE) {
00107e  4838              LDR      r0,|L1.4448|
001080  7800              LDRB     r0,[r0,#0]  ; COM_9511CheckErr
001082  2801              CMP      r0,#1
001084  d101              BNE      |L1.4234|
;;;1902           rt  =   COM_8_RES_DAT_ERR;             /// 数据校验错误
001086  2516              MOVS     r5,#0x16
001088  e001              B        |L1.4238|
                  |L1.4234|
;;;1903       } else {
;;;1904           rt  =   BSP_DIP_9511Addr;               /// 正确
00108a  4836              LDR      r0,|L1.4452|
00108c  7805              LDRB     r5,[r0,#0]  ; BSP_DIP_9511Addr
                  |L1.4238|
;;;1905       }
;;;1906       C491_SendOne(rt, 0);
00108e  2100              MOVS     r1,#0
001090  4628              MOV      r0,r5
001092  f7fffffe          BL       C491_SendOne
;;;1907   }
001096  e8bd81ff          POP      {r0-r8,pc}
;;;1908   
                          ENDP

                  COM_UpStByKeyUp PROC
;;;2020   /// 因机头开关上位而改变状态
;;;2021   static  void  COM_UpStByKeyUp (BSP_ID_TypeDef id)
00109a  b510              PUSH     {r4,lr}
;;;2022   {
00109c  4604              MOV      r4,r0
;;;2023       switch (COM_UpStNow[id]) {
00109e  482a              LDR      r0,|L1.4424|
0010a0  5d00              LDRB     r0,[r0,r4]
0010a2  2806              CMP      r0,#6
0010a4  d227              BCS      |L1.4342|
0010a6  e8dff000          TBB      [pc,r0]
0010aa  0304              DCB      0x03,0x04
0010ac  26141516          DCB      0x26,0x14,0x15,0x16
;;;2024       case COM_UP_ST_LOCK:
;;;2025       case COM_UP_ST_NORMAL:
0010b0  bf00              NOP      
;;;2026           COM_9511UpStChange(id, COM_UP_ST_BROKEN);
0010b2  2102              MOVS     r1,#2
0010b4  4620              MOV      r0,r4
0010b6  f7fffffe          BL       COM_9511UpStChange
;;;2027   /// cy  110304
;;;2028   		COM_Tangkong_WorkCmd=MOTO_CUT_NONE;
0010ba  2010              MOVS     r0,#0x10
0010bc  492a              LDR      r1,|L1.4456|
0010be  7008              STRB     r0,[r1,#0]
;;;2029   		COM_9511TangkongPatch[id]=1;
0010c0  2001              MOVS     r0,#1
0010c2  492a              LDR      r1,|L1.4460|
0010c4  5508              STRB     r0,[r1,r4]
;;;2030           COM_HghIsAim[id]    =   COM_HghUpdate_key(id);
0010c6  4620              MOV      r0,r4
0010c8  f7fffffe          BL       COM_HghUpdate_key
0010cc  4928              LDR      r1,|L1.4464|
0010ce  5508              STRB     r0,[r1,r4]
;;;2031   /// cy  110304
;;;2032           break;
0010d0  e012              B        |L1.4344|
;;;2033       case COM_UP_ST_PATCH_LOCK:
;;;2034       case COM_UP_ST_PATCH_IDLE:
0010d2  bf00              NOP      
;;;2035       case COM_UP_ST_PATCH_NORMAL:
0010d4  bf00              NOP      
;;;2036           COM_9511UpStChange(id, COM_UP_ST_PATCH_BROKEN);
0010d6  2106              MOVS     r1,#6
0010d8  4620              MOV      r0,r4
0010da  f7fffffe          BL       COM_9511UpStChange
;;;2037   /// cy  110304
;;;2038   		COM_Tangkong_WorkCmd=MOTO_CUT_NONE;
0010de  2010              MOVS     r0,#0x10
0010e0  4921              LDR      r1,|L1.4456|
0010e2  7008              STRB     r0,[r1,#0]
;;;2039   		COM_9511TangkongPatch[id]=1;
0010e4  2001              MOVS     r0,#1
0010e6  4921              LDR      r1,|L1.4460|
0010e8  5508              STRB     r0,[r1,r4]
;;;2040           COM_HghIsAim[id]    =   COM_HghUpdate_key(id);
0010ea  4620              MOV      r0,r4
0010ec  f7fffffe          BL       COM_HghUpdate_key
0010f0  491f              LDR      r1,|L1.4464|
0010f2  5508              STRB     r0,[r1,r4]
;;;2041   /// cy  110304
;;;2042           break;
0010f4  e000              B        |L1.4344|
                  |L1.4342|
;;;2043       default:                                /// 其他状态不变
;;;2044           break;
0010f6  bf00              NOP      
                  |L1.4344|
0010f8  bf00              NOP                            ;2032
;;;2045       }
;;;2046   	if((COM_9511IsTset==TRUE)&&(BSP_SWI_FiGet(id)  == BSP_SWITCH_LOW))
0010fa  481e              LDR      r0,|L1.4468|
0010fc  7800              LDRB     r0,[r0,#0]  ; COM_9511IsTset
0010fe  2801              CMP      r0,#1
001100  d121              BNE      |L1.4422|
001102  4620              MOV      r0,r4
001104  f7fffffe          BL       BSP_SWI_FiGet
001108  2801              CMP      r0,#1
00110a  d11c              BNE      |L1.4422|
;;;2047   	{	
;;;2048   		MOTO_TKSetHalfAngle(Tangkong_High[COM_Tangkong_WorkHigh]);
00110c  491a              LDR      r1,|L1.4472|
00110e  4a1b              LDR      r2,|L1.4476|
001110  7812              LDRB     r2,[r2,#0]  ; COM_Tangkong_WorkHigh
001112  5c88              LDRB     r0,[r1,r2]
001114  f7fffffe          BL       MOTO_TKSetHalfAngle
;;;2049   		MOTO_TKSetFullAngle(Tangkong_High[COM_Tangkong_WorkHigh]);
001118  4917              LDR      r1,|L1.4472|
00111a  4a18              LDR      r2,|L1.4476|
00111c  7812              LDRB     r2,[r2,#0]  ; COM_Tangkong_WorkHigh
00111e  5c88              LDRB     r0,[r1,r2]
001120  f7fffffe          BL       MOTO_TKSetFullAngle
;;;2050   		COM_TKIsEnable[id]=TRUE;
001124  2001              MOVS     r0,#1
001126  4916              LDR      r1,|L1.4480|
001128  5508              STRB     r0,[r1,r4]
;;;2051   		COM_Tangkong_WorkCmd=MOTO_CUT_HALF;
00112a  200d              MOVS     r0,#0xd
00112c  490e              LDR      r1,|L1.4456|
00112e  7008              STRB     r0,[r1,#0]
;;;2052   		Test_Status[id]=0;
001130  2000              MOVS     r0,#0
001132  4914              LDR      r1,|L1.4484|
001134  5508              STRB     r0,[r1,r4]
;;;2053   		COM_Tangkong_WorkHigh=6;
001136  2006              MOVS     r0,#6
001138  4910              LDR      r1,|L1.4476|
00113a  7008              STRB     r0,[r1,#0]
;;;2054           COM_HghIsAim[id]    =   COM_HghUpdate_key(id);
00113c  4620              MOV      r0,r4
00113e  f7fffffe          BL       COM_HghUpdate_key
001142  490b              LDR      r1,|L1.4464|
001144  5508              STRB     r0,[r1,r4]
                  |L1.4422|
;;;2055   	//	TK_Org[id]=1;	
;;;2056   	}
;;;2057   		
;;;2058   }
001146  bd10              POP      {r4,pc}
                  |L1.4424|
                          DCD      COM_UpStNow
                  |L1.4428|
                          DCD      COM_9511MAIsInOrg
                  |L1.4432|
                          DCD      COM_9511MAIsRunning
                  |L1.4436|
                          DCD      BSP_DIP_BDFunc
                  |L1.4440|
                          DCD      COM_IsFault
                  |L1.4444|
                          DCD      COM_DnIsEnable
                  |L1.4448|
                          DCD      COM_9511CheckErr
                  |L1.4452|
                          DCD      BSP_DIP_9511Addr
                  |L1.4456|
                          DCD      COM_Tangkong_WorkCmd
                  |L1.4460|
                          DCD      COM_9511TangkongPatch
                  |L1.4464|
                          DCD      COM_HghIsAim
                  |L1.4468|
                          DCD      COM_9511IsTset
                  |L1.4472|
                          DCD      Tangkong_High
                  |L1.4476|
                          DCD      COM_Tangkong_WorkHigh
                  |L1.4480|
                          DCD      COM_TKIsEnable
                  |L1.4484|
                          DCD      Test_Status
                          ENDP

                  COM_UpStByKeyMd PROC
;;;2060   /// 因机头开关中位而改变状态
;;;2061   static  void  COM_UpStByKeyMd (BSP_ID_TypeDef id)
001188  b510              PUSH     {r4,lr}
;;;2062   {
00118a  4604              MOV      r4,r0
;;;2063       switch (COM_UpStNow[id]) {
00118c  48fa              LDR      r0,|L1.5496|
00118e  5d00              LDRB     r0,[r0,r4]
001190  b110              CBZ      r0,|L1.4504|
001192  2803              CMP      r0,#3
001194  d11a              BNE      |L1.4556|
001196  e00c              B        |L1.4530|
                  |L1.4504|
;;;2064       case COM_UP_ST_LOCK:
;;;2065           COM_9511UpStChange(id, COM_UP_ST_NORMAL);
001198  2101              MOVS     r1,#1
00119a  4620              MOV      r0,r4
00119c  f7fffffe          BL       COM_9511UpStChange
;;;2066   /// cy  110304
;;;2067   		COM_Tangkong_WorkCmd=MOTO_CUT_D;
0011a0  200a              MOVS     r0,#0xa
0011a2  49f6              LDR      r1,|L1.5500|
0011a4  7008              STRB     r0,[r1,#0]
;;;2068           COM_HghIsAim[id]    =   COM_HghUpdate_key(id);
0011a6  4620              MOV      r0,r4
0011a8  f7fffffe          BL       COM_HghUpdate_key
0011ac  49f4              LDR      r1,|L1.5504|
0011ae  5508              STRB     r0,[r1,r4]
;;;2069   		
;;;2070   /// cy  110304
;;;2071           break;
0011b0  e028              B        |L1.4612|
                  |L1.4530|
;;;2072       case COM_UP_ST_PATCH_LOCK:
;;;2073           COM_9511UpStChange(id, COM_UP_ST_PATCH_IDLE);
0011b2  2104              MOVS     r1,#4
0011b4  4620              MOV      r0,r4
0011b6  f7fffffe          BL       COM_9511UpStChange
;;;2074   /// cy  110304
;;;2075   		COM_Tangkong_WorkCmd=MOTO_CUT_D;
0011ba  200a              MOVS     r0,#0xa
0011bc  49ef              LDR      r1,|L1.5500|
0011be  7008              STRB     r0,[r1,#0]
;;;2076           COM_HghIsAim[id]    =   COM_HghUpdate_key(id);
0011c0  4620              MOV      r0,r4
0011c2  f7fffffe          BL       COM_HghUpdate_key
0011c6  49ee              LDR      r1,|L1.5504|
0011c8  5508              STRB     r0,[r1,r4]
;;;2077   	
;;;2078   /// cy  110304
;;;2079           break;
0011ca  e01b              B        |L1.4612|
                  |L1.4556|
;;;2080       default:                                /// 其他状态不变
;;;2081   	if((TK_Org[id]==0)&&(BSP_SWI_FiGet(id)  == BSP_SWITCH_LOW)&&(IN_HDKey_GetSt((BSP_ID_TypeDef)id)!=HDKEY_ST_DN))
0011cc  48ed              LDR      r0,|L1.5508|
0011ce  5d00              LDRB     r0,[r0,r4]
0011d0  b9b8              CBNZ     r0,|L1.4610|
0011d2  4620              MOV      r0,r4
0011d4  f7fffffe          BL       BSP_SWI_FiGet
0011d8  2801              CMP      r0,#1
0011da  d112              BNE      |L1.4610|
0011dc  4620              MOV      r0,r4
0011de  f7fffffe          BL       IN_HDKey_GetSt
0011e2  2802              CMP      r0,#2
0011e4  d00d              BEQ      |L1.4610|
;;;2082   	{	COM_TKIsEnable[id]=TRUE;
0011e6  2001              MOVS     r0,#1
0011e8  49e7              LDR      r1,|L1.5512|
0011ea  5508              STRB     r0,[r1,r4]
;;;2083   		COM_Tangkong_WorkCmd=MOTO_CUT_D;
0011ec  200a              MOVS     r0,#0xa
0011ee  49e3              LDR      r1,|L1.5500|
0011f0  7008              STRB     r0,[r1,#0]
;;;2084           COM_HghIsAim[id]    =   COM_HghUpdate_key(id);
0011f2  4620              MOV      r0,r4
0011f4  f7fffffe          BL       COM_HghUpdate_key
0011f8  49e1              LDR      r1,|L1.5504|
0011fa  5508              STRB     r0,[r1,r4]
;;;2085   		TK_Org[id]=1;	
0011fc  2001              MOVS     r0,#1
0011fe  49e1              LDR      r1,|L1.5508|
001200  5508              STRB     r0,[r1,r4]
                  |L1.4610|
;;;2086   	}
;;;2087   		
;;;2088           break;
001202  bf00              NOP      
                  |L1.4612|
001204  bf00              NOP                            ;2071
;;;2089       }
;;;2090   }
001206  bd10              POP      {r4,pc}
;;;2091   
                          ENDP

                  COM_UpStByKeyDn PROC
;;;2092   /// 因机头开关下位而改变状态
;;;2093   static  void  COM_UpStByKeyDn (BSP_ID_TypeDef id)
001208  b510              PUSH     {r4,lr}
;;;2094   {
00120a  4604              MOV      r4,r0
;;;2095       switch (COM_UpStNow[id]) {
00120c  48da              LDR      r0,|L1.5496|
00120e  5d00              LDRB     r0,[r0,r4]
001210  2807              CMP      r0,#7
001212  d24c              BCS      |L1.4782|
001214  e8dff000          TBB      [pc,r0]
001218  4b05044b          DCB      0x4b,0x05,0x04,0x4b
00121c  29282700          DCB      0x29,0x28,0x27,0x00
;;;2096       case COM_UP_ST_BROKEN:
;;;2097       case COM_UP_ST_NORMAL:
001220  bf00              NOP      
;;;2098   	if(COM_9511IsTset==FALSE)
001222  48da              LDR      r0,|L1.5516|
001224  7800              LDRB     r0,[r0,#0]  ; COM_9511IsTset
001226  b978              CBNZ     r0,|L1.4680|
;;;2099   	{
;;;2100           COM_9511UpStChange(id, COM_UP_ST_LOCK);
001228  2100              MOVS     r1,#0
00122a  4620              MOV      r0,r4
00122c  f7fffffe          BL       COM_9511UpStChange
;;;2101   /// cy  110304
;;;2102   		COM_Tangkong_WorkCmd=MOTO_CUT_H;
001230  200b              MOVS     r0,#0xb
001232  49d2              LDR      r1,|L1.5500|
001234  7008              STRB     r0,[r1,#0]
;;;2103           COM_HghIsAim[id]    =   COM_HghUpdate_key(id);
001236  4620              MOV      r0,r4
001238  f7fffffe          BL       COM_HghUpdate_key
00123c  49d0              LDR      r1,|L1.5504|
00123e  5508              STRB     r0,[r1,r4]
;;;2104   		TK_Org[id]=0;
001240  2000              MOVS     r0,#0
001242  49d0              LDR      r1,|L1.5508|
001244  5508              STRB     r0,[r1,r4]
001246  e00d              B        |L1.4708|
                  |L1.4680|
;;;2105   	}
;;;2106   	else
;;;2107   	{	
;;;2108   		if(Test_Status[id]==0)
001248  48d1              LDR      r0,|L1.5520|
00124a  5d00              LDRB     r0,[r0,r4]
00124c  b950              CBNZ     r0,|L1.4708|
;;;2109   		{
;;;2110   		COM_Tangkong_WorkCmd=MOTO_CUT_D;
00124e  200a              MOVS     r0,#0xa
001250  49ca              LDR      r1,|L1.5500|
001252  7008              STRB     r0,[r1,#0]
;;;2111           COM_HghIsAim[id]    =   COM_HghUpdate_key(id);
001254  4620              MOV      r0,r4
001256  f7fffffe          BL       COM_HghUpdate_key
00125a  49c9              LDR      r1,|L1.5504|
00125c  5508              STRB     r0,[r1,r4]
;;;2112   		Test_Status[id]=1;
00125e  2001              MOVS     r0,#1
001260  49cb              LDR      r1,|L1.5520|
001262  5508              STRB     r0,[r1,r4]
                  |L1.4708|
;;;2113   		}	
;;;2114   	}
;;;2115   /// cy  110304
;;;2116           break;
001264  e024              B        |L1.4784|
;;;2117       case COM_UP_ST_PATCH_BROKEN:
;;;2118       case COM_UP_ST_PATCH_NORMAL:
001266  bf00              NOP      
;;;2119       case COM_UP_ST_PATCH_IDLE:
001268  bf00              NOP      
;;;2120   	if(COM_9511IsTset==FALSE)
00126a  48c8              LDR      r0,|L1.5516|
00126c  7800              LDRB     r0,[r0,#0]  ; COM_9511IsTset
00126e  b978              CBNZ     r0,|L1.4752|
;;;2121   	{
;;;2122           COM_9511UpStChange(id, COM_UP_ST_PATCH_LOCK);
001270  2103              MOVS     r1,#3
001272  4620              MOV      r0,r4
001274  f7fffffe          BL       COM_9511UpStChange
;;;2123   		COM_Tangkong_WorkCmd=MOTO_CUT_H;
001278  200b              MOVS     r0,#0xb
00127a  49c0              LDR      r1,|L1.5500|
00127c  7008              STRB     r0,[r1,#0]
;;;2124           COM_HghIsAim[id]    =   COM_HghUpdate_key(id);
00127e  4620              MOV      r0,r4
001280  f7fffffe          BL       COM_HghUpdate_key
001284  49be              LDR      r1,|L1.5504|
001286  5508              STRB     r0,[r1,r4]
;;;2125   		TK_Org[id]=0;
001288  2000              MOVS     r0,#0
00128a  49be              LDR      r1,|L1.5508|
00128c  5508              STRB     r0,[r1,r4]
00128e  e00d              B        |L1.4780|
                  |L1.4752|
;;;2126   	}
;;;2127   	else
;;;2128   	{	
;;;2129   		if(Test_Status[id]==0)
001290  48bf              LDR      r0,|L1.5520|
001292  5d00              LDRB     r0,[r0,r4]
001294  b950              CBNZ     r0,|L1.4780|
;;;2130   		{
;;;2131   		COM_Tangkong_WorkCmd=MOTO_CUT_D;
001296  200a              MOVS     r0,#0xa
001298  49b8              LDR      r1,|L1.5500|
00129a  7008              STRB     r0,[r1,#0]
;;;2132           COM_HghIsAim[id]    =   COM_HghUpdate_key(id);
00129c  4620              MOV      r0,r4
00129e  f7fffffe          BL       COM_HghUpdate_key
0012a2  49b7              LDR      r1,|L1.5504|
0012a4  5508              STRB     r0,[r1,r4]
;;;2133   		Test_Status[id]=1;
0012a6  2001              MOVS     r0,#1
0012a8  49b9              LDR      r1,|L1.5520|
0012aa  5508              STRB     r0,[r1,r4]
                  |L1.4780|
;;;2134   		}	
;;;2135   	}
;;;2136   /// cy  110304
;;;2137           break;
0012ac  e000              B        |L1.4784|
                  |L1.4782|
;;;2138       default:                                /// 其他状态不变
;;;2139           break;
0012ae  bf00              NOP      
                  |L1.4784|
0012b0  bf00              NOP                            ;2116
;;;2140       }
;;;2141      //if(COM_9511IsTset==TRUE)
;;;2142      
;;;2143   }
0012b2  bd10              POP      {r4,pc}
;;;2144   
                          ENDP

                  COM_9511IsAddr PROC
;;;2151   /// -----------------------------------------------------------------------------------------------------
;;;2152   static  bool  COM_9511IsAddr (u16 data)
0012b4  4601              MOV      r1,r0
;;;2153   {
;;;2154       data   &=   COM_MSK_9511_WHOLE;
0012b6  b2c9              UXTB     r1,r1
;;;2155       if ((data >> COM_BIT_ADDR_9511) == 0) {	//9511的板地址是0x01~0x0f，所以左移7为是0，924的地址是从0xda~0xff
0012b8  11c8              ASRS     r0,r1,#7
0012ba  d101              BNE      |L1.4800|
;;;2156           return  TRUE;
0012bc  2001              MOVS     r0,#1
                  |L1.4798|
;;;2157       } else {
;;;2158           return  FALSE;
;;;2159       }
;;;2160   }
0012be  4770              BX       lr
                  |L1.4800|
0012c0  2000              MOVS     r0,#0                 ;2158
0012c2  e7fc              B        |L1.4798|
;;;2161   
                          ENDP

                  COM_9511IsValidAddr PROC
;;;2181   /// -----------------------------------------------------------------------------------------------------
;;;2182   static  bool  COM_9511IsValidAddr (u16 data,u16 data2)
0012c4  4602              MOV      r2,r0
;;;2183   {
;;;2184       data   &=   COM_MSK_9511_WHOLE;	//这个数据是0xFF,从0x71~0x7F相与能够保留住这个值
0012c6  b2d2              UXTB     r2,r2
;;;2185       if ((data == COM_9511_ADDR_ALL) || (data == BSP_DIP_9511Addr)) {//COM_9511_ADDR_ALL是0,9511公共地址
0012c8  b11a              CBZ      r2,|L1.4818|
0012ca  48b2              LDR      r0,|L1.5524|
0012cc  7800              LDRB     r0,[r0,#0]  ; BSP_DIP_9511Addr
0012ce  4282              CMP      r2,r0
0012d0  d125              BNE      |L1.4894|
                  |L1.4818|
;;;2186            if((data2==0xc0)||(data2==0xc2)||(data2==0xc8))
0012d2  29c0              CMP      r1,#0xc0
0012d4  d003              BEQ      |L1.4830|
0012d6  29c2              CMP      r1,#0xc2
0012d8  d001              BEQ      |L1.4830|
0012da  29c8              CMP      r1,#0xc8
0012dc  d10b              BNE      |L1.4854|
                  |L1.4830|
;;;2187   		 {
;;;2188   		 	if((BSP_DIP_9511Addr>0x70)&&(BSP_DIP_9511Addr<0x80))
0012de  48ad              LDR      r0,|L1.5524|
0012e0  7800              LDRB     r0,[r0,#0]  ; BSP_DIP_9511Addr
0012e2  2870              CMP      r0,#0x70
0012e4  dd05              BLE      |L1.4850|
0012e6  48ab              LDR      r0,|L1.5524|
0012e8  7800              LDRB     r0,[r0,#0]  ; BSP_DIP_9511Addr
0012ea  2880              CMP      r0,#0x80
0012ec  da01              BGE      |L1.4850|
;;;2189   		 		return  TRUE;
0012ee  2001              MOVS     r0,#1
                  |L1.4848|
;;;2190   			else
;;;2191   				return FALSE;
;;;2192   		 }
;;;2193   		  else if((data2==0xd0)||(data2==0xd2)||(data2==0xd8))
;;;2194   		 {
;;;2195   		 	if((BSP_DIP_9511Addr>0x0)&&(BSP_DIP_9511Addr<0x10))
;;;2196   		 		return  TRUE;
;;;2197   			else
;;;2198   				return FALSE;
;;;2199   		 }
;;;2200   		 else
;;;2201   		  return TRUE;
;;;2202   		
;;;2203       } else {
;;;2204           return  FALSE;
;;;2205       }
;;;2206   }
0012f0  4770              BX       lr
                  |L1.4850|
0012f2  2000              MOVS     r0,#0                 ;2191
0012f4  e7fc              B        |L1.4848|
                  |L1.4854|
0012f6  29d0              CMP      r1,#0xd0              ;2193
0012f8  d003              BEQ      |L1.4866|
0012fa  29d2              CMP      r1,#0xd2              ;2193
0012fc  d001              BEQ      |L1.4866|
0012fe  29d8              CMP      r1,#0xd8              ;2193
001300  d10b              BNE      |L1.4890|
                  |L1.4866|
001302  48a4              LDR      r0,|L1.5524|
001304  7800              LDRB     r0,[r0,#0]            ;2195  ; BSP_DIP_9511Addr
001306  2800              CMP      r0,#0                 ;2195
001308  dd05              BLE      |L1.4886|
00130a  48a2              LDR      r0,|L1.5524|
00130c  7800              LDRB     r0,[r0,#0]            ;2195  ; BSP_DIP_9511Addr
00130e  2810              CMP      r0,#0x10              ;2195
001310  da01              BGE      |L1.4886|
001312  2001              MOVS     r0,#1                 ;2196
001314  e7ec              B        |L1.4848|
                  |L1.4886|
001316  2000              MOVS     r0,#0                 ;2198
001318  e7ea              B        |L1.4848|
                  |L1.4890|
00131a  2001              MOVS     r0,#1                 ;2201
00131c  e7e8              B        |L1.4848|
                  |L1.4894|
00131e  2000              MOVS     r0,#0                 ;2204
001320  e7e6              B        |L1.4848|
;;;2207   
                          ENDP

                  COM_9511GetCheckSum PROC
;;;2208   /// 求校验和(累计和的低7位)
;;;2209   static  u16  COM_9511GetCheckSum (u16 buf[], u8 len)
001322  b510              PUSH     {r4,lr}
;;;2210   {
001324  4602              MOV      r2,r0
001326  460b              MOV      r3,r1
;;;2211       u16     sum;
;;;2212       u8      i;
;;;2213       
;;;2214       
;;;2215       sum =   0;
001328  2400              MOVS     r4,#0
;;;2216       for (i = 0; i < len; i++) {
00132a  2100              MOVS     r1,#0
00132c  e005              B        |L1.4922|
                  |L1.4910|
;;;2217           sum    +=   buf[i];
00132e  f8320011          LDRH     r0,[r2,r1,LSL #1]
001332  4420              ADD      r0,r0,r4
001334  b284              UXTH     r4,r0
001336  1c48              ADDS     r0,r1,#1              ;2216
001338  b2c1              UXTB     r1,r0                 ;2216
                  |L1.4922|
00133a  4299              CMP      r1,r3                 ;2216
00133c  dbf7              BLT      |L1.4910|
;;;2218       }
;;;2219       return  (sum & COM_MSK_9511_DATA);
00133e  f004007f          AND      r0,r4,#0x7f
;;;2220   }
001342  bd10              POP      {r4,pc}
;;;2221   
                          ENDP

                  COM_9511RxHandle PROC
;;;2222   static  void  COM_9511RxHandle (u16 rx)
001344  e92d47f0          PUSH     {r4-r10,lr}
;;;2223   {
001348  4607              MOV      r7,r0
;;;2224       /// iFrame 表示收到的帧数据长度：
;;;2225       ///     0                       -   帧开始, 此时应该收地址, 保存有效数据后 +1
;;;2226       ///     1 ~ (数据长度 + 1)      -   此时应该收命令或数据, 保存后 +1
;;;2227       ///     (数据长度 + 2)          -   帧数据收全, 调用执行函数后清零
;;;2228       static  u32     iFrame  =   0;
;;;2229               u16     cmd;
;;;2230               u32     iTable;
;;;2231               u8      len;
;;;2232               u16    *pData;
;;;2233               bool    IsMyCmd;
;;;2234       static  u16     buf[COM_MAX_FRAME_LEN];
;;;2235       
;;;2236       
;;;2237       if (COM_9511IsAddr(rx)) {                                   /// 收到地址
00134a  4638              MOV      r0,r7
00134c  f7fffffe          BL       COM_9511IsAddr
001350  b190              CBZ      r0,|L1.4984|
;;;2238           if (iFrame == 0) {                                      /// 正常情况, 帧同步
001352  4891              LDR      r0,|L1.5528|
001354  6800              LDR      r0,[r0,#0]  ; iFrame
001356  b128              CBZ      r0,|L1.4964|
;;;2239               ;
;;;2240           } else {                                                /// 异常情况, 帧未同步
;;;2241               iFrame  =   0;                                      /// 强制同步, 设帧开始, 即清零
001358  2000              MOVS     r0,#0
00135a  498f              LDR      r1,|L1.5528|
00135c  6008              STR      r0,[r1,#0]  ; iFrame
;;;2242               COM_ERR_ONE_TIME;                                   /// 指示异常一次
00135e  2001              MOVS     r0,#1
001360  f7fffffe          BL       BSP_LED_Toggle
                  |L1.4964|
;;;2243           }
;;;2244           buf[iFrame++]   =   rx;                                 /// 保存地址, 帧长度+1
001364  488c              LDR      r0,|L1.5528|
001366  6801              LDR      r1,[r0,#0]  ; iFrame
001368  6800              LDR      r0,[r0,#0]  ; iFrame
00136a  1c40              ADDS     r0,r0,#1
00136c  4a8a              LDR      r2,|L1.5528|
00136e  6010              STR      r0,[r2,#0]  ; iFrame
001370  488a              LDR      r0,|L1.5532|
001372  f8207011          STRH     r7,[r0,r1,LSL #1]
001376  e07d              B        |L1.5236|
                  |L1.4984|
;;;2245           
;;;2246       } else {                                                    /// 收到非地址, 是命令或数据
;;;2247           if (iFrame != 0) {                                      /// 如果不是帧开始, 则正常情况, 帧同步
001378  4887              LDR      r0,|L1.5528|
00137a  6800              LDR      r0,[r0,#0]  ; iFrame
00137c  b3e8              CBZ      r0,|L1.5114|
;;;2248               buf[iFrame++]   =   rx;                             /// 保存数据或命令
00137e  4886              LDR      r0,|L1.5528|
001380  6801              LDR      r1,[r0,#0]  ; iFrame
001382  6800              LDR      r0,[r0,#0]  ; iFrame
001384  1c40              ADDS     r0,r0,#1
001386  4a84              LDR      r2,|L1.5528|
001388  6010              STR      r0,[r2,#0]  ; iFrame
00138a  4884              LDR      r0,|L1.5532|
00138c  f8207011          STRH     r7,[r0,r1,LSL #1]
;;;2249               cmd             =   buf[1];                         /// 命令为收到的第2个数
001390  f8b08002          LDRH     r8,[r0,#2]  ; buf
;;;2250               
;;;2251   /// ------- cy 101007   a   -------                             /// 因为协议表从0x80到0xFF, 所以不加此处也行
;;;2252   //            if ((cmd >= COM_9511Tbl[0].cmd) && (cmd <= COM_9511Tbl[COM_LEN_TAB9511 - 1].cmd)) {
;;;2253   /// ------- cy 101007   a   -------
;;;2254               
;;;2255               iTable          =   cmd - COM_9511Tbl[0].cmd;       /// 通过命令, 得到查表位置
001394  4882              LDR      r0,|L1.5536|
001396  8800              LDRH     r0,[r0,#0]  ; COM_9511Tbl
001398  eba80400          SUB      r4,r8,r0
;;;2256               len             =   COM_9511Tbl[iTable].len;        /// 数据长度
00139c  eb040044          ADD      r0,r4,r4,LSL #1
0013a0  497f              LDR      r1,|L1.5536|
0013a2  eb010080          ADD      r0,r1,r0,LSL #2
0013a6  7885              LDRB     r5,[r0,#2]
;;;2257               if (iFrame == len + 2) {                            /// 帧数据收全
0013a8  4610              MOV      r0,r2
0013aa  6801              LDR      r1,[r0,#0]  ; iFrame
0013ac  1ca8              ADDS     r0,r5,#2
0013ae  4281              CMP      r1,r0
0013b0  d160              BNE      |L1.5236|
;;;2258                                  
;;;2259                   /// !!! 因为可能有金片命令, 所以不必判断此命令至少对上或下一种机头板有效
;;;2260                   /// 也可先判断地址, 金片板和机头板地址不同
;;;2261                   if (COM_9511IsValidAddr(buf[0],buf[1])) {              /// 有效地址则执行
0013b2  4a7a              LDR      r2,|L1.5532|
0013b4  8851              LDRH     r1,[r2,#2]  ; buf
0013b6  8810              LDRH     r0,[r2,#0]  ; buf
0013b8  f7fffffe          BL       COM_9511IsValidAddr
0013bc  b3e0              CBZ      r0,|L1.5176|
;;;2262                       pData   =   &buf[2];
0013be  f8df91dc          LDR      r9,|L1.5532|
0013c2  f1090904          ADD      r9,r9,#4
;;;2263   /// 按上下板功能调用执行函数，这里只能是二选一，不能说一个板子去同时执行上下机头的函数
;;;2264                       if (BSP_DIP_BDFunc == BSP_DIP_BD_FUNC_UP) {
0013c6  4877              LDR      r0,|L1.5540|
0013c8  7800              LDRB     r0,[r0,#0]  ; BSP_DIP_BDFunc
0013ca  bb08              CBNZ     r0,|L1.5136|
;;;2265   					   if(COM_9511Tbl[iTable].run_sta>TreahHold_9511)
0013cc  eb040044          ADD      r0,r4,r4,LSL #1
0013d0  4973              LDR      r1,|L1.5536|
0013d2  eb010080          ADD      r0,r1,r0,LSL #2
0013d6  78c0              LDRB     r0,[r0,#3]
0013d8  4973              LDR      r1,|L1.5544|
0013da  7809              LDRB     r1,[r1,#0]  ; TreahHold_9511
0013dc  4288              CMP      r0,r1
0013de  dd08              BLE      |L1.5106|
;;;2266                           	COM_9511Tbl[iTable].UpExe(pData, len);
0013e0  eb040044          ADD      r0,r4,r4,LSL #1
0013e4  496e              LDR      r1,|L1.5536|
0013e6  eb010080          ADD      r0,r1,r0,LSL #2
0013ea  4629              MOV      r1,r5
0013ec  6882              LDR      r2,[r0,#8]
0013ee  4648              MOV      r0,r9
0013f0  4790              BLX      r2
                  |L1.5106|
;;;2267                           if (COM_9511Tbl[iTable].UpExe != COM_CmdDoNothing) {
0013f2  eb040044          ADD      r0,r4,r4,LSL #1
0013f6  496a              LDR      r1,|L1.5536|
0013f8  e000              B        |L1.5116|
                  |L1.5114|
0013fa  e038              B        |L1.5230|
                  |L1.5116|
0013fc  eb010080          ADD      r0,r1,r0,LSL #2
001400  6880              LDR      r0,[r0,#8]
001402  496a              LDR      r1,|L1.5548|
001404  4288              CMP      r0,r1
001406  d001              BEQ      |L1.5132|
;;;2268                               IsMyCmd =   TRUE;
001408  2601              MOVS     r6,#1
00140a  e017              B        |L1.5180|
                  |L1.5132|
;;;2269                           } else {
;;;2270                               IsMyCmd =   FALSE;
00140c  2600              MOVS     r6,#0
00140e  e015              B        |L1.5180|
                  |L1.5136|
;;;2271                           }
;;;2272                       } else {
;;;2273                           COM_9511Tbl[iTable].DnExe(pData, len);
001410  eb040044          ADD      r0,r4,r4,LSL #1
001414  4962              LDR      r1,|L1.5536|
001416  eb010080          ADD      r0,r1,r0,LSL #2
00141a  4629              MOV      r1,r5
00141c  6842              LDR      r2,[r0,#4]
00141e  4648              MOV      r0,r9
001420  4790              BLX      r2
;;;2274                           if (COM_9511Tbl[iTable].DnExe != COM_CmdDoNothing) {
001422  eb040044          ADD      r0,r4,r4,LSL #1
001426  495e              LDR      r1,|L1.5536|
001428  eb010080          ADD      r0,r1,r0,LSL #2
00142c  6840              LDR      r0,[r0,#4]
00142e  495f              LDR      r1,|L1.5548|
001430  4288              CMP      r0,r1
001432  d002              BEQ      |L1.5178|
;;;2275                               IsMyCmd =   TRUE;
001434  2601              MOVS     r6,#1
001436  e001              B        |L1.5180|
                  |L1.5176|
001438  e015              B        |L1.5222|
                  |L1.5178|
;;;2276                           } else {
;;;2277                               IsMyCmd =   FALSE;
00143a  2600              MOVS     r6,#0
                  |L1.5180|
;;;2278                           }
;;;2279                       }
;;;2280                       /// 更新校验数值, 在数据个数不为零, 不是校验命令, 并且是本板命令
;;;2281                       if ((len != 0) && (cmd != 0x00d1) && (IsMyCmd != FALSE)) {
00143c  b175              CBZ      r5,|L1.5212|
00143e  f1b80fd1          CMP      r8,#0xd1
001442  d00b              BEQ      |L1.5212|
001444  b156              CBZ      r6,|L1.5212|
;;;2282                           COM_9511CheckSum    =   COM_9511GetCheckSum(pData, len);
001446  4629              MOV      r1,r5
001448  4648              MOV      r0,r9
00144a  f7fffffe          BL       COM_9511GetCheckSum
00144e  4958              LDR      r1,|L1.5552|
001450  8008              STRH     r0,[r1,#0]
;;;2283                           COM_9511CheckNum    =   len & COM_MSK_9511_DATA;
001452  f005007f          AND      r0,r5,#0x7f
001456  4957              LDR      r1,|L1.5556|
001458  8008              STRH     r0,[r1,#0]
00145a  e004              B        |L1.5222|
                  |L1.5212|
;;;2284                       } else {
;;;2285                           COM_9511CheckSum    =   0;
00145c  2000              MOVS     r0,#0
00145e  4954              LDR      r1,|L1.5552|
001460  8008              STRH     r0,[r1,#0]
;;;2286                           COM_9511CheckNum    =   0;
001462  4954              LDR      r1,|L1.5556|
001464  8008              STRH     r0,[r1,#0]
                  |L1.5222|
;;;2287                       }
;;;2288                   } else {                                        /// 无效地址不执行
;;;2289                           ;
;;;2290                   }
;;;2291                   
;;;2292   /// !!! cy 100906
;;;2293   
;;;2294                   iFrame  =   0;                                  /// 设为帧开始
001466  2000              MOVS     r0,#0
001468  494b              LDR      r1,|L1.5528|
00146a  6008              STR      r0,[r1,#0]  ; iFrame
00146c  e002              B        |L1.5236|
                  |L1.5230|
;;;2295               } else {                                            /// 帧数据未收全, 则不处理
;;;2296                   ;
;;;2297               }
;;;2298               
;;;2299   /// ------- cy 101007   a   -------                             /// 因为协议表从0x80到0xFF, 所以不加此处也行
;;;2300   //            } else {
;;;2301   //                COM_ERR_ONE_TIME;                               /// 因为协议表到0xFF, 所以不会是新协议, 即错误
;;;2302   //            }
;;;2303   /// ------- cy 101007   a   -------
;;;2304               
;;;2305           } else {                                                /// 在帧开始, 则异常情况, 帧未同步
;;;2306               COM_ERR_ONE_TIME;                                   /// 指示异常一次
00146e  2001              MOVS     r0,#1
001470  f7fffffe          BL       BSP_LED_Toggle
                  |L1.5236|
;;;2307           }
;;;2308       }
;;;2309   }
001474  e8bd87f0          POP      {r4-r10,pc}
;;;2310   
                          ENDP

                  COM_924RxHandle PROC
;;;2312   
;;;2313   static  void  COM_924RxHandle (u16 rx)
001478  4770              BX       lr
;;;2314   {
;;;2315       ;
;;;2316   }
;;;2317   
                          ENDP

                  COM_RxHandle PROC
;;;2318   void  COM_RxHandle (u16 rx)
00147a  b510              PUSH     {r4,lr}
;;;2319   {
00147c  4604              MOV      r4,r0
;;;2320       if (BSP_Is924) {
00147e  484e              LDR      r0,|L1.5560|
001480  7800              LDRB     r0,[r0,#0]  ; BSP_Is924
001482  b118              CBZ      r0,|L1.5260|
;;;2321           COM_924RxHandle(rx);
001484  4620              MOV      r0,r4
001486  f7fffffe          BL       COM_924RxHandle
00148a  e002              B        |L1.5266|
                  |L1.5260|
;;;2322       } else {
;;;2323           COM_9511RxHandle(rx);
00148c  4620              MOV      r0,r4
00148e  f7fffffe          BL       COM_9511RxHandle
                  |L1.5266|
;;;2324       }
;;;2325   }
001492  bd10              POP      {r4,pc}
;;;2326   
                          ENDP

                  COM_KeyHandle PROC
;;;2327   
;;;2328   void  COM_KeyHandle (void)
001494  b510              PUSH     {r4,lr}
;;;2329   {
;;;2330       u32     i;
;;;2331       
;;;2332       
;;;2333       if (BSP_DIP_BDFunc == BSP_DIP_BD_FUNC_UP) {     /// 上机头板才处理按键
001496  4843              LDR      r0,|L1.5540|
001498  7800              LDRB     r0,[r0,#0]  ; BSP_DIP_BDFunc
00149a  bb10              CBNZ     r0,|L1.5346|
;;;2334           for (i = 0; i < BSP_DEVICE_ID_N; i++) {
00149c  2400              MOVS     r4,#0
00149e  e01e              B        |L1.5342|
                  |L1.5280|
;;;2335               if (MOTO_HghGetIsActing((BSP_ID_TypeDef)i) == FALSE) {
0014a0  b2e0              UXTB     r0,r4
0014a2  f7fffffe          BL       MOTO_HghGetIsActing
0014a6  b9c8              CBNZ     r0,|L1.5340|
;;;2336                   switch (IN_HDKey_GetSt((BSP_ID_TypeDef)i)) {
0014a8  b2e0              UXTB     r0,r4
0014aa  f7fffffe          BL       IN_HDKey_GetSt
0014ae  b130              CBZ      r0,|L1.5310|
0014b0  2801              CMP      r0,#1
0014b2  d008              BEQ      |L1.5318|
0014b4  2802              CMP      r0,#2
0014b6  d00a              BEQ      |L1.5326|
0014b8  2803              CMP      r0,#3
0014ba  d10c              BNE      |L1.5334|
0014bc  e00c              B        |L1.5336|
                  |L1.5310|
;;;2337                   case HDKEY_ST_MD:
;;;2338                       COM_UpStByKeyMd((BSP_ID_TypeDef)i);
0014be  b2e0              UXTB     r0,r4
0014c0  f7fffffe          BL       COM_UpStByKeyMd
;;;2339                       break;
0014c4  e009              B        |L1.5338|
                  |L1.5318|
;;;2340                   case HDKEY_ST_UP:
;;;2341                       COM_UpStByKeyUp((BSP_ID_TypeDef)i);
0014c6  b2e0              UXTB     r0,r4
0014c8  f7fffffe          BL       COM_UpStByKeyUp
;;;2342                       break;
0014cc  e005              B        |L1.5338|
                  |L1.5326|
;;;2343                   case HDKEY_ST_DN:
;;;2344                       COM_UpStByKeyDn((BSP_ID_TypeDef)i);
0014ce  b2e0              UXTB     r0,r4
0014d0  f7fffffe          BL       COM_UpStByKeyDn
;;;2345                       break;
0014d4  e001              B        |L1.5338|
                  |L1.5334|
;;;2346                   case HDKEY_ST_ERR:
0014d6  bf00              NOP      
                  |L1.5336|
;;;2347                   default:                                /// 其他状态不变
;;;2348                       break;
0014d8  bf00              NOP      
                  |L1.5338|
0014da  bf00              NOP                            ;2339
                  |L1.5340|
0014dc  1c64              ADDS     r4,r4,#1              ;2334
                  |L1.5342|
0014de  2c02              CMP      r4,#2                 ;2334
0014e0  d3de              BCC      |L1.5280|
                  |L1.5346|
;;;2349                   }
;;;2350               }
;;;2351           }
;;;2352       }
;;;2353   }
0014e2  bd10              POP      {r4,pc}
;;;2354   
                          ENDP

                  COM_9511Init PROC
;;;2355   static  void  COM_9511Init (void)
0014e4  b510              PUSH     {r4,lr}
;;;2356   {
;;;2357       u32     i;
;;;2358       
;;;2359       
;;;2360       if (BSP_DIP_BDFunc == BSP_DIP_BD_FUNC_UP) {     /// 上机头板才需要初始化状态
0014e6  482f              LDR      r0,|L1.5540|
0014e8  7800              LDRB     r0,[r0,#0]  ; BSP_DIP_BDFunc
0014ea  bb58              CBNZ     r0,|L1.5444|
;;;2361       	for (i = 0; i < BSP_DEVICE_ID_N; i++) {
0014ec  2400              MOVS     r4,#0
0014ee  e027              B        |L1.5440|
                  |L1.5360|
;;;2362               switch (IN_HDKey_GetSt((BSP_ID_TypeDef)i)) {
0014f0  b2e0              UXTB     r0,r4
0014f2  f7fffffe          BL       IN_HDKey_GetSt
0014f6  b130              CBZ      r0,|L1.5382|
0014f8  2801              CMP      r0,#1
0014fa  d008              BEQ      |L1.5390|
0014fc  2802              CMP      r0,#2
0014fe  d00a              BEQ      |L1.5398|
001500  2803              CMP      r0,#3
001502  d10c              BNE      |L1.5406|
001504  e00c              B        |L1.5408|
                  |L1.5382|
;;;2363               case HDKEY_ST_MD:
;;;2364                   COM_UpStNow[i]  =   COM_UP_ST_NORMAL;
001506  2001              MOVS     r0,#1
001508  491b              LDR      r1,|L1.5496|
00150a  5508              STRB     r0,[r1,r4]
;;;2365                   break;
00150c  e00c              B        |L1.5416|
                  |L1.5390|
;;;2366               case HDKEY_ST_UP:
;;;2367                   COM_UpStNow[i]  =   COM_UP_ST_BROKEN;
00150e  2002              MOVS     r0,#2
001510  4919              LDR      r1,|L1.5496|
001512  5508              STRB     r0,[r1,r4]
;;;2368                   break;
001514  e008              B        |L1.5416|
                  |L1.5398|
;;;2369               case HDKEY_ST_DN:
;;;2370                   COM_UpStNow[i]  =   COM_UP_ST_LOCK;
001516  2000              MOVS     r0,#0
001518  4917              LDR      r1,|L1.5496|
00151a  5508              STRB     r0,[r1,r4]
;;;2371                   break;
00151c  e004              B        |L1.5416|
                  |L1.5406|
;;;2372               case HDKEY_ST_ERR:
00151e  bf00              NOP      
                  |L1.5408|
;;;2373               default:
;;;2374                   COM_UpStNow[i]  =   COM_UP_ST_LOCK;
001520  2000              MOVS     r0,#0
001522  4915              LDR      r1,|L1.5496|
001524  5508              STRB     r0,[r1,r4]
;;;2375                   break;
001526  bf00              NOP      
                  |L1.5416|
001528  bf00              NOP                            ;2365
;;;2376               }
;;;2377               COM_LedUpdate((BSP_ID_TypeDef)i);
00152a  b2e0              UXTB     r0,r4
00152c  f7fffffe          BL       COM_LedUpdate
;;;2378               COM_SqnUpdate((BSP_ID_TypeDef)i);
001530  b2e0              UXTB     r0,r4
001532  f7fffffe          BL       COM_SqnUpdate
;;;2379               /// 不刷新针高, 针高不能动, 直到开关改变或命令
;;;2380   			COM_UpStLast[i]     =   COM_UpStNow[i];
001536  4810              LDR      r0,|L1.5496|
001538  5d00              LDRB     r0,[r0,r4]
00153a  4920              LDR      r1,|L1.5564|
00153c  5508              STRB     r0,[r1,r4]
00153e  1c64              ADDS     r4,r4,#1              ;2361
                  |L1.5440|
001540  2c02              CMP      r4,#2                 ;2361
001542  d3d5              BCC      |L1.5360|
                  |L1.5444|
;;;2381       	}
;;;2382       }
;;;2383   }
001544  bd10              POP      {r4,pc}
;;;2384   
                          ENDP

                  COM_924Init PROC
;;;2385   static  void  COM_924Init (void)
001546  4770              BX       lr
;;;2386   {
;;;2387       ;
;;;2388   }
;;;2389   
                          ENDP

                  COM_Init PROC
;;;2390   void  COM_Init (void)
001548  b510              PUSH     {r4,lr}
;;;2391   {
;;;2392       if (BSP_Is924) {
00154a  481b              LDR      r0,|L1.5560|
00154c  7800              LDRB     r0,[r0,#0]  ; BSP_Is924
00154e  b110              CBZ      r0,|L1.5462|
;;;2393           COM_924Init();
001550  f7fffffe          BL       COM_924Init
001554  e001              B        |L1.5466|
                  |L1.5462|
;;;2394       } else {
;;;2395           COM_9511Init();
001556  f7fffffe          BL       COM_9511Init
                  |L1.5466|
;;;2396       }
;;;2397   }
00155a  bd10              POP      {r4,pc}
;;;2398   
                          ENDP

                  COM_JogIsEn PROC
;;;2399   bool  COM_JogIsEn (BSP_ID_TypeDef id)
00155c  4601              MOV      r1,r0
;;;2400   {
;;;2401       if (id < BSP_DEVICE_ID_N) {
00155e  2902              CMP      r1,#2
001560  da35              BGE      |L1.5582|
;;;2402           if (COM_IsFault[id] || COM_9511IsTset || COM_9511MAIsRunning) {
001562  4817              LDR      r0,|L1.5568|
001564  5c40              LDRB     r0,[r0,r1]
001566  b928              CBNZ     r0,|L1.5492|
001568  4808              LDR      r0,|L1.5516|
00156a  7800              LDRB     r0,[r0,#0]  ; COM_9511IsTset
00156c  b910              CBNZ     r0,|L1.5492|
00156e  4815              LDR      r0,|L1.5572|
001570  7800              LDRB     r0,[r0,#0]  ; COM_9511MAIsRunning
001572  b348              CBZ      r0,|L1.5576|
                  |L1.5492|
;;;2403               return  FALSE;
001574  2000              MOVS     r0,#0
;;;2404           } else {
;;;2405               return  FALSE;
;;;2406           }
;;;2407       } else {
;;;2408           return  FALSE;
;;;2409       }
;;;2410   }
001576  4770              BX       lr
                  |L1.5496|
                          DCD      COM_UpStNow
                  |L1.5500|
                          DCD      COM_Tangkong_WorkCmd
                  |L1.5504|
                          DCD      COM_HghIsAim
                  |L1.5508|
                          DCD      TK_Org
                  |L1.5512|
                          DCD      COM_TKIsEnable
                  |L1.5516|
                          DCD      COM_9511IsTset
                  |L1.5520|
                          DCD      Test_Status
                  |L1.5524|
                          DCD      BSP_DIP_9511Addr
                  |L1.5528|
                          DCD      iFrame
                  |L1.5532|
                          DCD      buf
                  |L1.5536|
                          DCD      COM_9511Tbl
                  |L1.5540|
                          DCD      BSP_DIP_BDFunc
                  |L1.5544|
                          DCD      TreahHold_9511
                  |L1.5548|
                          DCD      COM_CmdDoNothing
                  |L1.5552|
                          DCD      COM_9511CheckSum
                  |L1.5556|
                          DCD      COM_9511CheckNum
                  |L1.5560|
                          DCD      BSP_Is924
                  |L1.5564|
                          DCD      COM_UpStLast
                  |L1.5568|
                          DCD      COM_IsFault
                  |L1.5572|
                          DCD      COM_9511MAIsRunning
                  |L1.5576|
0015c8  e7ff              B        |L1.5578|
                  |L1.5578|
0015ca  2000              MOVS     r0,#0                 ;2405
                  |L1.5580|
0015cc  4770              BX       lr
                  |L1.5582|
0015ce  2000              MOVS     r0,#0                 ;2408
0015d0  e7fc              B        |L1.5580|
;;;2411   void  COM_DXSparkel (void)
                          ENDP

                  COM_DXSparkel PROC
0015d2  b510              PUSH     {r4,lr}
;;;2412   {
;;;2413   	u32 id;
;;;2414   	if (BSP_DIP_BDFunc == BSP_DIP_BD_FUNC_UP) 
0015d4  48ff              LDR      r0,|L1.6612|
0015d6  7800              LDRB     r0,[r0,#0]  ; BSP_DIP_BDFunc
0015d8  b9a0              CBNZ     r0,|L1.5636|
;;;2415   	{ 
;;;2416   	  	if(COM_9511MAIsRunning ==FALSE)
0015da  48ff              LDR      r0,|L1.6616|
0015dc  7800              LDRB     r0,[r0,#0]  ; COM_9511MAIsRunning
0015de  b988              CBNZ     r0,|L1.5636|
;;;2417   			{
;;;2418   				for(id=0;id<BSP_DEVICE_ID_N;id++)
0015e0  2400              MOVS     r4,#0
0015e2  e00d              B        |L1.5632|
                  |L1.5604|
;;;2419   					if (id < BSP_DEVICE_ID_N) 
0015e4  2c02              CMP      r4,#2
0015e6  d20a              BCS      |L1.5630|
;;;2420   			  		{
;;;2421   						if (COM_IsFault[id] ==FALSE)//机头没有关闭
0015e8  48fc              LDR      r0,|L1.6620|
0015ea  5d00              LDRB     r0,[r0,r4]
0015ec  b938              CBNZ     r0,|L1.5630|
;;;2422   						{
;;;2423   							if(COM_UpStNow[id]==COM_UP_ST_BROKEN)
0015ee  48fc              LDR      r0,|L1.6624|
0015f0  5d00              LDRB     r0,[r0,r4]
0015f2  2802              CMP      r0,#2
0015f4  d103              BNE      |L1.5630|
;;;2424   							{
;;;2425   								HDLED_Sparkle((BSP_ID_TypeDef)id,1<<30);
0015f6  0741              LSLS     r1,r0,#29
0015f8  b2e0              UXTB     r0,r4
0015fa  f7fffffe          BL       HDLED_Sparkle
                  |L1.5630|
0015fe  1c64              ADDS     r4,r4,#1              ;2418
                  |L1.5632|
001600  2c02              CMP      r4,#2                 ;2418
001602  d3ef              BCC      |L1.5604|
                  |L1.5636|
;;;2426   							}
;;;2427   						}
;;;2428   					}
;;;2429   		   }
;;;2430   	}							
;;;2431   }
001604  bd10              POP      {r4,pc}
;;;2432   
                          ENDP

                  COM_MainConfirm PROC
;;;2436   extern u8 Main_Securit[4];
;;;2437   static void COM_MainConfirm(u16 buf[], u8 len)
001606  b5fe              PUSH     {r1-r7,lr}
;;;2438   {
001608  4605              MOV      r5,r0
00160a  460e              MOV      r6,r1
;;;2439   	u8 i;
;;;2440   	u8 buf_tmp[10];
;;;2441   	for(i=0;i<10;i++)
00160c  2400              MOVS     r4,#0
00160e  e005              B        |L1.5660|
                  |L1.5648|
;;;2442   		buf_tmp[i]=*(u8*)(buf+i);
001610  f8150014          LDRB     r0,[r5,r4,LSL #1]
001614  f80d0004          STRB     r0,[sp,r4]
001618  1c60              ADDS     r0,r4,#1              ;2441
00161a  b2c4              UXTB     r4,r0                 ;2441
                  |L1.5660|
00161c  2c0a              CMP      r4,#0xa               ;2441
00161e  dbf7              BLT      |L1.5648|
;;;2443   	BitStreamDecode(ds3_src,8,buf_tmp); //解流
001620  466a              MOV      r2,sp
001622  2108              MOVS     r1,#8
001624  48ef              LDR      r0,|L1.6628|
001626  f7fffffe          BL       BitStreamDecode
;;;2444   	crypto_des3_decrypt(&ds3_crypto_des3_ctx_t,
00162a  4aee              LDR      r2,|L1.6628|
00162c  49ee              LDR      r1,|L1.6632|
00162e  48ef              LDR      r0,|L1.6636|
001630  f7fffffe          BL       crypto_des3_decrypt
;;;2445                       ds3_dst,
;;;2446                       ds3_src);//解密
;;;2447   	//判断是否加密
;;;2448   	 if((ds3_dst[4]!=0xff)||(ds3_dst[5]!=0xff)||(ds3_dst[6]!=0xff)||(ds3_dst[7]!=0xff))//是加密主板
001634  48ec              LDR      r0,|L1.6632|
001636  7900              LDRB     r0,[r0,#4]  ; ds3_dst
001638  28ff              CMP      r0,#0xff
00163a  d10b              BNE      |L1.5716|
00163c  48ea              LDR      r0,|L1.6632|
00163e  7940              LDRB     r0,[r0,#5]  ; ds3_dst
001640  28ff              CMP      r0,#0xff
001642  d107              BNE      |L1.5716|
001644  48e8              LDR      r0,|L1.6632|
001646  7980              LDRB     r0,[r0,#6]  ; ds3_dst
001648  28ff              CMP      r0,#0xff
00164a  d103              BNE      |L1.5716|
00164c  48e6              LDR      r0,|L1.6632|
00164e  79c0              LDRB     r0,[r0,#7]  ; ds3_dst
001650  28ff              CMP      r0,#0xff
001652  d002              BEQ      |L1.5722|
                  |L1.5716|
;;;2449   	 {
;;;2450   	 	//从倒数第二个页取数据，如果9511已经加密了，判断密码是否一致,不一致设置禁止变量
;;;2451   		//9511没有加密，直接退出
;;;2452   		MAIN_SECURITY_STAT=TRUE;
001654  2001              MOVS     r0,#1
001656  49e6              LDR      r1,|L1.6640|
001658  7008              STRB     r0,[r1,#0]
                  |L1.5722|
;;;2453   	 }
;;;2454   	 for(i=0;i<4;i++)
00165a  2400              MOVS     r4,#0
00165c  e006              B        |L1.5740|
                  |L1.5726|
;;;2455   	 {
;;;2456   	 	Main_Securit[i]=ds3_dst[4+i];
00165e  1d20              ADDS     r0,r4,#4
001660  49e1              LDR      r1,|L1.6632|
001662  5c08              LDRB     r0,[r1,r0]
001664  49e3              LDR      r1,|L1.6644|
001666  5508              STRB     r0,[r1,r4]
001668  1c60              ADDS     r0,r4,#1              ;2454
00166a  b2c4              UXTB     r4,r0                 ;2454
                  |L1.5740|
00166c  2c04              CMP      r4,#4                 ;2454
00166e  dbf6              BLT      |L1.5726|
;;;2457   	 }
;;;2458   	 if(SECURITY_9511_STAT==TRUE)//9511加密
001670  48e1              LDR      r0,|L1.6648|
001672  7800              LDRB     r0,[r0,#0]  ; SECURITY_9511_STAT
001674  2801              CMP      r0,#1
001676  d123              BNE      |L1.5824|
;;;2459   	 {
;;;2460   	 	//修改运行权限
;;;2461   		//密码一致,修改运行门限为0,9511运行
;;;2462   		//密码不一致，不修改运行权限，9511不运行
;;;2463   			if((MAIN_Sec_ID[0] !=Main_Securit[0])||(MAIN_Sec_ID[1]!=Main_Securit[1])||
001678  48e0              LDR      r0,|L1.6652|
00167a  7800              LDRB     r0,[r0,#0]  ; MAIN_Sec_ID
00167c  49dd              LDR      r1,|L1.6644|
00167e  7809              LDRB     r1,[r1,#0]  ; Main_Securit
001680  4288              CMP      r0,r1
001682  d111              BNE      |L1.5800|
001684  48dd              LDR      r0,|L1.6652|
001686  7840              LDRB     r0,[r0,#1]  ; MAIN_Sec_ID
001688  49da              LDR      r1,|L1.6644|
00168a  7849              LDRB     r1,[r1,#1]  ; Main_Securit
00168c  4288              CMP      r0,r1
00168e  d10b              BNE      |L1.5800|
;;;2464   			   (MAIN_Sec_ID[2]!=Main_Securit[2])||(MAIN_Sec_ID[3]!=Main_Securit[3]))
001690  48da              LDR      r0,|L1.6652|
001692  7880              LDRB     r0,[r0,#2]  ; MAIN_Sec_ID
001694  49d7              LDR      r1,|L1.6644|
001696  7889              LDRB     r1,[r1,#2]  ; Main_Securit
001698  4288              CMP      r0,r1
00169a  d105              BNE      |L1.5800|
00169c  48d7              LDR      r0,|L1.6652|
00169e  78c0              LDRB     r0,[r0,#3]  ; MAIN_Sec_ID
0016a0  49d4              LDR      r1,|L1.6644|
0016a2  78c9              LDRB     r1,[r1,#3]  ; Main_Securit
0016a4  4288              CMP      r0,r1
0016a6  d006              BEQ      |L1.5814|
                  |L1.5800|
;;;2465   				{
;;;2466   					TreahHold_9511=5;
0016a8  2005              MOVS     r0,#5
0016aa  49d5              LDR      r1,|L1.6656|
0016ac  7008              STRB     r0,[r1,#0]
;;;2467   					Secrit_For_LED=1;
0016ae  2001              MOVS     r0,#1
0016b0  49d4              LDR      r1,|L1.6660|
0016b2  7008              STRB     r0,[r1,#0]
0016b4  e004              B        |L1.5824|
                  |L1.5814|
;;;2468   				}	
;;;2469   	//	 }
;;;2470   		 else //密码一致运行
;;;2471   		 {
;;;2472   		 	TreahHold_9511=0;
0016b6  2000              MOVS     r0,#0
0016b8  49d1              LDR      r1,|L1.6656|
0016ba  7008              STRB     r0,[r1,#0]
;;;2473   		 	Secrit_For_LED=0;
0016bc  49d1              LDR      r1,|L1.6660|
0016be  7008              STRB     r0,[r1,#0]
                  |L1.5824|
;;;2474   		 }
;;;2475   	// }
;;;2476   	 }
;;;2477   	 //9511加密，主控不加密，不修改运行权限，9511不能运行
;;;2478   	for(i=0;i<4;i++)
0016c0  2400              MOVS     r4,#0
0016c2  e006              B        |L1.5842|
                  |L1.5828|
;;;2479   	{
;;;2480   		ds3_src_tmp[i]=~ds3_dst[i];
0016c4  48c8              LDR      r0,|L1.6632|
0016c6  5d00              LDRB     r0,[r0,r4]
0016c8  43c0              MVNS     r0,r0
0016ca  49cf              LDR      r1,|L1.6664|
0016cc  5508              STRB     r0,[r1,r4]
0016ce  1c60              ADDS     r0,r4,#1              ;2478
0016d0  b2c4              UXTB     r4,r0                 ;2478
                  |L1.5842|
0016d2  2c04              CMP      r4,#4                 ;2478
0016d4  dbf6              BLT      |L1.5828|
;;;2481   	}
;;;2482   	Confirm_status=1;
0016d6  2001              MOVS     r0,#1
0016d8  49cc              LDR      r1,|L1.6668|
0016da  7008              STRB     r0,[r1,#0]
;;;2483   	
;;;2484   }
0016dc  bdfe              POP      {r1-r7,pc}
;;;2485   extern void  	Get_Main_ID(void);//获得主控加密时候写入的4字节数据
                          ENDP

                  Get_Stream PROC
;;;2487   extern u8 thir_status;
;;;2488   void Get_Stream()
0016de  b510              PUSH     {r4,lr}
;;;2489   {
;;;2490   	u8 i;
;;;2491   	Get_Main_ID();
0016e0  f7fffffe          BL       Get_Main_ID
;;;2492     for(i=0;i<4;i++)
0016e4  2400              MOVS     r4,#0
0016e6  e006              B        |L1.5878|
                  |L1.5864|
;;;2493     	ds3_src_tmp[i+4]=MAIN_Sec_ID[i];
0016e8  48c4              LDR      r0,|L1.6652|
0016ea  5d01              LDRB     r1,[r0,r4]
0016ec  4ac6              LDR      r2,|L1.6664|
0016ee  1d20              ADDS     r0,r4,#4
0016f0  5411              STRB     r1,[r2,r0]
0016f2  1c60              ADDS     r0,r4,#1              ;2492
0016f4  b2c4              UXTB     r4,r0                 ;2492
                  |L1.5878|
0016f6  2c04              CMP      r4,#4                 ;2492
0016f8  dbf6              BLT      |L1.5864|
;;;2494   	crypto_des3_encrypt(&ds3_crypto_des3_ctx_t,
0016fa  4ac3              LDR      r2,|L1.6664|
0016fc  49ba              LDR      r1,|L1.6632|
0016fe  48bb              LDR      r0,|L1.6636|
001700  f7fffffe          BL       crypto_des3_encrypt
;;;2495                       ds3_dst,
;;;2496                       ds3_src_tmp);
;;;2497   	BitStreamEncode(ds3_dst,8,Stream_9511_To_Main);
001704  4ac2              LDR      r2,|L1.6672|
001706  2108              MOVS     r1,#8
001708  48b7              LDR      r0,|L1.6632|
00170a  f7fffffe          BL       BitStreamEncode
;;;2498   }
00170e  bd10              POP      {r4,pc}
;;;2499   static void COM_MainCh9511(u16 buf[], u8 len)
                          ENDP

                  COM_MainCh9511 PROC
001710  b570              PUSH     {r4-r6,lr}
;;;2500   {
001712  b086              SUB      sp,sp,#0x18
001714  4605              MOV      r5,r0
001716  460e              MOV      r6,r1
;;;2501   	u8 i;
;;;2502   
;;;2503   	u16 buf_tmp[10];
;;;2504   	Get_Stream();
001718  f7fffffe          BL       Get_Stream
;;;2505   	for(i=0;i<10;i++)
00171c  2400              MOVS     r4,#0
00171e  e006              B        |L1.5934|
                  |L1.5920|
;;;2506   		buf_tmp[i]=Stream_9511_To_Main[i];
001720  48bb              LDR      r0,|L1.6672|
001722  5d00              LDRB     r0,[r0,r4]
001724  a901              ADD      r1,sp,#4
001726  f8210014          STRH     r0,[r1,r4,LSL #1]
00172a  1c60              ADDS     r0,r4,#1              ;2505
00172c  b2c4              UXTB     r4,r0                 ;2505
                  |L1.5934|
00172e  2c0a              CMP      r4,#0xa               ;2505
001730  dbf6              BLT      |L1.5920|
;;;2507   	for(i=0;i<10;i++)
001732  2400              MOVS     r4,#0
001734  e007              B        |L1.5958|
                  |L1.5942|
;;;2508   	{
;;;2509   		C491_SendOne(buf_tmp[i], 0);
001736  a901              ADD      r1,sp,#4
001738  f8310014          LDRH     r0,[r1,r4,LSL #1]
00173c  2100              MOVS     r1,#0
00173e  f7fffffe          BL       C491_SendOne
001742  1c60              ADDS     r0,r4,#1              ;2507
001744  b2c4              UXTB     r4,r0                 ;2507
                  |L1.5958|
001746  2c0a              CMP      r4,#0xa               ;2507
001748  dbf5              BLT      |L1.5942|
;;;2510   	}
;;;2511   }
00174a  b006              ADD      sp,sp,#0x18
00174c  bd70              POP      {r4-r6,pc}
;;;2512   
                          ENDP

                  COM_MainErasPssW PROC
;;;2513   void COM_MainErasPssW(u16 buf[], u8 len)
00174e  e92d47f0          PUSH     {r4-r10,lr}
;;;2514   {
001752  4681              MOV      r9,r0
001754  468a              MOV      r10,r1
;;;2515   	u8 i,j=0;
001756  2500              MOVS     r5,#0
;;;2516   	u8 status= 0,tmp_read;
001758  46a8              MOV      r8,r5
;;;2517   	u32 Addr;
;;;2518   	FLASH_Unlock();
00175a  f7fffffe          BL       FLASH_Unlock
;;;2519   	Addr=CONFIRM_MAINCONTRAL_ADDR1;
00175e  4fad              LDR      r7,|L1.6676|
;;;2520   	for(i=0;i<5;i++)
001760  2400              MOVS     r4,#0
001762  e015              B        |L1.6032|
                  |L1.5988|
;;;2521   	{
;;;2522   		FLASH_ErasePage(Addr);
001764  4638              MOV      r0,r7
001766  f7fffffe          BL       FLASH_ErasePage
;;;2523   		for(j=0;j<20;j++)
00176a  2500              MOVS     r5,#0
00176c  e007              B        |L1.6014|
                  |L1.5998|
;;;2524   		{
;;;2525   			tmp_read=(*(u8*)(Addr+i));
00176e  5d3e              LDRB     r6,[r7,r4]
;;;2526   			if(tmp_read!=0xFF)
001770  2eff              CMP      r6,#0xff
001772  d002              BEQ      |L1.6010|
;;;2527   			{
;;;2528   				status=1;
001774  f04f0801          MOV      r8,#1
;;;2529   				break;
001778  e003              B        |L1.6018|
                  |L1.6010|
00177a  1c68              ADDS     r0,r5,#1              ;2523
00177c  b2c5              UXTB     r5,r0                 ;2523
                  |L1.6014|
00177e  2d14              CMP      r5,#0x14              ;2523
001780  dbf5              BLT      |L1.5998|
                  |L1.6018|
001782  bf00              NOP      
;;;2530   			}	
;;;2531   		}
;;;2532   		if(status==0)
001784  f1b80f00          CMP      r8,#0
001788  d100              BNE      |L1.6028|
;;;2533   			break;
00178a  e003              B        |L1.6036|
                  |L1.6028|
00178c  1c60              ADDS     r0,r4,#1              ;2520
00178e  b2c4              UXTB     r4,r0                 ;2520
                  |L1.6032|
001790  2c05              CMP      r4,#5                 ;2520
001792  dbe7              BLT      |L1.5988|
                  |L1.6036|
001794  bf00              NOP      
;;;2534   	}
;;;2535   	Addr=CONFIRM_MAINCONTRAL_ADDR2;
001796  4fa0              LDR      r7,|L1.6680|
;;;2536   	for(i=0;i<5;i++)
001798  2400              MOVS     r4,#0
00179a  e015              B        |L1.6088|
                  |L1.6044|
;;;2537   	{
;;;2538   		FLASH_ErasePage(Addr);
00179c  4638              MOV      r0,r7
00179e  f7fffffe          BL       FLASH_ErasePage
;;;2539   		for(j=0;j<20;j++)
0017a2  2500              MOVS     r5,#0
0017a4  e007              B        |L1.6070|
                  |L1.6054|
;;;2540   		{
;;;2541   			tmp_read=(*(u8*)(Addr+i));
0017a6  5d3e              LDRB     r6,[r7,r4]
;;;2542   			if(tmp_read!=0xFF)
0017a8  2eff              CMP      r6,#0xff
0017aa  d002              BEQ      |L1.6066|
;;;2543   			{
;;;2544   				status=1;
0017ac  f04f0801          MOV      r8,#1
;;;2545   				break;
0017b0  e003              B        |L1.6074|
                  |L1.6066|
0017b2  1c68              ADDS     r0,r5,#1              ;2539
0017b4  b2c5              UXTB     r5,r0                 ;2539
                  |L1.6070|
0017b6  2d14              CMP      r5,#0x14              ;2539
0017b8  dbf5              BLT      |L1.6054|
                  |L1.6074|
0017ba  bf00              NOP      
;;;2546   			}	
;;;2547   		}
;;;2548   		if(status==0)
0017bc  f1b80f00          CMP      r8,#0
0017c0  d100              BNE      |L1.6084|
;;;2549   			break;
0017c2  e003              B        |L1.6092|
                  |L1.6084|
0017c4  1c60              ADDS     r0,r4,#1              ;2536
0017c6  b2c4              UXTB     r4,r0                 ;2536
                  |L1.6088|
0017c8  2c05              CMP      r4,#5                 ;2536
0017ca  dbe7              BLT      |L1.6044|
                  |L1.6092|
0017cc  bf00              NOP      
;;;2550   	}
;;;2551   	FLASH_Lock();
0017ce  f7fffffe          BL       FLASH_Lock
;;;2552   	Get_Stream();
0017d2  f7fffffe          BL       Get_Stream
;;;2553   }
0017d6  e8bd87f0          POP      {r4-r10,pc}
;;;2554   
                          ENDP

                  PRO_MainSetPssW PROC
;;;2555   void PRO_MainSetPssW(u16 buf[], u8 len,u32 Addr)
0017da  e92d41f0          PUSH     {r4-r8,lr}
;;;2556   {
0017de  b086              SUB      sp,sp,#0x18
0017e0  4606              MOV      r6,r0
0017e2  460f              MOV      r7,r1
0017e4  4615              MOV      r5,r2
;;;2557   	u8 i;//,tmp_buf[20];//,tmp_in_buf[10];//,j,ID_status=0;
;;;2558   	u16 tmp_out_buf[10];
;;;2559   	FLASH_Status status= FLASH_COMPLETE;
0017e6  f04f0804          MOV      r8,#4
;;;2560   	for(i=0;i<10;i++)
0017ea  2400              MOVS     r4,#0
0017ec  e006              B        |L1.6140|
                  |L1.6126|
;;;2561   	{
;;;2562   		tmp_out_buf[i]=buf[i];	
0017ee  f8360014          LDRH     r0,[r6,r4,LSL #1]
0017f2  a901              ADD      r1,sp,#4
0017f4  f8210014          STRH     r0,[r1,r4,LSL #1]
0017f8  1c60              ADDS     r0,r4,#1              ;2560
0017fa  b2c4              UXTB     r4,r0                 ;2560
                  |L1.6140|
0017fc  2c0a              CMP      r4,#0xa               ;2560
0017fe  dbf6              BLT      |L1.6126|
;;;2563   	}
;;;2564   	FLASH_Unlock();
001800  f7fffffe          BL       FLASH_Unlock
;;;2565   	for(i=0;i<5;i++)
001804  2400              MOVS     r4,#0
001806  e009              B        |L1.6172|
                  |L1.6152|
;;;2566   	{
;;;2567   		status=FLASH_ErasePage(Addr);
001808  4628              MOV      r0,r5
00180a  f7fffffe          BL       FLASH_ErasePage
00180e  4680              MOV      r8,r0
;;;2568   		if(status == FLASH_COMPLETE)
001810  f1b80f04          CMP      r8,#4
001814  d100              BNE      |L1.6168|
;;;2569   			break;
001816  e003              B        |L1.6176|
                  |L1.6168|
001818  1c60              ADDS     r0,r4,#1              ;2565
00181a  b2c4              UXTB     r4,r0                 ;2565
                  |L1.6172|
00181c  2c05              CMP      r4,#5                 ;2565
00181e  dbf3              BLT      |L1.6152|
                  |L1.6176|
001820  bf00              NOP      
;;;2570   	}
;;;2571   	if(status == FLASH_COMPLETE)
001822  f1b80f04          CMP      r8,#4
001826  d10d              BNE      |L1.6212|
;;;2572   		{		
;;;2573   			for(i=0;i<len;i++)
001828  2400              MOVS     r4,#0
00182a  e009              B        |L1.6208|
                  |L1.6188|
;;;2574   			{
;;;2575   				status =FLASH_ProgramHalfWord((Addr+i*2),tmp_out_buf[i]);
00182c  aa01              ADD      r2,sp,#4
00182e  f8321014          LDRH     r1,[r2,r4,LSL #1]
001832  eb050044          ADD      r0,r5,r4,LSL #1
001836  f7fffffe          BL       FLASH_ProgramHalfWord
00183a  4680              MOV      r8,r0
00183c  1c60              ADDS     r0,r4,#1              ;2573
00183e  b2c4              UXTB     r4,r0                 ;2573
                  |L1.6208|
001840  42bc              CMP      r4,r7                 ;2573
001842  dbf3              BLT      |L1.6188|
                  |L1.6212|
;;;2576   			}
;;;2577   		}
;;;2578   	FLASH_Lock();	
001844  f7fffffe          BL       FLASH_Lock
;;;2579   }
001848  b006              ADD      sp,sp,#0x18
00184a  e8bd81f0          POP      {r4-r8,pc}
;;;2580   
                          ENDP

                  COM_MainSetPssW PROC
;;;2581   
;;;2582   void COM_MainSetPssW(u16 buf[], u8 len)
00184e  e92d4ff0          PUSH     {r4-r11,lr}
;;;2583   {
001852  b08f              SUB      sp,sp,#0x3c
001854  4606              MOV      r6,r0
;;;2584   	//u8 thir_status=0;
;;;2585   
;;;2586   	u32 Addr1,Addr2;
;;;2587   	u8 i,tmp_in_buf[10],j,ID_status=0,ds3_tmp[8],tmp1_u8,tmp2_u8;
001856  f04f0900          MOV      r9,#0
;;;2588   	u16 tmp_out_buf[9],tmp_read_buf[10];
;;;2589   	Addr1=CONFIRM_MAINCONTRAL_ADDR1;
00185a  4f6e              LDR      r7,|L1.6676|
;;;2590   	Addr2=CONFIRM_MAINCONTRAL_ADDR2;
00185c  f8df81b8          LDR      r8,|L1.6680|
;;;2591   	for(i=0;i<10;i++)//获取数据
001860  2400              MOVS     r4,#0
001862  e005              B        |L1.6256|
                  |L1.6244|
;;;2592   	 {
;;;2593   		tmp_in_buf[i]=*(u8*)(buf+i);
001864  f8160014          LDRB     r0,[r6,r4,LSL #1]
001868  a90c              ADD      r1,sp,#0x30
00186a  5508              STRB     r0,[r1,r4]
00186c  1c60              ADDS     r0,r4,#1              ;2591
00186e  b2c4              UXTB     r4,r0                 ;2591
                  |L1.6256|
001870  2c0a              CMP      r4,#0xa               ;2591
001872  dbf7              BLT      |L1.6244|
;;;2594   	 }
;;;2595   	BitStreamDecode(ds3_src,8,tmp_in_buf); //解流
001874  aa0c              ADD      r2,sp,#0x30
001876  2108              MOVS     r1,#8
001878  485a              LDR      r0,|L1.6628|
00187a  f7fffffe          BL       BitStreamDecode
;;;2596   	crypto_des3_decrypt(&ds3_crypto_des3_ctx_t,
00187e  4a59              LDR      r2,|L1.6628|
001880  4959              LDR      r1,|L1.6632|
001882  485a              LDR      r0,|L1.6636|
001884  f7fffffe          BL       crypto_des3_decrypt
;;;2597                       ds3_dst,
;;;2598                       ds3_src);//解密
;;;2599   	for(i=4;i<8;i++)
001888  2404              MOVS     r4,#4
00188a  e005              B        |L1.6296|
                  |L1.6284|
;;;2600   	{
;;;2601   		ds3_tmp[i]=ds3_dst[i];
00188c  4856              LDR      r0,|L1.6632|
00188e  5d00              LDRB     r0,[r0,r4]
001890  a90a              ADD      r1,sp,#0x28
001892  5508              STRB     r0,[r1,r4]
001894  1c60              ADDS     r0,r4,#1              ;2599
001896  b2c4              UXTB     r4,r0                 ;2599
                  |L1.6296|
001898  2c08              CMP      r4,#8                 ;2599
00189a  dbf7              BLT      |L1.6284|
;;;2602   	}
;;;2603   	for(i=0;i<4;i++)
00189c  2400              MOVS     r4,#0
00189e  e005              B        |L1.6316|
                  |L1.6304|
;;;2604   	{
;;;2605   		ds3_tmp[i]=ds3_src_tmp[i];
0018a0  4859              LDR      r0,|L1.6664|
0018a2  5d00              LDRB     r0,[r0,r4]
0018a4  a90a              ADD      r1,sp,#0x28
0018a6  5508              STRB     r0,[r1,r4]
0018a8  1c60              ADDS     r0,r4,#1              ;2603
0018aa  b2c4              UXTB     r4,r0                 ;2603
                  |L1.6316|
0018ac  2c04              CMP      r4,#4                 ;2603
0018ae  dbf7              BLT      |L1.6304|
;;;2606   	}
;;;2607   	crypto_des3_encrypt(&ds3_crypto_des3_ctx_t,
0018b0  aa0a              ADD      r2,sp,#0x28
0018b2  494d              LDR      r1,|L1.6632|
0018b4  484d              LDR      r0,|L1.6636|
0018b6  f7fffffe          BL       crypto_des3_encrypt
;;;2608                       ds3_dst,
;;;2609                       ds3_tmp);
;;;2610   	for(i=0;i<8;i++)
0018ba  2400              MOVS     r4,#0
0018bc  e026              B        |L1.6412|
                  |L1.6334|
;;;2611   	{
;;;2612   		if(i<4)
0018be  2c04              CMP      r4,#4
0018c0  da0d              BGE      |L1.6366|
;;;2613   		{
;;;2614   			tmp_out_buf[i]=ds3_dst[i*2]+(((u16)ds3_dst[i*2+1])<<8);
0018c2  4849              LDR      r0,|L1.6632|
0018c4  f8100014          LDRB     r0,[r0,r4,LSL #1]
0018c8  2101              MOVS     r1,#1
0018ca  eb010144          ADD      r1,r1,r4,LSL #1
0018ce  4a46              LDR      r2,|L1.6632|
0018d0  5c51              LDRB     r1,[r2,r1]
0018d2  eb002001          ADD      r0,r0,r1,LSL #8
0018d6  a905              ADD      r1,sp,#0x14
0018d8  f8210014          STRH     r0,[r1,r4,LSL #1]
0018dc  e014              B        |L1.6408|
                  |L1.6366|
;;;2615   		}
;;;2616   		else
;;;2617   		{
;;;2618   			tmp1_u8=~ds3_dst[(i-4)*2];
0018de  1f20              SUBS     r0,r4,#4
0018e0  4941              LDR      r1,|L1.6632|
0018e2  f8110010          LDRB     r0,[r1,r0,LSL #1]
0018e6  43c0              MVNS     r0,r0
0018e8  f0000aff          AND      r10,r0,#0xff
;;;2619   			tmp2_u8=~ds3_dst[(i-4)*2+1];
0018ec  1f20              SUBS     r0,r4,#4
0018ee  2101              MOVS     r1,#1
0018f0  eb010040          ADD      r0,r1,r0,LSL #1
0018f4  493c              LDR      r1,|L1.6632|
0018f6  5c08              LDRB     r0,[r1,r0]
0018f8  43c0              MVNS     r0,r0
0018fa  f0000bff          AND      r11,r0,#0xff
;;;2620   			tmp_out_buf[i]=tmp1_u8+(tmp2_u8<<8);	
0018fe  eb0a200b          ADD      r0,r10,r11,LSL #8
001902  a905              ADD      r1,sp,#0x14
001904  f8210014          STRH     r0,[r1,r4,LSL #1]
                  |L1.6408|
001908  1c60              ADDS     r0,r4,#1              ;2610
00190a  b2c4              UXTB     r4,r0                 ;2610
                  |L1.6412|
00190c  2c08              CMP      r4,#8                 ;2610
00190e  dbd6              BLT      |L1.6334|
;;;2621   		}
;;;2622   	}
;;;2623   	tmp_out_buf[8]=Sec_Number+1;		
001910  4842              LDR      r0,|L1.6684|
001912  8800              LDRH     r0,[r0,#0]  ; Sec_Number
001914  1c40              ADDS     r0,r0,#1
001916  b280              UXTH     r0,r0
001918  f8ad0024          STRH     r0,[sp,#0x24]
;;;2624   	switch(thir_status)
00191c  4840              LDR      r0,|L1.6688|
00191e  7800              LDRB     r0,[r0,#0]  ; thir_status
001920  2806              CMP      r0,#6
001922  d256              BCS      |L1.6610|
001924  e8dff000          TBB      [pc,r0]
001928  04300331          DCB      0x04,0x30,0x03,0x31
00192c  0506              DCB      0x05,0x06
;;;2625   	{	
;;;2626   		case 2:
;;;2627   		case 0:
00192e  bf00              NOP      
;;;2628   		case 4:
001930  bf00              NOP      
;;;2629   		case 5://
001932  bf00              NOP      
;;;2630   			for(j=0;j<5;j++)
001934  2500              MOVS     r5,#0
001936  e023              B        |L1.6528|
                  |L1.6456|
;;;2631   			{
;;;2632   				PRO_MainSetPssW(tmp_out_buf,9,Addr1);
001938  463a              MOV      r2,r7
00193a  2109              MOVS     r1,#9
00193c  a805              ADD      r0,sp,#0x14
00193e  f7fffffe          BL       PRO_MainSetPssW
;;;2633   				for(i=0;i<8;i++)
001942  2400              MOVS     r4,#0
001944  e005              B        |L1.6482|
                  |L1.6470|
;;;2634   				{
;;;2635   				   tmp_read_buf[i]=*(u16*)(Addr1+i*2);
001946  f8370014          LDRH     r0,[r7,r4,LSL #1]
00194a  f82d0014          STRH     r0,[sp,r4,LSL #1]
00194e  1c60              ADDS     r0,r4,#1              ;2633
001950  b2c4              UXTB     r4,r0                 ;2633
                  |L1.6482|
001952  2c08              CMP      r4,#8                 ;2633
001954  dbf7              BLT      |L1.6470|
;;;2636   				}
;;;2637   				for(i=0;i<8;i++)
001956  2400              MOVS     r4,#0
001958  e00a              B        |L1.6512|
                  |L1.6490|
;;;2638   				{
;;;2639   					if(tmp_read_buf[i]!=tmp_out_buf[i])
00195a  f83d0014          LDRH     r0,[sp,r4,LSL #1]
00195e  a905              ADD      r1,sp,#0x14
001960  f8311014          LDRH     r1,[r1,r4,LSL #1]
001964  4288              CMP      r0,r1
001966  d001              BEQ      |L1.6508|
;;;2640   						ID_status=1;
001968  f04f0901          MOV      r9,#1
                  |L1.6508|
00196c  1c60              ADDS     r0,r4,#1              ;2637
00196e  b2c4              UXTB     r4,r0                 ;2637
                  |L1.6512|
001970  2c08              CMP      r4,#8                 ;2637
001972  dbf2              BLT      |L1.6490|
;;;2641   				}
;;;2642   				
;;;2643   				if(ID_status==0)
001974  f1b90f00          CMP      r9,#0
001978  d100              BNE      |L1.6524|
;;;2644   				{
;;;2645   					break;	
00197a  e003              B        |L1.6532|
                  |L1.6524|
00197c  1c68              ADDS     r0,r5,#1              ;2630
00197e  b2c5              UXTB     r5,r0                 ;2630
                  |L1.6528|
001980  2d05              CMP      r5,#5                 ;2630
001982  dbd9              BLT      |L1.6456|
                  |L1.6532|
001984  bf00              NOP      
;;;2646   				}
;;;2647   			}
;;;2648   		 break;
001986  e054              B        |L1.6706|
;;;2649   		 case 1:
;;;2650   		 case 3://第一块加密无效，第二块不加密
001988  bf00              NOP      
;;;2651   		 	for(j=0;j<5;j++)
00198a  2500              MOVS     r5,#0
00198c  e04c              B        |L1.6696|
                  |L1.6542|
;;;2652   			{
;;;2653   				PRO_MainSetPssW(tmp_out_buf,9,Addr2);
00198e  4642              MOV      r2,r8
001990  2109              MOVS     r1,#9
001992  a805              ADD      r0,sp,#0x14
001994  f7fffffe          BL       PRO_MainSetPssW
;;;2654   				for(i=0;i<10;i++)
001998  2400              MOVS     r4,#0
00199a  e005              B        |L1.6568|
                  |L1.6556|
;;;2655   				{
;;;2656   				   tmp_read_buf[i]=*(u16*)(Addr2+i*2);
00199c  f8380014          LDRH     r0,[r8,r4,LSL #1]
0019a0  f82d0014          STRH     r0,[sp,r4,LSL #1]
0019a4  1c60              ADDS     r0,r4,#1              ;2654
0019a6  b2c4              UXTB     r4,r0                 ;2654
                  |L1.6568|
0019a8  2c0a              CMP      r4,#0xa               ;2654
0019aa  dbf7              BLT      |L1.6556|
;;;2657   				}
;;;2658   				for(i=0;i<10;i++)
0019ac  2400              MOVS     r4,#0
0019ae  e00a              B        |L1.6598|
                  |L1.6576|
;;;2659   				{
;;;2660   					if(tmp_read_buf[i]!=tmp_out_buf[i])
0019b0  f83d0014          LDRH     r0,[sp,r4,LSL #1]
0019b4  a905              ADD      r1,sp,#0x14
0019b6  f8311014          LDRH     r1,[r1,r4,LSL #1]
0019ba  4288              CMP      r0,r1
0019bc  d001              BEQ      |L1.6594|
;;;2661   						ID_status=1;
0019be  f04f0901          MOV      r9,#1
                  |L1.6594|
0019c2  1c60              ADDS     r0,r4,#1              ;2658
0019c4  b2c4              UXTB     r4,r0                 ;2658
                  |L1.6598|
0019c6  2c0a              CMP      r4,#0xa               ;2658
0019c8  dbf2              BLT      |L1.6576|
;;;2662   				}
;;;2663   				
;;;2664   				if(ID_status==0)
0019ca  f1b90f00          CMP      r9,#0
0019ce  d129              BNE      |L1.6692|
;;;2665   				{
;;;2666   					break;	
0019d0  e02c              B        |L1.6700|
                  |L1.6610|
0019d2  e02d              B        |L1.6704|
                  |L1.6612|
                          DCD      BSP_DIP_BDFunc
                  |L1.6616|
                          DCD      COM_9511MAIsRunning
                  |L1.6620|
                          DCD      COM_IsFault
                  |L1.6624|
                          DCD      COM_UpStNow
                  |L1.6628|
                          DCD      ds3_src
                  |L1.6632|
                          DCD      ds3_dst
                  |L1.6636|
                          DCD      ds3_crypto_des3_ctx_t
                  |L1.6640|
                          DCD      MAIN_SECURITY_STAT
                  |L1.6644|
                          DCD      Main_Securit
                  |L1.6648|
                          DCD      SECURITY_9511_STAT
                  |L1.6652|
                          DCD      MAIN_Sec_ID
                  |L1.6656|
                          DCD      TreahHold_9511
                  |L1.6660|
                          DCD      Secrit_For_LED
                  |L1.6664|
                          DCD      ds3_src_tmp
                  |L1.6668|
                          DCD      Confirm_status
                  |L1.6672|
                          DCD      Stream_9511_To_Main
                  |L1.6676|
                          DCD      0x0801f800
                  |L1.6680|
                          DCD      0x0801f400
                  |L1.6684|
                          DCD      Sec_Number
                  |L1.6688|
                          DCD      thir_status
                  |L1.6692|
001a24  1c68              ADDS     r0,r5,#1              ;2651
001a26  b2c5              UXTB     r5,r0                 ;2651
                  |L1.6696|
001a28  2d05              CMP      r5,#5                 ;2651
001a2a  dbb0              BLT      |L1.6542|
                  |L1.6700|
001a2c  bf00              NOP      
;;;2667   				}
;;;2668   			}
;;;2669   		 break;
001a2e  e000              B        |L1.6706|
                  |L1.6704|
;;;2670   		 default :
;;;2671   		 break;
001a30  bf00              NOP      
                  |L1.6706|
001a32  bf00              NOP                            ;2648
;;;2672   	}
;;;2673   	Get_Stream();
001a34  f7fffffe          BL       Get_Stream
;;;2674   }
001a38  b00f              ADD      sp,sp,#0x3c
001a3a  e8bd8ff0          POP      {r4-r11,pc}
;;;2675   static  void  COM_9511SetSol (u16 buf[], u8 len)
                          ENDP

                  COM_9511SetSol PROC
001a3e  e92d41f0          PUSH     {r4-r8,lr}
;;;2676   {
001a42  4604              MOV      r4,r0
001a44  4688              MOV      r8,r1
;;;2677       BSP_ID_TypeDef      id;
;;;2678       BSP_SOL_TypeDef     st;
;;;2679       u16                 tm;
;;;2680       
;;;2681       
;;;2682       buf[0] &=   COM_MSK_9511_DATA;
001a46  8820              LDRH     r0,[r4,#0]
001a48  f000007f          AND      r0,r0,#0x7f
001a4c  8020              STRH     r0,[r4,#0]
;;;2683       
;;;2684       id      =   (BSP_ID_TypeDef)((buf[0] >> 0) & 1);
001a4e  8820              LDRH     r0,[r4,#0]
001a50  f0000501          AND      r5,r0,#1
;;;2685       st      =   (BSP_SOL_TypeDef)((buf[0] >> 1) & 1);
001a54  8820              LDRH     r0,[r4,#0]
001a56  f3c00640          UBFX     r6,r0,#1,#1
;;;2686       tm      =   buf[0] >> 2;
001a5a  8820              LDRH     r0,[r4,#0]
001a5c  1087              ASRS     r7,r0,#2
;;;2687       
;;;2688       BSP_SOL_Set(id, st, tm);
001a5e  463a              MOV      r2,r7
001a60  4631              MOV      r1,r6
001a62  4628              MOV      r0,r5
001a64  f7fffffe          BL       BSP_SOL_Set
;;;2689   }
001a68  e8bd81f0          POP      {r4-r8,pc}
;;;2690   /// End of file -----------------------------------------------------------------------------------------
                          ENDP


                          AREA ||.bss||, DATA, NOINIT, ALIGN=1

                  buf
                          %        20

                          AREA ||.constdata||, DATA, READONLY, ALIGN=2

                  COM_9511Tbl
000000  0080              DCW      0x0080
000002  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
00000c  0081              DCW      0x0081
00000e  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000018  0082              DCW      0x0082
00001a  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000024  0083              DCW      0x0083
000026  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000030  0084              DCW      0x0084
000032  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
00003c  0085              DCW      0x0085
00003e  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000048  0086              DCW      0x0086
00004a  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000054  0087              DCW      0x0087
000056  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000060  0088              DCW      0x0088
000062  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
00006c  0089              DCW      0x0089
00006e  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000078  008a              DCW      0x008a
00007a  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000084  008b              DCW      0x008b
000086  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000090  008c              DCW      0x008c
000092  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
00009c  008d              DCW      0x008d
00009e  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0000a8  008e              DCW      0x008e
0000aa  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0000b4  008f              DCW      0x008f
0000b6  0105              DCB      0x01,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_9511SetSol
0000c0  0090              DCW      0x0090
0000c2  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_Tangkong_HighTo0
0000cc  0091              DCW      0x0091
0000ce  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_Tangkong_HighTo1
0000d8  0092              DCW      0x0092
0000da  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_Tangkong_HighTo2
0000e4  0093              DCW      0x0093
0000e6  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_Tangkong_HighTo3
0000f0  0094              DCW      0x0094
0000f2  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_Tangkong_HighTo4
0000fc  0095              DCW      0x0095
0000fe  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_Tangkong_HighTo5
000108  0096              DCW      0x0096
00010a  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_Tangkong_HighTo6
000114  0097              DCW      0x0097
000116  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_Tangkong_HighTo7
000120  0098              DCW      0x0098
000122  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_Tangkong_HighTo8
00012c  0099              DCW      0x0099
00012e  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_Tangkong_HighTo9
000138  009a              DCW      0x009a
00013a  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_Tangkong_HighTo10
000144  009b              DCW      0x009b
000146  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_Tangkong_SinglDir
000150  009c              DCW      0x009c
000152  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_Tangkong_DoublDir
00015c  009d              DCW      0x009d
00015e  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_Tangkong_Position
000168  009e              DCW      0x009e
00016a  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_Tangkong_Sta
000174  009f              DCW      0x009f
000176  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000180  00a0              DCW      0x00a0
000182  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
00018c  00a1              DCW      0x00a1
00018e  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000198  00a2              DCW      0x00a2
00019a  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0001a4  00a3              DCW      0x00a3
0001a6  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0001b0  00a4              DCW      0x00a4
0001b2  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0001bc  00a5              DCW      0x00a5
0001be  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0001c8  00a6              DCW      0x00a6
0001ca  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0001d4  00a7              DCW      0x00a7
0001d6  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0001e0  00a8              DCW      0x00a8
0001e2  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0001ec  00a9              DCW      0x00a9
0001ee  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0001f8  00aa              DCW      0x00aa
0001fa  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000204  00ab              DCW      0x00ab
000206  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000210  00ac              DCW      0x00ac
000212  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
00021c  00ad              DCW      0x00ad
00021e  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000228  00ae              DCW      0x00ae
00022a  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000234  00af              DCW      0x00af
000236  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000240  00b0              DCW      0x00b0
000242  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
00024c  00b1              DCW      0x00b1
00024e  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000258  00b2              DCW      0x00b2
00025a  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000264  00b3              DCW      0x00b3
000266  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000270  00b4              DCW      0x00b4
000272  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
00027c  00b5              DCW      0x00b5
00027e  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000288  00b6              DCW      0x00b6
00028a  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000294  00b7              DCW      0x00b7
000296  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0002a0  00b8              DCW      0x00b8
0002a2  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0002ac  00b9              DCW      0x00b9
0002ae  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0002b8  00ba              DCW      0x00ba
0002ba  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0002c4  00bb              DCW      0x00bb
0002c6  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0002d0  00bc              DCW      0x00bc
0002d2  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0002dc  00bd              DCW      0x00bd
0002de  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0002e8  00be              DCW      0x00be
0002ea  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0002f4  00bf              DCW      0x00bf
0002f6  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000300  00c0              DCW      0x00c0
000302  0505              DCB      0x05,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_9511FaultOff
00030c  00c1              DCW      0x00c1
00030e  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000318  00c2              DCW      0x00c2
00031a  0505              DCB      0x05,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000324  00c3              DCW      0x00c3
000326  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000330  00c4              DCW      0x00c4
000332  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
00033c  00c5              DCW      0x00c5
00033e  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000348  00c6              DCW      0x00c6
00034a  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000354  00c7              DCW      0x00c7
000356  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000360  00c8              DCW      0x00c8
000362  0505              DCB      0x05,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
00036c  00c9              DCW      0x00c9
00036e  0a3c              DCB      0x0a,0x3c
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000378  00ca              DCW      0x00ca
00037a  003c              DCB      0x00,0x3c
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000384  00cb              DCW      0x00cb
000386  003c              DCB      0x00,0x3c
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000390  00cc              DCW      0x00cc
000392  0a3c              DCB      0x0a,0x3c
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
00039c  00cd              DCW      0x00cd
00039e  003c              DCB      0x00,0x3c
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0003a8  00ce              DCW      0x00ce
0003aa  003c              DCB      0x00,0x3c
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0003b4  00cf              DCW      0x00cf
0003b6  0a3c              DCB      0x0a,0x3c
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0003c0  00d0              DCW      0x00d0
0003c2  0505              DCB      0x05,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_9511FaultOff
0003cc  00d1              DCW      0x00d1
0003ce  0205              DCB      0x02,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0003d8  00d2              DCW      0x00d2
0003da  0505              DCB      0x05,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0003e4  00d3              DCW      0x00d3
0003e6  0505              DCB      0x05,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0003f0  00d4              DCW      0x00d4
0003f2  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0003fc  00d5              DCW      0x00d5
0003fe  0105              DCB      0x01,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_HeadSpeed
000408  00d6              DCW      0x00d6
00040a  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000414  00d7              DCW      0x00d7
000416  0205              DCB      0x02,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000420  00d8              DCW      0x00d8
000422  0505              DCB      0x05,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
00042c  00d9              DCW      0x00d9
00042e  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000438  00da              DCW      0x00da
00043a  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000444  00db              DCW      0x00db
000446  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000450  00dc              DCW      0x00dc
000452  0305              DCB      0x03,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
00045c  00dd              DCW      0x00dd
00045e  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000468  00de              DCW      0x00de
00046a  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_9511SetRedOdd
000474  00df              DCW      0x00df
000476  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_9511SetGreOdd
000480  00e0              DCW      0x00e0
000482  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_9511SetOraOdd
00048c  00e1              DCW      0x00e1
00048e  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_9511TestEnter
000498  00e2              DCW      0x00e2
00049a  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_9511TestExit
0004a4  00e3              DCW      0x00e3
0004a6  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_9511SetRedEven
0004b0  00e4              DCW      0x00e4
0004b2  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_9511SetGreEven
0004bc  00e5              DCW      0x00e5
0004be  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_9511SetOraEven
0004c8  00e6              DCW      0x00e6
0004ca  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0004d4  00e7              DCW      0x00e7
0004d6  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0004e0  00e8              DCW      0x00e8
0004e2  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0004ec  00e9              DCW      0x00e9
0004ee  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0004f8  00ea              DCW      0x00ea
0004fa  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000504  00eb              DCW      0x00eb
000506  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000510  00ec              DCW      0x00ec
000512  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_9511SetGreALL
00051c  00ed              DCW      0x00ed
00051e  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000528  00ee              DCW      0x00ee
00052a  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_9511PatchExit
000534  00ef              DCW      0x00ef
000536  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_9511PatchEnter
000540  00f0              DCW      0x00f0
000542  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
00054c  00f1              DCW      0x00f1
00054e  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000558  00f2              DCW      0x00f2
00055a  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000564  00f3              DCW      0x00f3
000566  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000570  00f4              DCW      0x00f4
000572  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
00057c  00f5              DCW      0x00f5
00057e  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000588  00f6              DCW      0x00f6
00058a  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
000594  00f7              DCW      0x00f7
000596  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0005a0  00f8              DCW      0x00f8
0005a2  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0005ac  00f9              DCW      0x00f9
0005ae  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0005b8  00fa              DCW      0x00fa
0005ba  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0005c4  00fb              DCW      0x00fb
0005c6  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0005d0  00fc              DCW      0x00fc
0005d2  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0005dc  00fd              DCW      0x00fd
0005de  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0005e8  00fe              DCW      0x00fe
0005ea  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing
0005f4  00ff              DCW      0x00ff
0005f6  0005              DCB      0x00,0x05
                          DCD      COM_CmdDoNothing
                          DCD      COM_CmdDoNothing

                          AREA ||.data||, DATA, ALIGN=2

                  Tangkong_High
000000  0f14191e          DCB      0x0f,0x14,0x19,0x1e
000004  23282d2d          DCB      0x23,0x28,0x2d,0x2d
000008  2d2d              DCB      0x2d,0x2d
                  COM_IsFault
00000a  0000              DCB      0x00,0x00
                  COM_DnIsEnable
00000c  0101              DCB      0x01,0x01
                  COM_TKIsEnable
00000e  0000              DCB      0x00,0x00
                  COM_SwiDirIsEnable
000010  0000              DCB      0x00,0x00
                  COM_HghIsAim
000012  0000              DCB      0x00,0x00
                  COM_IsHghRest
000014  01                DCB      0x01
                  COM_9511IsTset
000015  00                DCB      0x00
                  COM_9511MAIsInOrg
000016  00                DCB      0x00
                  COM_9511MAIsRunning
000017  00                DCB      0x00
                  COM_WorkHigh
000018  0000              DCB      0x00,0x00
                  COM_9511CheckSum
00001a  0000              DCW      0x0000
                  COM_9511CheckNum
00001c  0000              DCW      0x0000
                  COM_9511CheckErr
00001e  00                DCB      0x00
                  COM_9511TangkongDir
00001f  01                DCB      0x01
                  COM_9511TangkongEnable
000020  0101              DCB      0x01,0x01
                  COM_9511TangkongPatch
000022  0000              DCB      0x00,0x00
                  COM_Tangkong_WorkHigh
000024  00                DCB      0x00
                  COM_Tangkong_WorkHigh_Last
000025  00                DCB      0x00
                  TK_Org
000026  0000              DCB      0x00,0x00
                  COM_Tangkong_Pos_Last
000028  0000              DCW      0x0000
                  Test_Status
00002a  0101              DCB      0x01,0x01
                  iFrame
                          DCD      0x00000000
                  COM_UpStNow
000030  0000              DCB      0x00,0x00
                  COM_UpStLast
000032  0000              DCB      0x00,0x00
                  COM_Tangkong_WorkCmd
000034  00                DCB      0x00
                  ds3_src
000035  000000            DCB      0x00,0x00,0x00
                          DCD      0x00000000
00003c  00                DCB      0x00
                  ds3_dst
00003d  000000            DCB      0x00,0x00,0x00
                          DCD      0x00000000
000044  00                DCB      0x00
